[2021-06-11 22:31:27,999] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-11 22:31:31,659] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 6245 --deepspeed_config ds_config.json
[2021-06-11 22:31:32,637] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-11 22:31:32,637] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-11 22:31:32,637] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-11 22:31:32,637] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-11 22:31:32,637] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623450698.1139717
before load_ogb step Time(s): 0.0018
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.17578125, 'VmSize': 20394.8671875, 'VmHWM': 1164.7890625, 'VmRSS': 1164.7890625}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6710
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2833
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0010
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0000
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0886
-------------------------------------------------end of load ogb****************** step Time(s): 0.0019
finish constructing ogbn-products
load ogb-products time total: 2.0461175441741943
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0470
after inductive else step Time(s): 0.0000
after label step Time(s): 3.4447
after train_g.create_formats_() step Time(s): 1.5647
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-11 22:31:45,201] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-11 22:31:45,201] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-11 22:31:45,205] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-11 22:31:47,581] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-11 22:31:47,582] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-11 22:31:47,582] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-11 22:31:47,582] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-11 22:31:47,582] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-11 22:31:47,583] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f3a0cae1940>
[2021-06-11 22:31:47,583] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:31:47,583] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-11 22:31:47,583] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-11 22:31:47,584] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-11 22:31:47,585] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58642578125GB

Max Memory Allocated 1.1875920295715332  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.63134765625GB

Max Memory Allocated 1.1875920295715332  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 2.88134765625GB

Max Memory Allocated 1.2502999305725098  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 2.88134765625GB

Max Memory Allocated 1.2502999305725098  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 2.96142578125GB

Max Memory Allocated 1.2741079330444336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 2.96142578125GB

Max Memory Allocated 1.2741079330444336  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6724 | Train Acc 0.0175 | Speed (samples/sec) nan | GPU 1304.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.96142578125GB

Max Memory Allocated 1.2741079330444336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21533203125GB

Max Memory Allocated 1.4410490989685059  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22705078125GB

Max Memory Allocated 1.4410490989685059  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24072265625GB

Max Memory Allocated 1.4410490989685059  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.19970703125GB

Max Memory Allocated 1.4410490989685059  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4410490989685059  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4410490989685059  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4410490989685059  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.19970703125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.20166015625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.19970703125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.22900390625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.24267578125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.20166015625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.21728515625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4413504600524902  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4413504600524902  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

[2021-06-11 22:31:50,194] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-11 22:31:50,195] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=94888.74644626603
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4421381950378418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4424982070922852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4424982070922852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4424982070922852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4424982070922852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4424982070922852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4424982070922852  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4424982070922852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442537784576416  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.442537784576416  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.442537784576416  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.442537784576416  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442537784576416  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442537784576416  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.442537784576416  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:31:51,390] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:31:51,390] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=91525.47402892869
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

Epoch 00000 | Step 00020 | Loss 0.9936 | Train Acc 0.7580 | Speed (samples/sec) 105725.0628 | GPU 1478.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:31:53,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:31:53,023] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=91754.17530200462
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

avg iteration(step) data from cpu to GPU time:12.34145179 ms
avg iteration GPU training time:16.53503047 ms
avg iteration (step) total cpu time:120.61815792 ms
Epoch Time(s): 5.7903
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.7339 | Train Acc 0.8176 | Speed (samples/sec) 105736.8459 | GPU 1478.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:31:55,621] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:31:55,621] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=93687.02483021149
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:31:57,403] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:31:57,403] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=94062.66776887716
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

Epoch 00001 | Step 00020 | Loss 0.6119 | Train Acc 0.8389 | Speed (samples/sec) 97780.9020 | GPU 1478.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:31:58,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:31:58,508] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=94931.428033281
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

avg iteration(step) data from cpu to GPU time:10.56829161 ms
avg iteration GPU training time:19.39490135 ms
avg iteration (step) total cpu time:136.60317880 ms
Epoch Time(s): 5.9788
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.5879 | Train Acc 0.8471 | Speed (samples/sec) 96137.4298 | GPU 1478.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:32:01,366] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:01,366] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=87185.04233625968
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

[2021-06-11 22:32:02,380] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:02,380] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=88969.39585989738
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.44356107711792  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00002 | Step 00020 | Loss 0.5734 | Train Acc 0.8549 | Speed (samples/sec) 107881.8588 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:03,719] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:03,719] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=90078.64568376781
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.55711518 ms
avg iteration GPU training time:14.95427315 ms
avg iteration (step) total cpu time:106.84230593 ms
Epoch Time(s): 5.1221
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.5454 | Train Acc 0.8580 | Speed (samples/sec) 112316.4134 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:06,056] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:06,056] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=90973.95355178438
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:07,429] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:07,430] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=91850.31911450895
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00003 | Step 00020 | Loss 0.5228 | Train Acc 0.8551 | Speed (samples/sec) 119624.2193 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:08,417] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:08,417] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=92714.8257063183
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47900390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.70041478 ms
avg iteration GPU training time:14.86273419 ms
avg iteration (step) total cpu time:106.44971883 ms
Epoch Time(s): 5.0986
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5278 | Train Acc 0.8642 | Speed (samples/sec) 122323.8383 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:11,397] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:11,397] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=93418.21156986944
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:12,726] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:12,726] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=93859.48961213896
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00004 | Step 00020 | Loss 0.5366 | Train Acc 0.8564 | Speed (samples/sec) 126019.9874 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:15,085] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:15,085] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=94250.75007518212
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:16,147] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:16,147] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=94767.97011508104
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.76260734 ms
avg iteration GPU training time:15.12146374 ms
avg iteration (step) total cpu time:151.53438074 ms
Epoch Time(s): 6.8606
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.5368 | Train Acc 0.8528 | Speed (samples/sec) 127334.4648 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:19,010] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:19,010] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=94910.12446573105
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:20,290] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:20,290] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=94934.20248191562
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00005 | Step 00020 | Loss 0.5302 | Train Acc 0.8560 | Speed (samples/sec) 127993.4799 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:21,647] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:21,647] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=94708.7057684057
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:11.22450975 ms
avg iteration GPU training time:16.12901462 ms
avg iteration (step) total cpu time:119.45837515 ms
Epoch Time(s): 5.5229
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.5276 | Train Acc 0.8605 | Speed (samples/sec) 128876.0929 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:24,010] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:24,010] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=95068.06956704898
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:25,377] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:25,378] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=95245.0886423998
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00006 | Step 00020 | Loss 0.5167 | Train Acc 0.8607 | Speed (samples/sec) 128380.2185 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:26,491] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:26,491] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=95421.71302036375
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61932666 ms
avg iteration GPU training time:15.27366878 ms
avg iteration (step) total cpu time:112.53420512 ms
Epoch Time(s): 5.2241
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.5467 | Train Acc 0.8538 | Speed (samples/sec) 125592.9169 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:29,143] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:29,143] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=95542.00325619649
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:30,176] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:30,176] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=95582.62486836668
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00007 | Step 00020 | Loss 0.4911 | Train Acc 0.8689 | Speed (samples/sec) 126355.9876 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:31,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:31,708] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=95619.29784200386
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:10.00049187 ms
avg iteration GPU training time:15.75881838 ms
avg iteration (step) total cpu time:119.38323798 ms
Epoch Time(s): 5.4038
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.5076 | Train Acc 0.8629 | Speed (samples/sec) 127152.2687 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:34,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:34,174] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=95622.2904686848
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:35,676] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:35,676] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=95375.31824341007
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00008 | Step 00020 | Loss 0.5237 | Train Acc 0.8600 | Speed (samples/sec) 127875.3660 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:36,782] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:36,783] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=95107.45511171134
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75391995 ms
avg iteration GPU training time:16.68470167 ms
avg iteration (step) total cpu time:115.76273706 ms
Epoch Time(s): 5.3757
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.4813 | Train Acc 0.8703 | Speed (samples/sec) 128736.2269 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:39,481] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:39,481] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=95309.23612139016
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:40,539] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:40,539] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=95446.32054777324
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00009 | Step 00020 | Loss 0.5062 | Train Acc 0.8647 | Speed (samples/sec) 129228.7515 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:41,872] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:41,873] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=95435.0468433746
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47900390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:43,240] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:43,240] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=95624.8183091513
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69842845 ms
avg iteration GPU training time:15.57690317 ms
avg iteration (step) total cpu time:122.18760561 ms
Epoch Time(s): 5.5664
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.5128 | Train Acc 0.8647 | Speed (samples/sec) 129790.1749 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:46,043] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:46,043] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=95676.84296831867
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:47,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:47,295] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=95838.03576998516
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00010 | Step 00020 | Loss 0.4882 | Train Acc 0.8700 | Speed (samples/sec) 130461.1068 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45361328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:48,733] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:48,733] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=95991.53580156976
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47900390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.85950936 ms
avg iteration GPU training time:15.05981753 ms
avg iteration (step) total cpu time:121.81391539 ms
Epoch Time(s): 5.5477
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.4717 | Train Acc 0.8722 | Speed (samples/sec) 131144.5657 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:51,181] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:51,181] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=96122.13001339446
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:52,543] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:52,543] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=96217.05965642212
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00011 | Step 00020 | Loss 0.5005 | Train Acc 0.8721 | Speed (samples/sec) 131696.7054 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:53,643] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:53,643] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=96160.2605796811
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44530602 ms
avg iteration GPU training time:15.58749390 ms
avg iteration (step) total cpu time:116.54571251 ms
Epoch Time(s): 5.4463
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.4668 | Train Acc 0.8711 | Speed (samples/sec) 132234.8008 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:56,510] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:56,511] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=96261.83570257634
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:57,541] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:57,541] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=96314.25532429658
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00012 | Step 00020 | Loss 0.4912 | Train Acc 0.8676 | Speed (samples/sec) 131898.3568 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:32:59,232] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:32:59,232] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=96306.3007590031
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:10.04170548 ms
avg iteration GPU training time:15.50206463 ms
avg iteration (step) total cpu time:121.56544791 ms
Epoch Time(s): 5.4870
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.4617 | Train Acc 0.8775 | Speed (samples/sec) 131087.5190 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:33:01,613] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:01,614] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=96436.88359338886
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:33:03,060] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:03,060] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=96372.12795387898
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00013 | Step 00020 | Loss 0.5000 | Train Acc 0.8657 | Speed (samples/sec) 131483.6422 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:33:04,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:04,035] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=96477.63959774471
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

avg iteration(step) data from cpu to GPU time:10.89965158 ms
avg iteration GPU training time:15.48779975 ms
avg iteration (step) total cpu time:109.60901225 ms
Epoch Time(s): 5.2050
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.4921 | Train Acc 0.8708 | Speed (samples/sec) 131473.7185 | GPU 1478.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:33:06,716] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:06,717] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=96482.98461713515
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:33:07,798] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:07,799] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=96431.04925960762
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

Epoch 00014 | Step 00020 | Loss 0.5171 | Train Acc 0.8583 | Speed (samples/sec) 131683.5755 | GPU 1478.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

[2021-06-11 22:33:09,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:09,209] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=96409.62111501975
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4440903663635254  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44970703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:10,439] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:10,439] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=96468.71053201893
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:10.21778721 ms
avg iteration GPU training time:15.98820969 ms
avg iteration (step) total cpu time:119.62326368 ms
Epoch Time(s): 5.5044
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.4852 | Train Acc 0.8701 | Speed (samples/sec) 131603.1317 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:13,230] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:13,230] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=96489.56549988323
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:14,532] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:14,532] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=96468.6559739721
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00015 | Step 00020 | Loss 0.4763 | Train Acc 0.8762 | Speed (samples/sec) 131427.0352 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:15,920] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:15,920] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=96298.21179727495
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:10.15736054 ms
avg iteration GPU training time:16.30359703 ms
avg iteration (step) total cpu time:121.02397283 ms
Epoch Time(s): 5.5572
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.4880 | Train Acc 0.8671 | Speed (samples/sec) 131631.6249 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:19,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:19,295] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=96279.2006653746
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:20,767] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:20,767] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=96329.56322794761
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00016 | Step 00020 | Loss 0.4761 | Train Acc 0.8698 | Speed (samples/sec) 131931.6549 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:21,735] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:21,735] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=96420.17459702927
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:10.13285210 ms
avg iteration GPU training time:15.27794845 ms
avg iteration (step) total cpu time:135.92034799 ms
Epoch Time(s): 6.2855
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.5031 | Train Acc 0.8639 | Speed (samples/sec) 131558.1376 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:24,516] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:24,516] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=96429.92380349844
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:26,050] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:26,050] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=96427.18280945496
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00017 | Step 00020 | Loss 0.5108 | Train Acc 0.8600 | Speed (samples/sec) 130677.1921 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:27,582] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:27,583] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=96428.12910896886
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:11.30887946 ms
avg iteration GPU training time:16.49099721 ms
avg iteration (step) total cpu time:134.24019460 ms
Epoch Time(s): 5.8094
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46923828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.4799 | Train Acc 0.8676 | Speed (samples/sec) 129539.7756 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:29,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:29,986] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=96190.90741506814
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:31,339] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:31,339] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=96212.62560498364
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00018 | Step 00020 | Loss 0.4677 | Train Acc 0.8708 | Speed (samples/sec) 130028.8665 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:32,291] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:32,291] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=96273.66014922339
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.47900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:10.06470283 ms
avg iteration GPU training time:15.47507911 ms
avg iteration (step) total cpu time:103.03428438 ms
Epoch Time(s): 5.0712
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.4855 | Train Acc 0.8708 | Speed (samples/sec) 130295.8350 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:34,898] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:34,899] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=96312.69202492877
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:35,931] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:35,931] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=96376.83609504694
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00019 | Step 00020 | Loss 0.4639 | Train Acc 0.8762 | Speed (samples/sec) 130574.0992 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:37,371] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:37,371] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=96405.09169640229
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.44775390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:38,907] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:38,907] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=96489.059506238
-----------------------------------------after batch engine step
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68813993 ms
avg iteration GPU training time:15.28224829 ms
avg iteration (step) total cpu time:131.51372804 ms
Epoch Time(s): 5.7303
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.46728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.48095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.4959 | Train Acc 0.8644 | Speed (samples/sec) 130640.4195 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.46142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:41,665] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:41,665] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=96465.90945766692
-----------------------------------------after batch engine step
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47119140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45556640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50048828125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.50244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.47314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.48486328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.49853515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.45751953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.47509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:42,798] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:42,799] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=96501.57325812023
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00020 | Step 00020 | Loss 0.4933 | Train Acc 0.8668 | Speed (samples/sec) 130025.7094 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:44,211] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:44,211] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=96528.08597402206
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:11.68882976 ms
avg iteration GPU training time:15.59386313 ms
avg iteration (step) total cpu time:115.69930889 ms
Epoch Time(s): 5.3922
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.4955 | Train Acc 0.8677 | Speed (samples/sec) 129583.3987 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:46,664] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:46,664] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=96583.13436605595
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:48,034] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:48,034] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=96536.72158389458
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00021 | Step 00020 | Loss 0.5056 | Train Acc 0.8647 | Speed (samples/sec) 130001.4888 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:49,168] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:49,168] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=96486.3409260459
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:9.89896539 ms
avg iteration GPU training time:16.10210479 ms
avg iteration (step) total cpu time:118.44010706 ms
Epoch Time(s): 5.4887
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.5002 | Train Acc 0.8660 | Speed (samples/sec) 129705.7937 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:52,061] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:52,062] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=96478.657944187
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:53,078] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:53,078] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=96498.96205089924
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00022 | Step 00020 | Loss 0.5039 | Train Acc 0.8634 | Speed (samples/sec) 129782.9034 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:54,815] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:54,815] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=96529.91475183851
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:9.51010252 ms
avg iteration GPU training time:15.40763018 ms
avg iteration (step) total cpu time:123.85559082 ms
Epoch Time(s): 5.6203
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.5135 | Train Acc 0.8645 | Speed (samples/sec) 130114.6416 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:57,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:57,268] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=96584.28362109927
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:58,729] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:58,729] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=96577.73749950746
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00023 | Step 00020 | Loss 0.4896 | Train Acc 0.8652 | Speed (samples/sec) 130343.0784 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:33:59,747] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:33:59,747] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=96611.00524945081
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:10.16597688 ms
avg iteration GPU training time:15.47332972 ms
avg iteration (step) total cpu time:108.49354885 ms
Epoch Time(s): 5.2457
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.4914 | Train Acc 0.8705 | Speed (samples/sec) 130258.2787 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:02,424] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:02,424] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=96650.49239593992
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:03,480] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:03,480] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=96687.48666405791
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00024 | Step 00020 | Loss 0.4587 | Train Acc 0.8762 | Speed (samples/sec) 130509.3936 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:05,047] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:05,047] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=96701.57483171666
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:06,291] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:06,291] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=96760.11237981937
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:9.76653511 ms
avg iteration GPU training time:15.48533344 ms
avg iteration (step) total cpu time:125.59620539 ms
Epoch Time(s): 5.6326
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.4778 | Train Acc 0.8713 | Speed (samples/sec) 130753.2178 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:09,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:09,023] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=96821.38878251576
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:10,378] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:10,378] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=96847.63008349232
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00025 | Step 00020 | Loss 0.4752 | Train Acc 0.8703 | Speed (samples/sec) 131040.7682 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:11,856] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:11,856] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=96871.45162142429
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:10.32781396 ms
avg iteration GPU training time:15.30478569 ms
avg iteration (step) total cpu time:125.36123947 ms
Epoch Time(s): 5.6203
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.5011 | Train Acc 0.8660 | Speed (samples/sec) 131233.3961 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:14,285] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:14,285] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=96883.86342459853
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:15,769] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:15,769] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=96905.95060664363
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00026 | Step 00020 | Loss 0.4801 | Train Acc 0.8705 | Speed (samples/sec) 131333.5425 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:16,730] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:16,730] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=96952.35054258585
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

avg iteration(step) data from cpu to GPU time:12.04757224 ms
avg iteration GPU training time:15.30002131 ms
avg iteration (step) total cpu time:111.30732077 ms
Epoch Time(s): 5.2578
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.5043 | Train Acc 0.8634 | Speed (samples/sec) 131508.6258 | GPU 1478.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:19,416] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:19,416] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=96953.23094360043
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

[2021-06-11 22:34:20,448] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:20,448] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=97012.85645965509
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

Epoch 00027 | Step 00020 | Loss 0.4781 | Train Acc 0.8753 | Speed (samples/sec) 131527.5902 | GPU 1478.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4441819190979004  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:21,991] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:21,991] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=97016.7139156373
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:11.20745835 ms
avg iteration GPU training time:15.28575293 ms
avg iteration (step) total cpu time:120.04559128 ms
Epoch Time(s): 5.4909
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.4763 | Train Acc 0.8729 | Speed (samples/sec) 131192.8043 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:24,466] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:24,467] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=97056.91857146764
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:25,953] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:25,953] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=97030.71563626091
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00028 | Step 00020 | Loss 0.5152 | Train Acc 0.8673 | Speed (samples/sec) 131247.9429 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:27,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:27,199] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=97011.88856402044
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.57343049 ms
avg iteration GPU training time:16.65107801 ms
avg iteration (step) total cpu time:119.24593537 ms
Epoch Time(s): 5.4752
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.4809 | Train Acc 0.8682 | Speed (samples/sec) 131374.8468 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:29,927] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:29,927] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=97009.06326831588
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:31,011] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:31,011] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=97038.535510757
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00029 | Step 00020 | Loss 0.4913 | Train Acc 0.8701 | Speed (samples/sec) 131664.6756 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:32,337] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:32,337] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=97046.84412523216
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:33,275] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:33,275] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=97096.31861162143
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:8.94620325 ms
avg iteration GPU training time:15.42519587 ms
avg iteration (step) total cpu time:105.86018916 ms
Epoch Time(s): 5.1325
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.4827 | Train Acc 0.8698 | Speed (samples/sec) 131900.7425 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:36,034] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:36,034] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=97088.23904280874
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:37,412] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:37,412] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=97077.87075813915
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00030 | Step 00020 | Loss 0.4950 | Train Acc 0.8681 | Speed (samples/sec) 131803.6409 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:38,878] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:38,878] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=97103.61734320919
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12773335 ms
avg iteration GPU training time:15.59149742 ms
avg iteration (step) total cpu time:126.08812473 ms
Epoch Time(s): 5.6757
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.4740 | Train Acc 0.8753 | Speed (samples/sec) 131803.6610 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:41,307] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:41,307] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=97100.73652683425
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:42,693] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:42,693] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=97117.82481866177
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00031 | Step 00020 | Loss 0.4651 | Train Acc 0.8708 | Speed (samples/sec) 131935.3337 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:43,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:43,679] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=97137.55025452586
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.67442006 ms
avg iteration GPU training time:15.41609831 ms
avg iteration (step) total cpu time:109.68363727 ms
Epoch Time(s): 5.2631
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.4703 | Train Acc 0.8725 | Speed (samples/sec) 131948.7834 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:46,702] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:46,702] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=97144.4138629688
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:47,760] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:47,760] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=97176.8410923943
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00032 | Step 00020 | Loss 0.4889 | Train Acc 0.8714 | Speed (samples/sec) 132204.6453 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:49,467] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:49,467] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=97157.8038699169
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.07349449 ms
avg iteration GPU training time:15.63200947 ms
avg iteration (step) total cpu time:127.01627060 ms
Epoch Time(s): 5.8984
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.4789 | Train Acc 0.8692 | Speed (samples/sec) 132357.3342 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:51,996] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:51,997] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=97149.33300290338
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:53,473] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:53,473] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=97089.6142076158
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00033 | Step 00020 | Loss 0.4990 | Train Acc 0.8698 | Speed (samples/sec) 132319.0228 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:54,433] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:54,433] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=97113.16585040384
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.09771499 ms
avg iteration GPU training time:15.75976891 ms
avg iteration (step) total cpu time:108.22867464 ms
Epoch Time(s): 5.2398
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.4530 | Train Acc 0.8773 | Speed (samples/sec) 132346.0419 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:57,560] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:57,560] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=97123.11421032001
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:34:58,649] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:34:58,649] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=97138.72238233226
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00034 | Step 00020 | Loss 0.4750 | Train Acc 0.8700 | Speed (samples/sec) 132602.3737 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:00,290] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:00,291] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=97148.06109719718
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:01,526] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:01,526] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=97136.87369131159
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.84324858 ms
avg iteration GPU training time:15.72482003 ms
avg iteration (step) total cpu time:128.22039922 ms
Epoch Time(s): 6.2049
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.5022 | Train Acc 0.8679 | Speed (samples/sec) 132698.9094 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:04,439] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:04,440] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=97091.26165939626
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:05,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:05,590] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=97107.24836189566
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00035 | Step 00020 | Loss 0.4853 | Train Acc 0.8687 | Speed (samples/sec) 132870.0750 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:06,895] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:06,896] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=96895.97378683518
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69629985 ms
avg iteration GPU training time:17.41081008 ms
avg iteration (step) total cpu time:113.08430742 ms
Epoch Time(s): 5.3769
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4965 | Train Acc 0.8660 | Speed (samples/sec) 132819.2546 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:09,319] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:09,320] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=96930.15706025147
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:10,689] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:10,689] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=96970.37327458401
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00036 | Step 00020 | Loss 0.4869 | Train Acc 0.8674 | Speed (samples/sec) 133142.7224 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:11,786] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:11,786] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=96996.39488387377
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.97550463 ms
avg iteration GPU training time:15.09041539 ms
avg iteration (step) total cpu time:117.68163575 ms
Epoch Time(s): 5.4529
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4921 | Train Acc 0.8649 | Speed (samples/sec) 132969.7654 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:14,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:14,648] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=97003.64440664448
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:15,766] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:15,766] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=97000.87212655175
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00037 | Step 00020 | Loss 0.5086 | Train Acc 0.8679 | Speed (samples/sec) 133106.3759 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:17,368] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:17,369] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=97029.012024719
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.55107795 ms
avg iteration GPU training time:15.33040711 ms
avg iteration (step) total cpu time:121.14598133 ms
Epoch Time(s): 5.5259
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4626 | Train Acc 0.8724 | Speed (samples/sec) 133200.4377 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:19,741] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:19,741] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=97059.46806932644
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:21,194] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:21,194] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=96942.38212454534
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00038 | Step 00020 | Loss 0.4618 | Train Acc 0.8759 | Speed (samples/sec) 133306.7313 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:22,189] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:22,189] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=96971.16178269601
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.59763559 ms
avg iteration GPU training time:16.09377303 ms
avg iteration (step) total cpu time:115.60322620 ms
Epoch Time(s): 5.3628
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4755 | Train Acc 0.8695 | Speed (samples/sec) 133434.6588 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:25,420] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:25,420] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=97007.94461377474
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:26,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:26,508] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=97001.78786514401
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00039 | Step 00020 | Loss 0.4856 | Train Acc 0.8711 | Speed (samples/sec) 133602.2882 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:27,944] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:27,945] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=96947.71753547445
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:29,230] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:29,230] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=96913.83413246507
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:11.07275368 ms
avg iteration GPU training time:16.57173093 ms
avg iteration (step) total cpu time:123.92854691 ms
Epoch Time(s): 5.9746
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4764 | Train Acc 0.8714 | Speed (samples/sec) 133593.6192 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:32,177] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:32,177] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=96923.69335341867
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:33,324] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:33,324] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=96854.52134760587
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00040 | Step 00020 | Loss 0.4936 | Train Acc 0.8721 | Speed (samples/sec) 133648.0578 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:34,577] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:34,578] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=96873.7968859214
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.08275078 ms
avg iteration GPU training time:16.01541572 ms
avg iteration (step) total cpu time:111.67970410 ms
Epoch Time(s): 5.3997
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4791 | Train Acc 0.8761 | Speed (samples/sec) 133778.0004 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:36,995] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:36,995] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=96905.11166595979
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:38,381] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:38,381] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=96946.1909853709
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00041 | Step 00020 | Loss 0.4937 | Train Acc 0.8649 | Speed (samples/sec) 134042.6747 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:39,767] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:39,767] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=96969.42253856681
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37589682 ms
avg iteration GPU training time:15.13529721 ms
avg iteration (step) total cpu time:125.00183671 ms
Epoch Time(s): 5.6752
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4685 | Train Acc 0.8721 | Speed (samples/sec) 134170.5394 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:42,585] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:42,585] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=96973.77035335336
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:43,667] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:43,667] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=96960.41460821389
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00042 | Step 00020 | Loss 0.4397 | Train Acc 0.8821 | Speed (samples/sec) 133985.5441 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:45,287] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:45,287] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=96948.89797447743
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.40229215 ms
avg iteration GPU training time:15.92547184 ms
avg iteration (step) total cpu time:120.49560194 ms
Epoch Time(s): 5.5056
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4781 | Train Acc 0.8716 | Speed (samples/sec) 133791.7513 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:47,698] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:47,698] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=96949.83098579012
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:49,142] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:49,142] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=96969.88575307571
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00043 | Step 00020 | Loss 0.4816 | Train Acc 0.8730 | Speed (samples/sec) 133932.6454 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:50,220] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:50,220] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=97003.44457440186
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86926102 ms
avg iteration GPU training time:15.16852269 ms
avg iteration (step) total cpu time:110.17989229 ms
Epoch Time(s): 5.2985
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4676 | Train Acc 0.8741 | Speed (samples/sec) 133982.4036 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:52,910] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:52,910] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=96966.0042939981
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:53,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:53,986] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=96993.29410780458
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00044 | Step 00020 | Loss 0.4738 | Train Acc 0.8749 | Speed (samples/sec) 134109.2527 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:56,025] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:56,025] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=97006.89997028744
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:35:57,293] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:35:57,293] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=97043.75245227617
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.98932627 ms
avg iteration GPU training time:15.20241663 ms
avg iteration (step) total cpu time:143.77947207 ms
Epoch Time(s): 6.1946
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4647 | Train Acc 0.8719 | Speed (samples/sec) 134203.3619 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:00,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:00,295] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=97039.81225421761
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:01,412] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:01,412] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=97051.94236870998
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00045 | Step 00020 | Loss 0.4851 | Train Acc 0.8722 | Speed (samples/sec) 134272.9926 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:02,834] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:02,835] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=96956.58601058
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.98347855 ms
avg iteration GPU training time:16.45321482 ms
avg iteration (step) total cpu time:116.53521326 ms
Epoch Time(s): 5.5817
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4717 | Train Acc 0.8777 | Speed (samples/sec) 134394.6866 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:05,258] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:05,258] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=96962.68153863268
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:06,619] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:06,619] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=96977.69519123902
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00046 | Step 00020 | Loss 0.4859 | Train Acc 0.8708 | Speed (samples/sec) 134558.6395 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:07,912] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:07,912] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=97009.73879014543
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.05826961 ms
avg iteration GPU training time:15.33773624 ms
avg iteration (step) total cpu time:123.53891797 ms
Epoch Time(s): 5.5852
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.5065 | Train Acc 0.8676 | Speed (samples/sec) 134617.3478 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:10,749] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:10,749] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=97019.74793191308
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:11,807] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:11,807] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=97030.95609326549
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00047 | Step 00020 | Loss 0.4942 | Train Acc 0.8705 | Speed (samples/sec) 134740.0810 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:13,706] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:13,706] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=97054.8612989079
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.19876268 ms
avg iteration GPU training time:15.23898778 ms
avg iteration (step) total cpu time:130.20556061 ms
Epoch Time(s): 5.7376
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4863 | Train Acc 0.8693 | Speed (samples/sec) 134834.9124 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:16,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:16,092] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=97081.81284289938
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:17,575] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:17,575] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=97075.14286282433
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00048 | Step 00020 | Loss 0.4607 | Train Acc 0.8705 | Speed (samples/sec) 134822.0507 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:18,711] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:18,711] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=97067.57701144025
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:9.34605040 ms
avg iteration GPU training time:15.64285275 ms
avg iteration (step) total cpu time:114.30860449 ms
Epoch Time(s): 5.3779
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4462 | Train Acc 0.8751 | Speed (samples/sec) 134706.4353 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:21,361] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:21,361] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=97082.02050483835
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:22,430] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:22,430] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=97093.40696063406
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00049 | Step 00020 | Loss 0.4906 | Train Acc 0.8713 | Speed (samples/sec) 134737.0669 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:23,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:23,979] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=97091.1789728945
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:25,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:25,155] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=97123.69619093079
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.06352585 ms
avg iteration GPU training time:15.50735060 ms
avg iteration (step) total cpu time:122.76371320 ms
Epoch Time(s): 5.5400
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4816 | Train Acc 0.8709 | Speed (samples/sec) 134620.5376 | GPU 1480.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:27,904] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:27,905] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=97121.46556197229
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:29,145] [INFO] [logging.py:60:log_dist] [Rank 0] step=1620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:29,146] [INFO] [timer.py:160:stop] 0/1620, SamplesPerSec=97138.8886725916
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

Epoch 00050 | Step 00020 | Loss 0.4915 | Train Acc 0.8706 | Speed (samples/sec) 134664.2844 | GPU 1480.0 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

[2021-06-11 22:36:30,626] [INFO] [logging.py:60:log_dist] [Rank 0] step=1630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:36:30,626] [INFO] [timer.py:160:stop] 0/1630, SamplesPerSec=97077.80203858932
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.4452972412109375  GigaBytes

avg iteration(step) data from cpu to GPU time:10.35305715 ms
avg iteration GPU training time:16.10913905 ms
avg iteration (step) total cpu time:122.58882876 ms
Epoch Time(s): 5.5605
Eval Acc 0.8816
Test Acc: 0.6957
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4950 | Train Acc 0.8705 | Speed (samples/sec) 134701.4295 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:10,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=1640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:10,406] [INFO] [timer.py:160:stop] 0/1640, SamplesPerSec=97094.08152339443
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:12,165] [INFO] [logging.py:60:log_dist] [Rank 0] step=1650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:12,165] [INFO] [timer.py:160:stop] 0/1650, SamplesPerSec=97105.60586369417
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00051 | Step 00020 | Loss 0.4786 | Train Acc 0.8740 | Speed (samples/sec) 134794.9866 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:13,224] [INFO] [logging.py:60:log_dist] [Rank 0] step=1660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:13,224] [INFO] [timer.py:160:stop] 0/1660, SamplesPerSec=97108.42481631992
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.89071998 ms
avg iteration GPU training time:15.32676036 ms
avg iteration (step) total cpu time:124.99731558 ms
Epoch Time(s): 5.7965
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.5071 | Train Acc 0.8663 | Speed (samples/sec) 134903.1521 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:16,090] [INFO] [logging.py:60:log_dist] [Rank 0] step=1670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:16,091] [INFO] [timer.py:160:stop] 0/1670, SamplesPerSec=97124.07154187
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:17,240] [INFO] [logging.py:60:log_dist] [Rank 0] step=1680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:17,240] [INFO] [timer.py:160:stop] 0/1680, SamplesPerSec=97113.14052882788
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00052 | Step 00020 | Loss 0.5073 | Train Acc 0.8636 | Speed (samples/sec) 134490.6592 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:18,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=1690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:18,388] [INFO] [timer.py:160:stop] 0/1690, SamplesPerSec=97115.2177542646
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12783526 ms
avg iteration GPU training time:15.90825247 ms
avg iteration (step) total cpu time:110.78831002 ms
Epoch Time(s): 5.3877
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4876 | Train Acc 0.8697 | Speed (samples/sec) 134203.5016 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:20,931] [INFO] [logging.py:60:log_dist] [Rank 0] step=1700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:20,931] [INFO] [timer.py:160:stop] 0/1700, SamplesPerSec=97100.96645385468
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:22,447] [INFO] [logging.py:60:log_dist] [Rank 0] step=1710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:22,447] [INFO] [timer.py:160:stop] 0/1710, SamplesPerSec=97094.84006102466
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00053 | Step 00020 | Loss 0.5223 | Train Acc 0.8604 | Speed (samples/sec) 134290.6596 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:23,764] [INFO] [logging.py:60:log_dist] [Rank 0] step=1720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:23,764] [INFO] [timer.py:160:stop] 0/1720, SamplesPerSec=97101.18590653467
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58127161 ms
avg iteration GPU training time:15.58135580 ms
avg iteration (step) total cpu time:132.03491988 ms
Epoch Time(s): 5.8384
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4625 | Train Acc 0.8721 | Speed (samples/sec) 134377.3214 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:26,696] [INFO] [logging.py:60:log_dist] [Rank 0] step=1730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:26,696] [INFO] [timer.py:160:stop] 0/1730, SamplesPerSec=97110.16802872585
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:27,899] [INFO] [logging.py:60:log_dist] [Rank 0] step=1740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:27,899] [INFO] [timer.py:160:stop] 0/1740, SamplesPerSec=97113.92659228225
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00054 | Step 00020 | Loss 0.4869 | Train Acc 0.8681 | Speed (samples/sec) 134291.0331 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:29,387] [INFO] [logging.py:60:log_dist] [Rank 0] step=1750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:29,387] [INFO] [timer.py:160:stop] 0/1750, SamplesPerSec=97046.66140070117
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:30,378] [INFO] [logging.py:60:log_dist] [Rank 0] step=1760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:30,379] [INFO] [timer.py:160:stop] 0/1760, SamplesPerSec=97033.87323957995
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.25419018 ms
avg iteration GPU training time:16.68508201 ms
avg iteration (step) total cpu time:115.13074239 ms
Epoch Time(s): 5.5011
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4625 | Train Acc 0.8772 | Speed (samples/sec) 134368.7655 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:33,353] [INFO] [logging.py:60:log_dist] [Rank 0] step=1770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:33,353] [INFO] [timer.py:160:stop] 0/1770, SamplesPerSec=97031.9672664342
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:34,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=1780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:34,388] [INFO] [timer.py:160:stop] 0/1780, SamplesPerSec=97056.69624304237
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00055 | Step 00020 | Loss 0.4580 | Train Acc 0.8753 | Speed (samples/sec) 134228.7313 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:35,970] [INFO] [logging.py:60:log_dist] [Rank 0] step=1790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:35,970] [INFO] [timer.py:160:stop] 0/1790, SamplesPerSec=97070.84098634767
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.30756512 ms
avg iteration GPU training time:15.32971262 ms
avg iteration (step) total cpu time:125.24124428 ms
Epoch Time(s): 5.6210
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4723 | Train Acc 0.8735 | Speed (samples/sec) 134050.5150 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:38,475] [INFO] [logging.py:60:log_dist] [Rank 0] step=1800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:38,476] [INFO] [timer.py:160:stop] 0/1800, SamplesPerSec=97075.61536075386
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:40,058] [INFO] [logging.py:60:log_dist] [Rank 0] step=1810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:40,058] [INFO] [timer.py:160:stop] 0/1810, SamplesPerSec=97088.31935575763
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00056 | Step 00020 | Loss 0.4881 | Train Acc 0.8695 | Speed (samples/sec) 133818.9299 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:41,330] [INFO] [logging.py:60:log_dist] [Rank 0] step=1820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:41,331] [INFO] [timer.py:160:stop] 0/1820, SamplesPerSec=97112.23262506493
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.78148263 ms
avg iteration GPU training time:15.32571620 ms
avg iteration (step) total cpu time:120.79098490 ms
Epoch Time(s): 5.6004
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4760 | Train Acc 0.8701 | Speed (samples/sec) 133656.2705 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:44,057] [INFO] [logging.py:60:log_dist] [Rank 0] step=1830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:44,057] [INFO] [timer.py:160:stop] 0/1830, SamplesPerSec=97087.06158262074
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:45,112] [INFO] [logging.py:60:log_dist] [Rank 0] step=1840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:45,112] [INFO] [timer.py:160:stop] 0/1840, SamplesPerSec=97114.15021928186
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00057 | Step 00020 | Loss 0.4746 | Train Acc 0.8730 | Speed (samples/sec) 133575.3671 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:46,429] [INFO] [logging.py:60:log_dist] [Rank 0] step=1850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:46,429] [INFO] [timer.py:160:stop] 0/1850, SamplesPerSec=97131.41281773236
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.77820331 ms
avg iteration GPU training time:15.17807056 ms
avg iteration (step) total cpu time:110.38589478 ms
Epoch Time(s): 5.3536
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4734 | Train Acc 0.8770 | Speed (samples/sec) 133305.7599 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:49,511] [INFO] [logging.py:60:log_dist] [Rank 0] step=1860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:49,511] [INFO] [timer.py:160:stop] 0/1860, SamplesPerSec=97153.69621704296
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:50,915] [INFO] [logging.py:60:log_dist] [Rank 0] step=1870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:50,916] [INFO] [timer.py:160:stop] 0/1870, SamplesPerSec=97160.80823193077
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00058 | Step 00020 | Loss 0.5054 | Train Acc 0.8650 | Speed (samples/sec) 133408.2224 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:52,228] [INFO] [logging.py:60:log_dist] [Rank 0] step=1880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:52,228] [INFO] [timer.py:160:stop] 0/1880, SamplesPerSec=97177.76171347375
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.31946912 ms
avg iteration GPU training time:15.42704349 ms
avg iteration (step) total cpu time:121.92990162 ms
Epoch Time(s): 6.1784
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4617 | Train Acc 0.8753 | Speed (samples/sec) 133471.5212 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:55,038] [INFO] [logging.py:60:log_dist] [Rank 0] step=1890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:55,038] [INFO] [timer.py:160:stop] 0/1890, SamplesPerSec=97184.36266190304
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:56,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=1900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:56,122] [INFO] [timer.py:160:stop] 0/1900, SamplesPerSec=97195.34163014944
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00059 | Step 00020 | Loss 0.4811 | Train Acc 0.8692 | Speed (samples/sec) 133471.9667 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:57,792] [INFO] [logging.py:60:log_dist] [Rank 0] step=1910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:57,792] [INFO] [timer.py:160:stop] 0/1910, SamplesPerSec=97186.83135668155
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:37:58,803] [INFO] [logging.py:60:log_dist] [Rank 0] step=1920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:37:58,803] [INFO] [timer.py:160:stop] 0/1920, SamplesPerSec=97227.10713731144
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.50839816 ms
avg iteration GPU training time:15.32638585 ms
avg iteration (step) total cpu time:121.84512174 ms
Epoch Time(s): 5.6712
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4607 | Train Acc 0.8745 | Speed (samples/sec) 133544.5006 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:01,764] [INFO] [logging.py:60:log_dist] [Rank 0] step=1930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:01,764] [INFO] [timer.py:160:stop] 0/1930, SamplesPerSec=97212.8022095088
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:02,770] [INFO] [logging.py:60:log_dist] [Rank 0] step=1940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:02,771] [INFO] [timer.py:160:stop] 0/1940, SamplesPerSec=97232.0416694747
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00060 | Step 00020 | Loss 0.4622 | Train Acc 0.8762 | Speed (samples/sec) 133719.5219 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:04,024] [INFO] [logging.py:60:log_dist] [Rank 0] step=1950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:04,024] [INFO] [timer.py:160:stop] 0/1950, SamplesPerSec=97251.65830229699
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58131204 ms
avg iteration GPU training time:15.07314618 ms
avg iteration (step) total cpu time:105.52309178 ms
Epoch Time(s): 5.2953
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4512 | Train Acc 0.8751 | Speed (samples/sec) 133765.3272 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:06,622] [INFO] [logging.py:60:log_dist] [Rank 0] step=1960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:06,622] [INFO] [timer.py:160:stop] 0/1960, SamplesPerSec=97267.48559460763
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:07,971] [INFO] [logging.py:60:log_dist] [Rank 0] step=1970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:07,971] [INFO] [timer.py:160:stop] 0/1970, SamplesPerSec=97283.44069375929
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00061 | Step 00020 | Loss 0.5095 | Train Acc 0.8649 | Speed (samples/sec) 133845.1414 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:09,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=1980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:09,208] [INFO] [timer.py:160:stop] 0/1980, SamplesPerSec=97291.87156569152
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12885452 ms
avg iteration GPU training time:15.33523803 ms
avg iteration (step) total cpu time:118.43974502 ms
Epoch Time(s): 5.6231
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.5035 | Train Acc 0.8655 | Speed (samples/sec) 133814.9153 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:12,173] [INFO] [logging.py:60:log_dist] [Rank 0] step=1990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:12,173] [INFO] [timer.py:160:stop] 0/1990, SamplesPerSec=97281.6382758289
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:13,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=2000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:13,284] [INFO] [timer.py:160:stop] 0/2000, SamplesPerSec=97298.778645129
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00062 | Step 00020 | Loss 0.5005 | Train Acc 0.8612 | Speed (samples/sec) 133862.2388 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:14,613] [INFO] [logging.py:60:log_dist] [Rank 0] step=2010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:14,614] [INFO] [timer.py:160:stop] 0/2010, SamplesPerSec=97307.68956085862
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.10257426 ms
avg iteration GPU training time:20.16063892 ms
avg iteration (step) total cpu time:115.26780658 ms
Epoch Time(s): 5.4899
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4918 | Train Acc 0.8695 | Speed (samples/sec) 133908.1877 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:17,100] [INFO] [logging.py:60:log_dist] [Rank 0] step=2020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:17,101] [INFO] [timer.py:160:stop] 0/2020, SamplesPerSec=96911.56557339834
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:18,539] [INFO] [logging.py:60:log_dist] [Rank 0] step=2030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:18,539] [INFO] [timer.py:160:stop] 0/2030, SamplesPerSec=96904.2748212345
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00063 | Step 00020 | Loss 0.4910 | Train Acc 0.8676 | Speed (samples/sec) 133951.3991 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:19,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=2040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:19,597] [INFO] [timer.py:160:stop] 0/2040, SamplesPerSec=96913.64158356684
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.43830156 ms
avg iteration GPU training time:15.59769595 ms
avg iteration (step) total cpu time:118.37924851 ms
Epoch Time(s): 5.5103
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.4754 | Train Acc 0.8722 | Speed (samples/sec) 133999.7436 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:22,550] [INFO] [logging.py:60:log_dist] [Rank 0] step=2050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:22,551] [INFO] [timer.py:160:stop] 0/2050, SamplesPerSec=96921.07850926649
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:23,654] [INFO] [logging.py:60:log_dist] [Rank 0] step=2060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:23,655] [INFO] [timer.py:160:stop] 0/2060, SamplesPerSec=96930.4695188954
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00064 | Step 00020 | Loss 0.4746 | Train Acc 0.8673 | Speed (samples/sec) 133934.0695 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:25,343] [INFO] [logging.py:60:log_dist] [Rank 0] step=2070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:25,343] [INFO] [timer.py:160:stop] 0/2070, SamplesPerSec=96937.67983825713
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:26,316] [INFO] [logging.py:60:log_dist] [Rank 0] step=2080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:26,316] [INFO] [timer.py:160:stop] 0/2080, SamplesPerSec=96962.11021615638
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12829862 ms
avg iteration GPU training time:15.36516274 ms
avg iteration (step) total cpu time:121.57768673 ms
Epoch Time(s): 5.5935
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4697 | Train Acc 0.8676 | Speed (samples/sec) 133936.1907 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:29,213] [INFO] [logging.py:60:log_dist] [Rank 0] step=2090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:29,213] [INFO] [timer.py:160:stop] 0/2090, SamplesPerSec=96937.09569496407
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:30,229] [INFO] [logging.py:60:log_dist] [Rank 0] step=2100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:30,229] [INFO] [timer.py:160:stop] 0/2100, SamplesPerSec=96944.11888489526
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00065 | Step 00020 | Loss 0.5167 | Train Acc 0.8628 | Speed (samples/sec) 133965.0295 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:31,521] [INFO] [logging.py:60:log_dist] [Rank 0] step=2110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:31,521] [INFO] [timer.py:160:stop] 0/2110, SamplesPerSec=96952.94824809073
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.63967293 ms
avg iteration GPU training time:15.59780979 ms
avg iteration (step) total cpu time:107.69765465 ms
Epoch Time(s): 5.2179
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.4844 | Train Acc 0.8692 | Speed (samples/sec) 133999.2998 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:33,968] [INFO] [logging.py:60:log_dist] [Rank 0] step=2120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:33,969] [INFO] [timer.py:160:stop] 0/2120, SamplesPerSec=96966.40484296746
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:35,326] [INFO] [logging.py:60:log_dist] [Rank 0] step=2130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:35,326] [INFO] [timer.py:160:stop] 0/2130, SamplesPerSec=96971.61013372433
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00066 | Step 00020 | Loss 0.4983 | Train Acc 0.8679 | Speed (samples/sec) 134131.4472 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:36,683] [INFO] [logging.py:60:log_dist] [Rank 0] step=2140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:36,683] [INFO] [timer.py:160:stop] 0/2140, SamplesPerSec=96979.40668309914
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.16588324 ms
avg iteration GPU training time:15.50492209 ms
avg iteration (step) total cpu time:124.25098596 ms
Epoch Time(s): 5.6404
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.4555 | Train Acc 0.8783 | Speed (samples/sec) 134172.4250 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:39,496] [INFO] [logging.py:60:log_dist] [Rank 0] step=2150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:39,496] [INFO] [timer.py:160:stop] 0/2150, SamplesPerSec=96992.73264731182
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:40,594] [INFO] [logging.py:60:log_dist] [Rank 0] step=2160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:40,594] [INFO] [timer.py:160:stop] 0/2160, SamplesPerSec=97010.80658534089
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00067 | Step 00020 | Loss 0.5058 | Train Acc 0.8669 | Speed (samples/sec) 134237.6970 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:42,232] [INFO] [logging.py:60:log_dist] [Rank 0] step=2170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:42,233] [INFO] [timer.py:160:stop] 0/2170, SamplesPerSec=97034.96805510948
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.43826607 ms
avg iteration GPU training time:15.04078106 ms
avg iteration (step) total cpu time:122.12067180 ms
Epoch Time(s): 5.5597
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.4896 | Train Acc 0.8725 | Speed (samples/sec) 134341.7306 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:44,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=2180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:44,648] [INFO] [timer.py:160:stop] 0/2180, SamplesPerSec=97031.70765251308
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:46,054] [INFO] [logging.py:60:log_dist] [Rank 0] step=2190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:46,054] [INFO] [timer.py:160:stop] 0/2190, SamplesPerSec=97047.49168395337
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00068 | Step 00020 | Loss 0.4722 | Train Acc 0.8676 | Speed (samples/sec) 134383.8127 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:47,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=2200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:47,035] [INFO] [timer.py:160:stop] 0/2200, SamplesPerSec=97060.99592341747
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.85788681 ms
avg iteration GPU training time:15.34312778 ms
avg iteration (step) total cpu time:105.37877789 ms
Epoch Time(s): 5.1885
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.4823 | Train Acc 0.8692 | Speed (samples/sec) 134336.7861 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:49,706] [INFO] [logging.py:60:log_dist] [Rank 0] step=2210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:49,706] [INFO] [timer.py:160:stop] 0/2210, SamplesPerSec=97067.64252960346
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:50,731] [INFO] [logging.py:60:log_dist] [Rank 0] step=2220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:50,731] [INFO] [timer.py:160:stop] 0/2220, SamplesPerSec=97073.50551163443
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00069 | Step 00020 | Loss 0.4811 | Train Acc 0.8709 | Speed (samples/sec) 134194.8602 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:52,404] [INFO] [logging.py:60:log_dist] [Rank 0] step=2230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:52,404] [INFO] [timer.py:160:stop] 0/2230, SamplesPerSec=97078.54405328917
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:53,447] [INFO] [logging.py:60:log_dist] [Rank 0] step=2240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:53,447] [INFO] [timer.py:160:stop] 0/2240, SamplesPerSec=97086.64683573227
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.23341516 ms
avg iteration GPU training time:15.60106553 ms
avg iteration (step) total cpu time:121.57871105 ms
Epoch Time(s): 5.4897
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.4914 | Train Acc 0.8653 | Speed (samples/sec) 134008.8346 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:56,263] [INFO] [logging.py:60:log_dist] [Rank 0] step=2250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:56,264] [INFO] [timer.py:160:stop] 0/2250, SamplesPerSec=97082.90206520651
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:57,323] [INFO] [logging.py:60:log_dist] [Rank 0] step=2260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:57,323] [INFO] [timer.py:160:stop] 0/2260, SamplesPerSec=97100.98310890413
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00070 | Step 00020 | Loss 0.4971 | Train Acc 0.8679 | Speed (samples/sec) 134041.9222 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:38:58,671] [INFO] [logging.py:60:log_dist] [Rank 0] step=2270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:38:58,671] [INFO] [timer.py:160:stop] 0/2270, SamplesPerSec=97092.71103786449
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.87556150 ms
avg iteration GPU training time:15.43587550 ms
avg iteration (step) total cpu time:110.86989332 ms
Epoch Time(s): 5.3410
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.4766 | Train Acc 0.8692 | Speed (samples/sec) 134079.3668 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:01,147] [INFO] [logging.py:60:log_dist] [Rank 0] step=2280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:01,148] [INFO] [timer.py:160:stop] 0/2280, SamplesPerSec=97103.40174392571
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:02,517] [INFO] [logging.py:60:log_dist] [Rank 0] step=2290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:02,517] [INFO] [timer.py:160:stop] 0/2290, SamplesPerSec=97109.77301599093
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00071 | Step 00020 | Loss 0.4667 | Train Acc 0.8732 | Speed (samples/sec) 134142.5134 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:03,845] [INFO] [logging.py:60:log_dist] [Rank 0] step=2300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:03,845] [INFO] [timer.py:160:stop] 0/2300, SamplesPerSec=97116.73549429115
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.62812097 ms
avg iteration GPU training time:15.64658737 ms
avg iteration (step) total cpu time:123.86850074 ms
Epoch Time(s): 5.6357
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.4849 | Train Acc 0.8725 | Speed (samples/sec) 134007.6262 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:06,797] [INFO] [logging.py:60:log_dist] [Rank 0] step=2310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:06,797] [INFO] [timer.py:160:stop] 0/2310, SamplesPerSec=97089.83285203906
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:07,904] [INFO] [logging.py:60:log_dist] [Rank 0] step=2320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:07,904] [INFO] [timer.py:160:stop] 0/2320, SamplesPerSec=97088.38343978224
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00072 | Step 00020 | Loss 0.4681 | Train Acc 0.8773 | Speed (samples/sec) 134126.1084 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:09,221] [INFO] [logging.py:60:log_dist] [Rank 0] step=2330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:09,221] [INFO] [timer.py:160:stop] 0/2330, SamplesPerSec=97097.77880813606
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75927109 ms
avg iteration GPU training time:15.44883438 ms
avg iteration (step) total cpu time:108.63694438 ms
Epoch Time(s): 5.3040
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.4720 | Train Acc 0.8773 | Speed (samples/sec) 134232.1186 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:11,565] [INFO] [logging.py:60:log_dist] [Rank 0] step=2340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:11,565] [INFO] [timer.py:160:stop] 0/2340, SamplesPerSec=97112.48602657707
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:12,960] [INFO] [logging.py:60:log_dist] [Rank 0] step=2350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:12,961] [INFO] [timer.py:160:stop] 0/2350, SamplesPerSec=97125.46183834008
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00073 | Step 00020 | Loss 0.4785 | Train Acc 0.8714 | Speed (samples/sec) 134279.7328 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:14,005] [INFO] [logging.py:60:log_dist] [Rank 0] step=2360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:14,006] [INFO] [timer.py:160:stop] 0/2360, SamplesPerSec=97120.1048153866
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68680654 ms
avg iteration GPU training time:15.64193295 ms
avg iteration (step) total cpu time:119.91869962 ms
Epoch Time(s): 5.5035
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.4691 | Train Acc 0.8727 | Speed (samples/sec) 134313.7733 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:16,991] [INFO] [logging.py:60:log_dist] [Rank 0] step=2370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:16,991] [INFO] [timer.py:160:stop] 0/2370, SamplesPerSec=97119.54679202652
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:18,068] [INFO] [logging.py:60:log_dist] [Rank 0] step=2380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:18,068] [INFO] [timer.py:160:stop] 0/2380, SamplesPerSec=97132.19041816765
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00074 | Step 00020 | Loss 0.4791 | Train Acc 0.8738 | Speed (samples/sec) 134076.3781 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:19,738] [INFO] [logging.py:60:log_dist] [Rank 0] step=2390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:19,738] [INFO] [timer.py:160:stop] 0/2390, SamplesPerSec=97137.9907250786
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:20,734] [INFO] [logging.py:60:log_dist] [Rank 0] step=2400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:20,735] [INFO] [timer.py:160:stop] 0/2400, SamplesPerSec=97147.52340102267
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.31479466 ms
avg iteration GPU training time:15.50056295 ms
avg iteration (step) total cpu time:121.53281989 ms
Epoch Time(s): 5.5464
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.4787 | Train Acc 0.8690 | Speed (samples/sec) 133903.4451 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:23,574] [INFO] [logging.py:60:log_dist] [Rank 0] step=2410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:23,574] [INFO] [timer.py:160:stop] 0/2410, SamplesPerSec=97116.22555885068
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:24,581] [INFO] [logging.py:60:log_dist] [Rank 0] step=2420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:24,582] [INFO] [timer.py:160:stop] 0/2420, SamplesPerSec=97119.45047009985
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00075 | Step 00020 | Loss 0.4545 | Train Acc 0.8753 | Speed (samples/sec) 133771.9453 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:25,877] [INFO] [logging.py:60:log_dist] [Rank 0] step=2430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:25,877] [INFO] [timer.py:160:stop] 0/2430, SamplesPerSec=97123.9729794957
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.43787845 ms
avg iteration GPU training time:15.67747907 ms
avg iteration (step) total cpu time:108.72170660 ms
Epoch Time(s): 5.1504
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.4746 | Train Acc 0.8644 | Speed (samples/sec) 133601.9278 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:28,262] [INFO] [logging.py:60:log_dist] [Rank 0] step=2440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:28,262] [INFO] [timer.py:160:stop] 0/2440, SamplesPerSec=97134.02406666016
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:29,654] [INFO] [logging.py:60:log_dist] [Rank 0] step=2450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:29,654] [INFO] [timer.py:160:stop] 0/2450, SamplesPerSec=97131.49639006797
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00076 | Step 00020 | Loss 0.4840 | Train Acc 0.8738 | Speed (samples/sec) 133632.7777 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:30,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=2460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:30,880] [INFO] [timer.py:160:stop] 0/2460, SamplesPerSec=97134.87673974919
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.61733207 ms
avg iteration GPU training time:15.72681491 ms
avg iteration (step) total cpu time:120.84482334 ms
Epoch Time(s): 5.4728
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.5024 | Train Acc 0.8663 | Speed (samples/sec) 133647.1452 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:33,709] [INFO] [logging.py:60:log_dist] [Rank 0] step=2470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:33,709] [INFO] [timer.py:160:stop] 0/2470, SamplesPerSec=97121.95682025065
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:34,816] [INFO] [logging.py:60:log_dist] [Rank 0] step=2480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:34,817] [INFO] [timer.py:160:stop] 0/2480, SamplesPerSec=97076.7236565536
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00077 | Step 00020 | Loss 0.4849 | Train Acc 0.8693 | Speed (samples/sec) 133664.0953 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:36,204] [INFO] [logging.py:60:log_dist] [Rank 0] step=2490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:36,205] [INFO] [timer.py:160:stop] 0/2490, SamplesPerSec=97063.4931775862
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.94422883 ms
avg iteration GPU training time:16.34986076 ms
avg iteration (step) total cpu time:111.61619646 ms
Epoch Time(s): 5.3240
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.4853 | Train Acc 0.8714 | Speed (samples/sec) 133716.4726 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:38,543] [INFO] [logging.py:60:log_dist] [Rank 0] step=2500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:38,544] [INFO] [timer.py:160:stop] 0/2500, SamplesPerSec=97068.8236274096
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:39,926] [INFO] [logging.py:60:log_dist] [Rank 0] step=2510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:39,926] [INFO] [timer.py:160:stop] 0/2510, SamplesPerSec=97072.63168345409
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00078 | Step 00020 | Loss 0.4673 | Train Acc 0.8748 | Speed (samples/sec) 133695.7216 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:40,946] [INFO] [logging.py:60:log_dist] [Rank 0] step=2520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:40,946] [INFO] [timer.py:160:stop] 0/2520, SamplesPerSec=97074.80605074884
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.13032179 ms
avg iteration GPU training time:15.76142929 ms
avg iteration (step) total cpu time:120.59412179 ms
Epoch Time(s): 5.4698
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.4881 | Train Acc 0.8692 | Speed (samples/sec) 133573.5160 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:43,961] [INFO] [logging.py:60:log_dist] [Rank 0] step=2530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:43,961] [INFO] [timer.py:160:stop] 0/2530, SamplesPerSec=97063.59845917586
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:45,015] [INFO] [logging.py:60:log_dist] [Rank 0] step=2540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:45,016] [INFO] [timer.py:160:stop] 0/2540, SamplesPerSec=97073.81210750269
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00079 | Step 00020 | Loss 0.4487 | Train Acc 0.8769 | Speed (samples/sec) 133608.3640 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:46,666] [INFO] [logging.py:60:log_dist] [Rank 0] step=2550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:46,666] [INFO] [timer.py:160:stop] 0/2550, SamplesPerSec=97071.61573988009
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:47,695] [INFO] [logging.py:60:log_dist] [Rank 0] step=2560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:47,695] [INFO] [timer.py:160:stop] 0/2560, SamplesPerSec=97087.56478443736
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.82457482 ms
avg iteration GPU training time:15.48657873 ms
avg iteration (step) total cpu time:120.71406400 ms
Epoch Time(s): 5.4980
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.4616 | Train Acc 0.8713 | Speed (samples/sec) 133622.1799 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:50,514] [INFO] [logging.py:60:log_dist] [Rank 0] step=2570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:50,514] [INFO] [timer.py:160:stop] 0/2570, SamplesPerSec=97087.49286376724
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:51,551] [INFO] [logging.py:60:log_dist] [Rank 0] step=2580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:51,552] [INFO] [timer.py:160:stop] 0/2580, SamplesPerSec=97088.8453513933
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00080 | Step 00020 | Loss 0.4671 | Train Acc 0.8722 | Speed (samples/sec) 133631.1735 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:52,895] [INFO] [logging.py:60:log_dist] [Rank 0] step=2590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:52,895] [INFO] [timer.py:160:stop] 0/2590, SamplesPerSec=97108.17501815989
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.66349033 ms
avg iteration GPU training time:15.36242965 ms
avg iteration (step) total cpu time:110.33591518 ms
Epoch Time(s): 5.2559
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.4714 | Train Acc 0.8709 | Speed (samples/sec) 133599.3589 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:55,318] [INFO] [logging.py:60:log_dist] [Rank 0] step=2600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:55,318] [INFO] [timer.py:160:stop] 0/2600, SamplesPerSec=97114.48597143836
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:56,688] [INFO] [logging.py:60:log_dist] [Rank 0] step=2610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:56,688] [INFO] [timer.py:160:stop] 0/2610, SamplesPerSec=97118.2700125613
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00081 | Step 00020 | Loss 0.5147 | Train Acc 0.8668 | Speed (samples/sec) 133627.3825 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:39:57,875] [INFO] [logging.py:60:log_dist] [Rank 0] step=2620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:39:57,875] [INFO] [timer.py:160:stop] 0/2620, SamplesPerSec=97117.17848625926
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.08909268 ms
avg iteration GPU training time:15.57383343 ms
avg iteration (step) total cpu time:118.54038415 ms
Epoch Time(s): 5.5085
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.4990 | Train Acc 0.8608 | Speed (samples/sec) 133534.0535 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:00,739] [INFO] [logging.py:60:log_dist] [Rank 0] step=2630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:00,739] [INFO] [timer.py:160:stop] 0/2630, SamplesPerSec=97126.57930039664
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:01,876] [INFO] [logging.py:60:log_dist] [Rank 0] step=2640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:01,877] [INFO] [timer.py:160:stop] 0/2640, SamplesPerSec=97139.67712811481
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00082 | Step 00020 | Loss 0.4960 | Train Acc 0.8692 | Speed (samples/sec) 133484.9075 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:03,252] [INFO] [logging.py:60:log_dist] [Rank 0] step=2650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:03,252] [INFO] [timer.py:160:stop] 0/2650, SamplesPerSec=97152.21325200523
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.74786133 ms
avg iteration GPU training time:15.14558464 ms
avg iteration (step) total cpu time:114.72193400 ms
Epoch Time(s): 5.3784
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4669 | Train Acc 0.8684 | Speed (samples/sec) 133452.9686 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:05,695] [INFO] [logging.py:60:log_dist] [Rank 0] step=2660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:05,696] [INFO] [timer.py:160:stop] 0/2660, SamplesPerSec=97157.08977453019
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:07,099] [INFO] [logging.py:60:log_dist] [Rank 0] step=2670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:07,099] [INFO] [timer.py:160:stop] 0/2670, SamplesPerSec=97169.79564425812
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00083 | Step 00020 | Loss 0.4650 | Train Acc 0.8740 | Speed (samples/sec) 133527.2534 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:08,138] [INFO] [logging.py:60:log_dist] [Rank 0] step=2680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:08,138] [INFO] [timer.py:160:stop] 0/2680, SamplesPerSec=97181.06180812322
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.55106854 ms
avg iteration GPU training time:15.21947380 ms
avg iteration (step) total cpu time:120.13524550 ms
Epoch Time(s): 5.4872
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.4798 | Train Acc 0.8746 | Speed (samples/sec) 133431.4443 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:11,083] [INFO] [logging.py:60:log_dist] [Rank 0] step=2690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:11,083] [INFO] [timer.py:160:stop] 0/2690, SamplesPerSec=97187.41472326226
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:12,176] [INFO] [logging.py:60:log_dist] [Rank 0] step=2700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:12,176] [INFO] [timer.py:160:stop] 0/2700, SamplesPerSec=97200.1340502869
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00084 | Step 00020 | Loss 0.4982 | Train Acc 0.8692 | Speed (samples/sec) 133430.3448 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:13,726] [INFO] [logging.py:60:log_dist] [Rank 0] step=2710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:13,726] [INFO] [timer.py:160:stop] 0/2710, SamplesPerSec=97205.12531320027
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:14,872] [INFO] [logging.py:60:log_dist] [Rank 0] step=2720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:14,872] [INFO] [timer.py:160:stop] 0/2720, SamplesPerSec=97214.62416141744
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.04446109 ms
avg iteration GPU training time:15.40593306 ms
avg iteration (step) total cpu time:122.03280131 ms
Epoch Time(s): 5.5947
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.4894 | Train Acc 0.8681 | Speed (samples/sec) 133421.2369 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:17,765] [INFO] [logging.py:60:log_dist] [Rank 0] step=2730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:17,765] [INFO] [timer.py:160:stop] 0/2730, SamplesPerSec=97210.70748880533
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:18,807] [INFO] [logging.py:60:log_dist] [Rank 0] step=2740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:18,807] [INFO] [timer.py:160:stop] 0/2740, SamplesPerSec=97200.56732472636
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00085 | Step 00020 | Loss 0.4782 | Train Acc 0.8764 | Speed (samples/sec) 133509.8499 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:20,084] [INFO] [logging.py:60:log_dist] [Rank 0] step=2750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:20,085] [INFO] [timer.py:160:stop] 0/2750, SamplesPerSec=97210.43675444598
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.30372738 ms
avg iteration GPU training time:15.56063641 ms
avg iteration (step) total cpu time:108.97902206 ms
Epoch Time(s): 5.2443
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4538 | Train Acc 0.8802 | Speed (samples/sec) 133516.8638 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:22,526] [INFO] [logging.py:60:log_dist] [Rank 0] step=2760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:22,527] [INFO] [timer.py:160:stop] 0/2760, SamplesPerSec=97211.72456437326
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:23,870] [INFO] [logging.py:60:log_dist] [Rank 0] step=2770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:23,871] [INFO] [timer.py:160:stop] 0/2770, SamplesPerSec=97221.28541267727
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00086 | Step 00020 | Loss 0.4798 | Train Acc 0.8740 | Speed (samples/sec) 133560.1626 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:25,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=2780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:25,023] [INFO] [timer.py:160:stop] 0/2780, SamplesPerSec=97235.0861963736
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.99260207 ms
avg iteration GPU training time:15.22305174 ms
avg iteration (step) total cpu time:117.21709039 ms
Epoch Time(s): 5.4657
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4466 | Train Acc 0.8789 | Speed (samples/sec) 133596.6955 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:27,966] [INFO] [logging.py:60:log_dist] [Rank 0] step=2790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:27,966] [INFO] [timer.py:160:stop] 0/2790, SamplesPerSec=97221.00027294699
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:29,134] [INFO] [logging.py:60:log_dist] [Rank 0] step=2800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:29,134] [INFO] [timer.py:160:stop] 0/2800, SamplesPerSec=97206.33790292092
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00087 | Step 00020 | Loss 0.5013 | Train Acc 0.8722 | Speed (samples/sec) 133417.0319 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:30,830] [INFO] [logging.py:60:log_dist] [Rank 0] step=2810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:30,831] [INFO] [timer.py:160:stop] 0/2810, SamplesPerSec=97201.63185365015
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.80509875 ms
avg iteration GPU training time:17.00030115 ms
avg iteration (step) total cpu time:129.77484420 ms
Epoch Time(s): 5.7663
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4744 | Train Acc 0.8721 | Speed (samples/sec) 133254.2646 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:33,297] [INFO] [logging.py:60:log_dist] [Rank 0] step=2820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:33,297] [INFO] [timer.py:160:stop] 0/2820, SamplesPerSec=97152.07467245638
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:34,700] [INFO] [logging.py:60:log_dist] [Rank 0] step=2830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:34,701] [INFO] [timer.py:160:stop] 0/2830, SamplesPerSec=97152.59425141927
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00088 | Step 00020 | Loss 0.4688 | Train Acc 0.8765 | Speed (samples/sec) 133346.7576 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:35,691] [INFO] [logging.py:60:log_dist] [Rank 0] step=2840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:35,691] [INFO] [timer.py:160:stop] 0/2840, SamplesPerSec=97168.84573815006
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11042489 ms
avg iteration GPU training time:15.25501385 ms
avg iteration (step) total cpu time:105.34351843 ms
Epoch Time(s): 5.2068
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.5191 | Train Acc 0.8602 | Speed (samples/sec) 133406.2697 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:38,369] [INFO] [logging.py:60:log_dist] [Rank 0] step=2850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:38,369] [INFO] [timer.py:160:stop] 0/2850, SamplesPerSec=97177.65419710478
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:39,445] [INFO] [logging.py:60:log_dist] [Rank 0] step=2860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:39,445] [INFO] [timer.py:160:stop] 0/2860, SamplesPerSec=97161.07769962898
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00089 | Step 00020 | Loss 0.4610 | Train Acc 0.8785 | Speed (samples/sec) 133399.9596 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:40,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=2870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:40,894] [INFO] [timer.py:160:stop] 0/2870, SamplesPerSec=97167.29950170722
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:42,142] [INFO] [logging.py:60:log_dist] [Rank 0] step=2880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:42,143] [INFO] [timer.py:160:stop] 0/2880, SamplesPerSec=97171.87527218687
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.16069931 ms
avg iteration GPU training time:15.91801597 ms
avg iteration (step) total cpu time:122.30844851 ms
Epoch Time(s): 5.5579
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.5007 | Train Acc 0.8737 | Speed (samples/sec) 133380.5768 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:44,929] [INFO] [logging.py:60:log_dist] [Rank 0] step=2890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:44,929] [INFO] [timer.py:160:stop] 0/2890, SamplesPerSec=97165.65955101662
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:46,209] [INFO] [logging.py:60:log_dist] [Rank 0] step=2900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:46,209] [INFO] [timer.py:160:stop] 0/2900, SamplesPerSec=97162.18196395293
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00090 | Step 00020 | Loss 0.5002 | Train Acc 0.8717 | Speed (samples/sec) 133421.5356 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:47,661] [INFO] [logging.py:60:log_dist] [Rank 0] step=2910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:47,661] [INFO] [timer.py:160:stop] 0/2910, SamplesPerSec=97117.0530485691
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.84484623 ms
avg iteration GPU training time:16.46650675 ms
avg iteration (step) total cpu time:122.35260893 ms
Epoch Time(s): 5.6070
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4755 | Train Acc 0.8677 | Speed (samples/sec) 133431.8663 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:50,134] [INFO] [logging.py:60:log_dist] [Rank 0] step=2920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:50,134] [INFO] [timer.py:160:stop] 0/2920, SamplesPerSec=97117.31555843692
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:51,469] [INFO] [logging.py:60:log_dist] [Rank 0] step=2930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:51,469] [INFO] [timer.py:160:stop] 0/2930, SamplesPerSec=97133.02436102105
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00091 | Step 00020 | Loss 0.5155 | Train Acc 0.8628 | Speed (samples/sec) 133509.8623 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:52,813] [INFO] [logging.py:60:log_dist] [Rank 0] step=2940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:52,813] [INFO] [timer.py:160:stop] 0/2940, SamplesPerSec=97146.7901144716
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.09238522 ms
avg iteration GPU training time:15.01325759 ms
avg iteration (step) total cpu time:113.48673149 ms
Epoch Time(s): 5.3559
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4568 | Train Acc 0.8767 | Speed (samples/sec) 133502.2964 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:55,420] [INFO] [logging.py:60:log_dist] [Rank 0] step=2950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:55,420] [INFO] [timer.py:160:stop] 0/2950, SamplesPerSec=97148.52968585347
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:56,479] [INFO] [logging.py:60:log_dist] [Rank 0] step=2960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:56,479] [INFO] [timer.py:160:stop] 0/2960, SamplesPerSec=97140.08514299137
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00092 | Step 00020 | Loss 0.4938 | Train Acc 0.8706 | Speed (samples/sec) 133477.4866 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:40:58,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=2970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:40:58,130] [INFO] [timer.py:160:stop] 0/2970, SamplesPerSec=97119.5279829772
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.44899442 ms
avg iteration GPU training time:16.18091272 ms
avg iteration (step) total cpu time:121.58873346 ms
Epoch Time(s): 5.5741
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4436 | Train Acc 0.8785 | Speed (samples/sec) 133435.3914 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:00,522] [INFO] [logging.py:60:log_dist] [Rank 0] step=2980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:00,522] [INFO] [timer.py:160:stop] 0/2980, SamplesPerSec=97128.90193703874
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:02,077] [INFO] [logging.py:60:log_dist] [Rank 0] step=2990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:02,077] [INFO] [timer.py:160:stop] 0/2990, SamplesPerSec=97140.77839427869
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00093 | Step 00020 | Loss 0.4640 | Train Acc 0.8746 | Speed (samples/sec) 133457.1341 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:03,133] [INFO] [logging.py:60:log_dist] [Rank 0] step=3000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:03,133] [INFO] [timer.py:160:stop] 0/3000, SamplesPerSec=97150.55188034559
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.98216532 ms
avg iteration GPU training time:15.11564329 ms
avg iteration (step) total cpu time:113.01341763 ms
Epoch Time(s): 5.3190
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4794 | Train Acc 0.8709 | Speed (samples/sec) 133502.0175 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:05,792] [INFO] [logging.py:60:log_dist] [Rank 0] step=3010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:05,792] [INFO] [timer.py:160:stop] 0/3010, SamplesPerSec=97165.52821431364
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:06,829] [INFO] [logging.py:60:log_dist] [Rank 0] step=3020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:06,829] [INFO] [timer.py:160:stop] 0/3020, SamplesPerSec=97175.77204016803
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00094 | Step 00020 | Loss 0.4759 | Train Acc 0.8745 | Speed (samples/sec) 133509.4103 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:08,191] [INFO] [logging.py:60:log_dist] [Rank 0] step=3030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:08,191] [INFO] [timer.py:160:stop] 0/3030, SamplesPerSec=97174.11573154716
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:09,527] [INFO] [logging.py:60:log_dist] [Rank 0] step=3040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:09,527] [INFO] [timer.py:160:stop] 0/3040, SamplesPerSec=97186.74926401292
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.15331316 ms
avg iteration GPU training time:15.46062466 ms
avg iteration (step) total cpu time:121.05049910 ms
Epoch Time(s): 5.5337
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4780 | Train Acc 0.8743 | Speed (samples/sec) 133523.7904 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:12,352] [INFO] [logging.py:60:log_dist] [Rank 0] step=3050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:12,352] [INFO] [timer.py:160:stop] 0/3050, SamplesPerSec=97187.26466161196
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:13,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=3060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:13,468] [INFO] [timer.py:160:stop] 0/3060, SamplesPerSec=97191.21639053433
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00095 | Step 00020 | Loss 0.4635 | Train Acc 0.8725 | Speed (samples/sec) 133559.7072 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:15,061] [INFO] [logging.py:60:log_dist] [Rank 0] step=3070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:15,061] [INFO] [timer.py:160:stop] 0/3070, SamplesPerSec=97192.29530876288
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73486328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70166015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.23266955 ms
avg iteration GPU training time:15.51883966 ms
avg iteration (step) total cpu time:122.46015337 ms
Epoch Time(s): 5.5815
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.4705 | Train Acc 0.8749 | Speed (samples/sec) 133556.5693 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:17,517] [INFO] [logging.py:60:log_dist] [Rank 0] step=3080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:17,517] [INFO] [timer.py:160:stop] 0/3080, SamplesPerSec=97179.6669888826
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:18,897] [INFO] [logging.py:60:log_dist] [Rank 0] step=3090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:18,897] [INFO] [timer.py:160:stop] 0/3090, SamplesPerSec=97153.48296297474
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00096 | Step 00020 | Loss 0.4804 | Train Acc 0.8695 | Speed (samples/sec) 133554.4532 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:19,906] [INFO] [logging.py:60:log_dist] [Rank 0] step=3100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:19,906] [INFO] [timer.py:160:stop] 0/3100, SamplesPerSec=97165.64637057652
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74853515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.20711708 ms
avg iteration GPU training time:15.92310531 ms
avg iteration (step) total cpu time:109.68176524 ms
Epoch Time(s): 5.2716
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.4574 | Train Acc 0.8793 | Speed (samples/sec) 133582.9375 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:22,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=3110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:22,706] [INFO] [timer.py:160:stop] 0/3110, SamplesPerSec=97177.3133934815
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:23,725] [INFO] [logging.py:60:log_dist] [Rank 0] step=3120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:23,725] [INFO] [timer.py:160:stop] 0/3120, SamplesPerSec=97189.38649772645
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00097 | Step 00020 | Loss 0.4808 | Train Acc 0.8761 | Speed (samples/sec) 133613.0641 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:25,232] [INFO] [logging.py:60:log_dist] [Rank 0] step=3130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:25,232] [INFO] [timer.py:160:stop] 0/3130, SamplesPerSec=97201.86211621528
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74658203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70556640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:9.95609829 ms
avg iteration GPU training time:15.24489353 ms
avg iteration (step) total cpu time:118.14274611 ms
Epoch Time(s): 5.4532
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72509765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.4837 | Train Acc 0.8644 | Speed (samples/sec) 133654.8473 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:27,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=3140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:27,705] [INFO] [timer.py:160:stop] 0/3140, SamplesPerSec=97212.12408295108
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:29,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=3150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:29,222] [INFO] [timer.py:160:stop] 0/3150, SamplesPerSec=97218.54809701456
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00098 | Step 00020 | Loss 0.4731 | Train Acc 0.8767 | Speed (samples/sec) 133676.2933 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:30,433] [INFO] [logging.py:60:log_dist] [Rank 0] step=3160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:30,434] [INFO] [timer.py:160:stop] 0/3160, SamplesPerSec=97220.71146888181
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.65123076 ms
avg iteration GPU training time:16.29158165 ms
avg iteration (step) total cpu time:124.08864057 ms
Epoch Time(s): 5.6199
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.4714 | Train Acc 0.8721 | Speed (samples/sec) 133686.9865 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:33,261] [INFO] [logging.py:60:log_dist] [Rank 0] step=3170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:33,261] [INFO] [timer.py:160:stop] 0/3170, SamplesPerSec=97173.62665682936
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:34,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=3180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:34,341] [INFO] [timer.py:160:stop] 0/3180, SamplesPerSec=97181.15185090502
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70947265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71728515625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00099 | Step 00020 | Loss 0.4656 | Train Acc 0.8709 | Speed (samples/sec) 133700.1208 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:35,663] [INFO] [logging.py:60:log_dist] [Rank 0] step=3190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:35,663] [INFO] [timer.py:160:stop] 0/3190, SamplesPerSec=97181.08907207054
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73291015625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:36,714] [INFO] [logging.py:60:log_dist] [Rank 0] step=3200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:36,714] [INFO] [timer.py:160:stop] 0/3200, SamplesPerSec=97187.20377457439
-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:10.44388617 ms
avg iteration GPU training time:15.65540271 ms
avg iteration (step) total cpu time:110.42795358 ms
Epoch Time(s): 5.2721
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.72314453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.4666 | Train Acc 0.8730 | Speed (samples/sec) 133670.4400 | GPU 1634.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75830078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:39,531] [INFO] [logging.py:60:log_dist] [Rank 0] step=3210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:39,531] [INFO] [timer.py:160:stop] 0/3210, SamplesPerSec=97186.87307775288
-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:40,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=3220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:40,837] [INFO] [timer.py:160:stop] 0/3220, SamplesPerSec=97185.05111433867
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

Epoch 00100 | Step 00020 | Loss 0.4669 | Train Acc 0.8738 | Speed (samples/sec) 133531.1966 | GPU 1634.2 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75244140625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72705078125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73876953125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75634765625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71533203125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.73095703125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74267578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

[2021-06-11 22:41:42,392] [INFO] [logging.py:60:log_dist] [Rank 0] step=3230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:41:42,392] [INFO] [timer.py:160:stop] 0/3230, SamplesPerSec=97182.7201208363
-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.74072265625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.75439453125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.71337890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.72900390625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.73681640625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.74462890625GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.70361328125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.71142578125GB

Max Memory Allocated 1.5958776473999023  GigaBytes

avg iteration(step) data from cpu to GPU time:11.07866077 ms
avg iteration GPU training time:15.74022049 ms
avg iteration (step) total cpu time:129.38499451 ms
Epoch Time(s): 5.7492
Eval Acc 0.8771
Test Acc: 0.7047
Avg epoch time(time.time()): 5511.7660363515215 ms
total avg iteration(step) data from cpu to GPU time:10.24406217 ms
total avg iteration GPU training time:15.71081962 ms
total avg iteration (step) total cpu time:118.98684161 ms
