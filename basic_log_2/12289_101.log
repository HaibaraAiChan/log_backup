[2021-06-11 22:21:01,162] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-11 22:21:04,831] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-11 22:21:05,802] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-11 22:21:05,802] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-11 22:21:05,803] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-11 22:21:05,803] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-11 22:21:05,803] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623450071.37969
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20394.9921875, 'VmHWM': 1164.609375, 'VmRSS': 1164.609375}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6753
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2827
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0851
-------------------------------------------------end of load ogb****************** step Time(s): 0.0628
finish constructing ogbn-products
load ogb-products time total: 2.1075870990753174
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.1085
after inductive else step Time(s): 0.0000
after label step Time(s): 3.4442
after train_g.create_formats_() step Time(s): 1.4422
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-11 22:21:18,403] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-11 22:21:18,403] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-11 22:21:18,407] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-11 22:21:20,748] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-11 22:21:20,750] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-11 22:21:20,750] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-11 22:21:20,750] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-11 22:21:20,750] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-11 22:21:20,750] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fd3a4c65940>
[2021-06-11 22:21:20,750] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:20,750] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-11 22:21:20,750] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-11 22:21:20,751] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-11 22:21:20,753] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68603515625GB

Max Memory Allocated 1.2872257232666016  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.74072265625GB

Max Memory Allocated 1.2872257232666016  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3841729164123535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3841729164123535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4100232124328613  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4100232124328613  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6255 | Train Acc 0.0199 | Speed (samples/sec) nan | GPU 1443.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4100232124328613  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6391119956970215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6391119956970215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6391119956970215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6391119956970215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6391119956970215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6391119956970215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6391119956970215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6391730308532715  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6391730308532715  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6391730308532715  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.6391730308532715  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6391730308532715  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6391730308532715  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6391730308532715  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6402769088745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6402769088745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6402769088745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6402769088745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6402769088745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6402769088745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6402769088745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

[2021-06-11 22:21:24,828] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-11 22:21:24,828] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=72262.53138859257
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

avg iteration(step) data from cpu to GPU time:15.75931055 ms
avg iteration GPU training time:20.54516359 ms
avg iteration (step) total cpu time:218.00771627 ms
Epoch Time(s): 5.5409
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.1292 | Train Acc 0.7192 | Speed (samples/sec) 144699.9681 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

[2021-06-11 22:21:28,439] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:28,440] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=72518.09042748364
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

[2021-06-11 22:21:30,911] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:30,911] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=72427.4979895043
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06145746 ms
avg iteration GPU training time:20.80470102 ms
avg iteration (step) total cpu time:171.43271186 ms
Epoch Time(s): 4.9834
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.7155 | Train Acc 0.8221 | Speed (samples/sec) 165702.1245 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

[2021-06-11 22:21:34,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:34,296] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=72166.0370478479
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

avg iteration(step) data from cpu to GPU time:15.45926701 ms
avg iteration GPU training time:20.66711564 ms
avg iteration (step) total cpu time:157.88425099 ms
Epoch Time(s): 4.8883
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.6059 | Train Acc 0.8468 | Speed (samples/sec) 179238.4794 | GPU 1681.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

[2021-06-11 22:21:38,195] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:38,195] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=72837.76460651094
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419458389282227  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:39,969] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:39,970] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=72726.60828678608
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

avg iteration(step) data from cpu to GPU time:16.10877687 ms
avg iteration GPU training time:31.79491771 ms
avg iteration (step) total cpu time:197.77367332 ms
Epoch Time(s): 5.2288
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5658 | Train Acc 0.8555 | Speed (samples/sec) 177110.4175 | GPU 1681.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:44,404] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:44,404] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=71595.50437695517
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:46,171] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:46,172] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=70856.61447527457
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

avg iteration(step) data from cpu to GPU time:17.48287704 ms
avg iteration GPU training time:23.02710967 ms
avg iteration (step) total cpu time:165.63760151 ms
Epoch Time(s): 5.0901
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.5627 | Train Acc 0.8526 | Speed (samples/sec) 180281.1824 | GPU 1681.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:50,160] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:50,160] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=71128.03783847117
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

avg iteration(step) data from cpu to GPU time:14.95096718 ms
avg iteration GPU training time:20.67658476 ms
avg iteration (step) total cpu time:173.60236428 ms
Epoch Time(s): 4.9636
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.5555 | Train Acc 0.8554 | Speed (samples/sec) 178954.9272 | GPU 1681.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:53,549] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:53,550] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=71394.39254933702
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:56,304] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:56,304] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=71578.71246284524
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

avg iteration(step) data from cpu to GPU time:16.07632594 ms
avg iteration GPU training time:21.02468057 ms
avg iteration (step) total cpu time:193.67100976 ms
Epoch Time(s): 5.2325
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.5382 | Train Acc 0.8573 | Speed (samples/sec) 178919.1106 | GPU 1681.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

[2021-06-11 22:21:59,637] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:21:59,638] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=71614.53667661667
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.642068862915039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.23185158 ms
avg iteration GPU training time:20.96518395 ms
avg iteration (step) total cpu time:164.89304196 ms
Epoch Time(s): 4.8485
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.5138 | Train Acc 0.8642 | Speed (samples/sec) 179711.1436 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:03,532] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:03,532] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=71566.59195172363
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:05,290] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:05,291] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=71625.88134957991
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.99962182 ms
avg iteration GPU training time:21.50207710 ms
avg iteration (step) total cpu time:173.98929596 ms
Epoch Time(s): 4.9826
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.4904 | Train Acc 0.8739 | Speed (samples/sec) 180554.2391 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:10,968] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:10,969] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=71448.32363729084
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:13,273] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:13,273] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=71407.57853432477
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.40962046 ms
avg iteration GPU training time:21.87035040 ms
avg iteration (step) total cpu time:339.96074850 ms
Epoch Time(s): 7.0691
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.5095 | Train Acc 0.8656 | Speed (samples/sec) 179614.6442 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:17,735] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:17,735] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=71214.68686015386
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.20999856 ms
avg iteration GPU training time:20.92194904 ms
avg iteration (step) total cpu time:214.48781274 ms
Epoch Time(s): 5.7551
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.5023 | Train Acc 0.8658 | Speed (samples/sec) 176016.8784 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:21,386] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:21,386] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=71267.53103144918
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:24,252] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:24,252] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=71447.060606553
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.49508364 ms
avg iteration GPU training time:20.39769589 ms
avg iteration (step) total cpu time:205.30522953 ms
Epoch Time(s): 5.2725
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.4878 | Train Acc 0.8689 | Speed (samples/sec) 178167.0435 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:27,413] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:27,413] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=71494.42135445014
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:17.27323333 ms
avg iteration GPU training time:20.63710282 ms
avg iteration (step) total cpu time:205.90056073 ms
Epoch Time(s): 5.1750
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.4706 | Train Acc 0.8727 | Speed (samples/sec) 178792.7271 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:31,832] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:31,832] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=71478.94756160869
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:33,645] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:33,645] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=71617.78668904207
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:17.32355499 ms
avg iteration GPU training time:20.41507201 ms
avg iteration (step) total cpu time:169.36330362 ms
Epoch Time(s): 4.9760
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.4944 | Train Acc 0.8674 | Speed (samples/sec) 178650.3718 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:37,625] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:37,625] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=71659.84229311181
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:39,604] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:39,605] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=71714.93123014642
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.36401454 ms
avg iteration GPU training time:21.14866309 ms
avg iteration (step) total cpu time:184.35380676 ms
Epoch Time(s): 5.1368
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.4913 | Train Acc 0.8688 | Speed (samples/sec) 180684.8692 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:43,594] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:43,594] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=71717.12580493717
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.19056312 ms
avg iteration GPU training time:21.09483962 ms
avg iteration (step) total cpu time:197.86808707 ms
Epoch Time(s): 5.2375
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.4848 | Train Acc 0.8713 | Speed (samples/sec) 180183.3699 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:47,384] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:47,384] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=71440.90144293667
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:49,760] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:49,761] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=71189.9808888928
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.23136000 ms
avg iteration GPU training time:23.03602895 ms
avg iteration (step) total cpu time:161.27393462 ms
Epoch Time(s): 4.9896
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.4953 | Train Acc 0.8672 | Speed (samples/sec) 181167.3096 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:53,083] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:53,084] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=71255.01891612669
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89697265625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86376953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.57118260 ms
avg iteration GPU training time:21.16829959 ms
avg iteration (step) total cpu time:164.65646570 ms
Epoch Time(s): 4.9056
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.4844 | Train Acc 0.8677 | Speed (samples/sec) 182267.8511 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:57,033] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:57,033] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=71239.21332604771
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:22:58,824] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:22:58,825] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=71297.1067889148
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:17.33707922 ms
avg iteration GPU training time:21.06706342 ms
avg iteration (step) total cpu time:190.40879336 ms
Epoch Time(s): 5.1870
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.4719 | Train Acc 0.8708 | Speed (samples/sec) 182171.4694 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:03,096] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:03,096] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=71259.9046003434
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:04,982] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:04,982] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=71111.21676210147
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.17906917 ms
avg iteration GPU training time:22.88324356 ms
avg iteration (step) total cpu time:177.38199234 ms
Epoch Time(s): 5.0246
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.4687 | Train Acc 0.8742 | Speed (samples/sec) 182456.1302 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:08,929] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:08,929] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=71174.4038110565
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.75922324 ms
avg iteration GPU training time:20.27584267 ms
avg iteration (step) total cpu time:201.81534507 ms
Epoch Time(s): 5.2718
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.4983 | Train Acc 0.8681 | Speed (samples/sec) 183553.1266 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:13,457] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:13,457] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=71240.09718882786
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:16,816] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:16,816] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=71247.07771440443
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.54235623 ms
avg iteration GPU training time:21.15109842 ms
avg iteration (step) total cpu time:301.67560144 ms
Epoch Time(s): 6.6599
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.5000 | Train Acc 0.8677 | Speed (samples/sec) 182719.3048 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:21,022] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:21,022] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=71264.22946389545
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:18.71354493 ms
avg iteration GPU training time:21.07289592 ms
avg iteration (step) total cpu time:239.39945481 ms
Epoch Time(s): 5.9659
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.4923 | Train Acc 0.8658 | Speed (samples/sec) 179893.3333 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:25,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:25,341] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=71299.00088339402
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:27,279] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:27,279] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=71363.4721477489
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31831863 ms
avg iteration GPU training time:20.58121282 ms
avg iteration (step) total cpu time:230.63848235 ms
Epoch Time(s): 5.5987
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.4868 | Train Acc 0.8674 | Speed (samples/sec) 178396.7226 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:31,486] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:31,486] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=71372.26960131276
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:33,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:33,557] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=71287.314155087
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.58887863 ms
avg iteration GPU training time:22.66696444 ms
avg iteration (step) total cpu time:192.81903180 ms
Epoch Time(s): 5.0846
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.4668 | Train Acc 0.8700 | Speed (samples/sec) 178878.4366 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:37,619] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:37,619] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=70961.16671473131
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.20463415 ms
avg iteration GPU training time:24.06899192 ms
avg iteration (step) total cpu time:163.56186433 ms
Epoch Time(s): 4.9497
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.4848 | Train Acc 0.8677 | Speed (samples/sec) 179352.2633 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:40,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:40,894] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=70905.71174372714
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:43,656] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:43,657] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=70937.92618680288
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.31937747 ms
avg iteration GPU training time:20.81177035 ms
avg iteration (step) total cpu time:195.05921277 ms
Epoch Time(s): 5.2238
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.4874 | Train Acc 0.8688 | Speed (samples/sec) 180304.1968 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:46,957] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:46,957] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=70975.6027378144
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.67095852 ms
avg iteration GPU training time:20.36286267 ms
avg iteration (step) total cpu time:195.26785070 ms
Epoch Time(s): 5.2804
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.4840 | Train Acc 0.8697 | Speed (samples/sec) 181058.5001 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:51,339] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:51,339] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=71044.82154129609
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:53,238] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:53,239] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=70938.59309232944
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.82429929 ms
avg iteration GPU training time:24.40297890 ms
avg iteration (step) total cpu time:164.45515373 ms
Epoch Time(s): 5.0340
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.4787 | Train Acc 0.8697 | Speed (samples/sec) 181344.9058 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:57,154] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:57,154] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=70823.5567253747
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:23:58,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:23:58,917] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=70887.7267697488
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.28411917 ms
avg iteration GPU training time:20.61521201 ms
avg iteration (step) total cpu time:164.53324665 ms
Epoch Time(s): 4.8693
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.4842 | Train Acc 0.8669 | Speed (samples/sec) 181645.4710 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:02,835] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:02,836] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=70919.15077760012
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:17.11764639 ms
avg iteration GPU training time:21.14035173 ms
avg iteration (step) total cpu time:182.42337487 ms
Epoch Time(s): 5.0566
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.4722 | Train Acc 0.8735 | Speed (samples/sec) 181316.7754 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:06,396] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:06,397] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=70944.06802707071
-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89501953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.94189453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:09,013] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:09,014] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=70980.85353860601
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:14.93767288 ms
avg iteration GPU training time:20.89207250 ms
avg iteration (step) total cpu time:173.78096147 ms
Epoch Time(s): 5.1410
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.4729 | Train Acc 0.8737 | Speed (samples/sec) 181949.8022 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:12,338] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:12,338] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=71015.26899201711
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.08510234 ms
avg iteration GPU training time:21.27169158 ms
avg iteration (step) total cpu time:162.42387078 ms
Epoch Time(s): 4.8482
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.4720 | Train Acc 0.8687 | Speed (samples/sec) 182187.0358 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:16,184] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:16,184] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=71008.91307129967
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:18,010] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:18,011] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=71021.36052184786
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:18.41066482 ms
avg iteration GPU training time:20.99850464 ms
avg iteration (step) total cpu time:185.77538837 ms
Epoch Time(s): 5.0798
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.4599 | Train Acc 0.8766 | Speed (samples/sec) 182256.2608 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:22,193] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:22,194] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=70852.86014765645
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:23,921] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:23,922] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=70684.8534688101
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.88688304 ms
avg iteration GPU training time:24.52095691 ms
avg iteration (step) total cpu time:168.53466901 ms
Epoch Time(s): 4.8663
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4908 | Train Acc 0.8664 | Speed (samples/sec) 181835.8922 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:27,850] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:27,850] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=70708.69337455298
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.80577443 ms
avg iteration GPU training time:20.54837504 ms
avg iteration (step) total cpu time:166.03959690 ms
Epoch Time(s): 4.9447
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4741 | Train Acc 0.8692 | Speed (samples/sec) 182433.4214 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:31,209] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:31,210] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=70749.04896339243
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:33,867] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:33,867] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=70811.14151994835
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:16.22952158 ms
avg iteration GPU training time:20.77124942 ms
avg iteration (step) total cpu time:190.50732526 ms
Epoch Time(s): 5.2090
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4842 | Train Acc 0.8693 | Speed (samples/sec) 182309.5813 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:37,385] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:37,385] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=70823.88084842262
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:17.79812397 ms
avg iteration GPU training time:20.38077979 ms
avg iteration (step) total cpu time:164.12386027 ms
Epoch Time(s): 4.9818
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4649 | Train Acc 0.8706 | Speed (samples/sec) 182698.1724 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:41,281] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:41,281] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=70862.40060483788
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:43,015] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:43,016] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=70884.57888601608
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.26429098 ms
avg iteration GPU training time:20.78239424 ms
avg iteration (step) total cpu time:162.58935495 ms
Epoch Time(s): 4.8488
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.4807 | Train Acc 0.8670 | Speed (samples/sec) 183231.8895 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:46,958] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:46,959] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=70911.66859214731
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

[2021-06-11 22:24:48,943] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:48,944] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=70920.09352242536
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63592451 ms
avg iteration GPU training time:21.27600861 ms
avg iteration (step) total cpu time:184.78170308 ms
Epoch Time(s): 5.0633
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4720 | Train Acc 0.8736 | Speed (samples/sec) 183107.4762 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438846588134766  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:24:53,080] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:53,081] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=70906.17011646794
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:17.94207131 ms
avg iteration GPU training time:21.42110564 ms
avg iteration (step) total cpu time:166.67454893 ms
Epoch Time(s): 5.0178
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4737 | Train Acc 0.8715 | Speed (samples/sec) 183195.0234 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:24:56,357] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:56,358] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=70902.66185089607
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:24:58,751] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:24:58,751] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=70935.60334864842
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:15.83958955 ms
avg iteration GPU training time:20.72632703 ms
avg iteration (step) total cpu time:170.54130814 ms
Epoch Time(s): 5.0061
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4626 | Train Acc 0.8761 | Speed (samples/sec) 183188.0525 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:02,170] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:02,170] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=70947.16093660142
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:16.66410186 ms
avg iteration GPU training time:20.77201739 ms
avg iteration (step) total cpu time:182.15768987 ms
Epoch Time(s): 5.0818
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4706 | Train Acc 0.8717 | Speed (samples/sec) 183318.4715 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:06,396] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:06,396] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=70979.00584861777
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:08,263] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:08,264] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=70983.9435109939
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:16.91085651 ms
avg iteration GPU training time:21.78569603 ms
avg iteration (step) total cpu time:163.84976560 ms
Epoch Time(s): 4.9835
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4554 | Train Acc 0.8738 | Speed (samples/sec) 183557.2658 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:12,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:12,199] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=70947.71979023937
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:14,157] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:14,157] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=70996.99540200052
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:15.45049312 ms
avg iteration GPU training time:20.46544266 ms
avg iteration (step) total cpu time:182.96566876 ms
Epoch Time(s): 5.1487
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4796 | Train Acc 0.8705 | Speed (samples/sec) 183615.5774 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:18,209] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:18,210] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=71006.8068512303
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84700238 ms
avg iteration GPU training time:21.16445940 ms
avg iteration (step) total cpu time:191.92225283 ms
Epoch Time(s): 5.1400
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4550 | Train Acc 0.8757 | Speed (samples/sec) 183500.7604 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:21,691] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:21,692] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=71013.99586548813
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:24,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:24,449] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=71055.77547505435
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:17.79031268 ms
avg iteration GPU training time:20.54988220 ms
avg iteration (step) total cpu time:192.45847789 ms
Epoch Time(s): 5.2510
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4830 | Train Acc 0.8720 | Speed (samples/sec) 183560.2012 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:27,854] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:27,854] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=71030.74889770994
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:17.21971191 ms
avg iteration GPU training time:21.34154164 ms
avg iteration (step) total cpu time:173.20277474 ms
Epoch Time(s): 4.9994
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4806 | Train Acc 0.8707 | Speed (samples/sec) 183302.3837 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:31,829] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:31,829] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=71035.4908547711
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:33,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:33,932] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=71036.04222851044
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:17.75397240 ms
avg iteration GPU training time:21.55011454 ms
avg iteration (step) total cpu time:204.50076190 ms
Epoch Time(s): 5.3057
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4644 | Train Acc 0.8749 | Speed (samples/sec) 182294.1256 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:37,974] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:37,974] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=71039.55391846973
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:39,725] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:39,725] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=71079.0668066073
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:15.97947918 ms
avg iteration GPU training time:20.54065167 ms
avg iteration (step) total cpu time:164.03560205 ms
Epoch Time(s): 4.8708
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4738 | Train Acc 0.8712 | Speed (samples/sec) 182420.9332 | GPU 1683.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

[2021-06-11 22:25:43,904] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:25:43,904] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=71103.19560097852
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6438865661621094  GigaBytes

avg iteration(step) data from cpu to GPU time:15.29078388 ms
avg iteration GPU training time:20.37799298 ms
avg iteration (step) total cpu time:201.12423463 ms
Epoch Time(s): 5.2758
Eval Acc 0.8814
Test Acc: 0.6988
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4614 | Train Acc 0.8749 | Speed (samples/sec) 182865.9200 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:21,432] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:21,433] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=71118.20785705547
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:24,228] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:24,228] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=71061.22187570504
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:14.96469229 ms
avg iteration GPU training time:22.67937452 ms
avg iteration (step) total cpu time:193.49566373 ms
Epoch Time(s): 5.3060
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.4768 | Train Acc 0.8726 | Speed (samples/sec) 183094.3744 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:27,588] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:27,589] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=71001.63906390434
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.05512151 ms
avg iteration GPU training time:21.24849770 ms
avg iteration (step) total cpu time:172.76449637 ms
Epoch Time(s): 4.9717
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4631 | Train Acc 0.8757 | Speed (samples/sec) 183160.3757 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:31,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:31,597] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=71009.7804851189
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:33,376] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:33,377] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=71037.17495596127
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.91200291 ms
avg iteration GPU training time:20.79584000 ms
avg iteration (step) total cpu time:188.63966248 ms
Epoch Time(s): 5.1875
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4656 | Train Acc 0.8740 | Speed (samples/sec) 183356.6355 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:38,053] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:38,053] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=71044.23810721977
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:40,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:40,122] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=71083.22753439145
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.43001895 ms
avg iteration GPU training time:20.56601022 ms
avg iteration (step) total cpu time:192.51218709 ms
Epoch Time(s): 5.6185
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4559 | Train Acc 0.8814 | Speed (samples/sec) 183489.3825 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:44,337] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:44,337] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=71094.45682506161
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.16938487 ms
avg iteration GPU training time:20.57011466 ms
avg iteration (step) total cpu time:206.87790350 ms
Epoch Time(s): 5.5017
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4724 | Train Acc 0.8705 | Speed (samples/sec) 183782.1000 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:47,982] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:47,982] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=71094.56351400759
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:50,770] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:50,771] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=71102.66542670851
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:18.79631424 ms
avg iteration GPU training time:21.04638221 ms
avg iteration (step) total cpu time:204.13862575 ms
Epoch Time(s): 5.3059
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4789 | Train Acc 0.8688 | Speed (samples/sec) 183364.8373 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:54,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:54,208] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=71018.3266433754
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.93285517 ms
avg iteration GPU training time:23.90788651 ms
avg iteration (step) total cpu time:183.65905502 ms
Epoch Time(s): 5.1253
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.4670 | Train Acc 0.8777 | Speed (samples/sec) 183314.8138 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:26:58,279] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:26:58,279] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=70997.7847998057
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:00,175] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:00,175] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=71017.08724783272
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.45973552 ms
avg iteration GPU training time:21.01856578 ms
avg iteration (step) total cpu time:171.76402699 ms
Epoch Time(s): 4.9062
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4669 | Train Acc 0.8722 | Speed (samples/sec) 183402.6332 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:04,127] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:04,127] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=71026.15525566788
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:06,298] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:06,299] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=71064.86806211068
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.32632126 ms
avg iteration GPU training time:20.40558850 ms
avg iteration (step) total cpu time:209.34254473 ms
Epoch Time(s): 5.3697
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4642 | Train Acc 0.8772 | Speed (samples/sec) 183068.2919 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:10,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:10,267] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=71054.62313673711
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.69329756 ms
avg iteration GPU training time:21.41580495 ms
avg iteration (step) total cpu time:169.10687360 ms
Epoch Time(s): 4.9036
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4537 | Train Acc 0.8770 | Speed (samples/sec) 182577.0408 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:13,609] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:13,609] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=71071.20693813579
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:16,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:16,382] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=71094.42149027597
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06475362 ms
avg iteration GPU training time:20.71085358 ms
avg iteration (step) total cpu time:201.07004859 ms
Epoch Time(s): 5.2584
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4919 | Train Acc 0.8662 | Speed (samples/sec) 182531.3911 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:20,919] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:20,919] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=71088.98316209984
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.81876365 ms
avg iteration GPU training time:21.41160115 ms
avg iteration (step) total cpu time:250.58917566 ms
Epoch Time(s): 6.2581
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4643 | Train Acc 0.8779 | Speed (samples/sec) 182023.5458 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:25,087] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:25,087] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=71092.96172254575
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:27,027] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:27,027] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=71112.65059608885
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:18.01048730 ms
avg iteration GPU training time:20.74356374 ms
avg iteration (step) total cpu time:216.33107012 ms
Epoch Time(s): 5.4897
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.4587 | Train Acc 0.8761 | Speed (samples/sec) 181499.1781 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:31,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:31,285] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=71127.7935685777
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:33,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:33,341] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=71143.02536973933
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.67255852 ms
avg iteration GPU training time:20.95200556 ms
avg iteration (step) total cpu time:192.52933155 ms
Epoch Time(s): 5.0864
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.4701 | Train Acc 0.8722 | Speed (samples/sec) 181515.6508 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:39,238] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:39,238] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=71126.8889192977
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.00985007 ms
avg iteration GPU training time:22.48220496 ms
avg iteration (step) total cpu time:355.49020767 ms
Epoch Time(s): 7.3510
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.4673 | Train Acc 0.8758 | Speed (samples/sec) 180518.9099 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:43,330] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:43,331] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=71084.07161738208
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:45,959] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:45,959] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=71090.0397059551
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.08907041 ms
avg iteration GPU training time:21.08250739 ms
avg iteration (step) total cpu time:184.65230682 ms
Epoch Time(s): 5.3675
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.4553 | Train Acc 0.8766 | Speed (samples/sec) 179968.6497 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:49,442] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:49,442] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=71096.98020610357
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.56903839 ms
avg iteration GPU training time:21.67957514 ms
avg iteration (step) total cpu time:209.53215252 ms
Epoch Time(s): 5.5451
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.4723 | Train Acc 0.8770 | Speed (samples/sec) 180033.3814 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:53,769] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:53,770] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=71069.48856038477
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:27:55,918] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:27:55,918] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=71079.2934292845
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.00228353 ms
avg iteration GPU training time:21.66178062 ms
avg iteration (step) total cpu time:216.39826081 ms
Epoch Time(s): 5.3287
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.4632 | Train Acc 0.8774 | Speed (samples/sec) 179897.1119 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:00,114] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:00,115] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=71021.66367929973
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:02,006] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:02,006] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=71021.99087934317
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:14.64153316 ms
avg iteration GPU training time:22.65988662 ms
avg iteration (step) total cpu time:180.88739569 ms
Epoch Time(s): 5.0909
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.4775 | Train Acc 0.8713 | Speed (samples/sec) 179814.4266 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:06,098] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:06,099] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=71012.54479558679
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.90269947 ms
avg iteration GPU training time:20.59850779 ms
avg iteration (step) total cpu time:184.98370864 ms
Epoch Time(s): 5.1583
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.4868 | Train Acc 0.8678 | Speed (samples/sec) 179899.3281 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:10,853] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:10,853] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=71014.77831652368
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:14,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:14,130] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=71025.7948651946
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:18.11232593 ms
avg iteration GPU training time:21.13732962 ms
avg iteration (step) total cpu time:301.83659900 ms
Epoch Time(s): 7.0593
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.4704 | Train Acc 0.8748 | Speed (samples/sec) 179747.5870 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:17,663] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:17,664] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=71035.46294461624
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.74750527 ms
avg iteration GPU training time:20.75612779 ms
avg iteration (step) total cpu time:206.00537820 ms
Epoch Time(s): 5.5763
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.4625 | Train Acc 0.8756 | Speed (samples/sec) 179945.9693 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:22,074] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:22,074] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=71042.3779589504
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:23,936] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:23,936] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=71052.29585413216
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.89860682 ms
avg iteration GPU training time:21.13395188 ms
avg iteration (step) total cpu time:165.01004046 ms
Epoch Time(s): 4.9816
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.4719 | Train Acc 0.8728 | Speed (samples/sec) 180071.9045 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:27,845] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:27,845] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=71051.36872741896
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:30,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:30,035] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=71046.80570315542
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.30714772 ms
avg iteration GPU training time:21.84227787 ms
avg iteration (step) total cpu time:203.93375917 ms
Epoch Time(s): 5.2326
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.4561 | Train Acc 0.8725 | Speed (samples/sec) 179997.8721 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:34,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:34,155] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=71052.1803294603
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.11298917 ms
avg iteration GPU training time:21.57808581 ms
avg iteration (step) total cpu time:164.87336159 ms
Epoch Time(s): 5.0327
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.4673 | Train Acc 0.8696 | Speed (samples/sec) 180120.5656 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:37,416] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:37,416] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=71061.99312472074
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:40,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:40,093] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=71072.02206773017
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:14.85813531 ms
avg iteration GPU training time:21.04564962 ms
avg iteration (step) total cpu time:176.22605237 ms
Epoch Time(s): 5.1346
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.4669 | Train Acc 0.8730 | Speed (samples/sec) 180234.2832 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:43,956] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:43,956] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=71067.53171573779
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.83048448 ms
avg iteration GPU training time:21.71702992 ms
avg iteration (step) total cpu time:260.52301580 ms
Epoch Time(s): 5.9938
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.4665 | Train Acc 0.8725 | Speed (samples/sec) 179705.8250 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:48,571] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:48,572] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=71052.93081254335
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:50,509] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:50,509] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=70989.24588020467
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.60330174 ms
avg iteration GPU training time:22.25584880 ms
avg iteration (step) total cpu time:167.00933196 ms
Epoch Time(s): 5.1579
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.4602 | Train Acc 0.8761 | Speed (samples/sec) 179601.8752 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:54,570] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:54,571] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=70992.01146940178
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:28:57,050] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:28:57,050] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=70994.89634609969
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.93002753 ms
avg iteration GPU training time:21.35431845 ms
avg iteration (step) total cpu time:230.73534532 ms
Epoch Time(s): 5.7726
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.4476 | Train Acc 0.8775 | Speed (samples/sec) 179615.9643 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:01,285] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:01,286] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=70987.16781413289
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.58578942 ms
avg iteration GPU training time:21.42102415 ms
avg iteration (step) total cpu time:209.53473178 ms
Epoch Time(s): 5.4568
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.4583 | Train Acc 0.8740 | Speed (samples/sec) 179451.6182 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:05,101] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:05,101] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=70986.5814461313
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:07,626] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:07,627] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=71006.8937624764
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.98637936 ms
avg iteration GPU training time:20.64024110 ms
avg iteration (step) total cpu time:173.12312126 ms
Epoch Time(s): 5.1824
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.4670 | Train Acc 0.8765 | Speed (samples/sec) 179604.8829 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:11,026] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:11,027] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=71012.05370867079
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.19768160 ms
avg iteration GPU training time:20.96194025 ms
avg iteration (step) total cpu time:190.96541405 ms
Epoch Time(s): 5.2478
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.4750 | Train Acc 0.8690 | Speed (samples/sec) 179732.2693 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:15,258] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:15,258] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=71017.08597234207
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:17,451] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:17,451] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=71015.06659771425
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.45268354 ms
avg iteration GPU training time:20.99024304 ms
avg iteration (step) total cpu time:200.14316385 ms
Epoch Time(s): 5.3221
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.4678 | Train Acc 0.8744 | Speed (samples/sec) 179296.1627 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:21,586] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:21,586] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=71008.96458505123
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:23,293] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:23,293] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=71038.91505836492
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.66358402 ms
avg iteration GPU training time:20.33640445 ms
avg iteration (step) total cpu time:159.85653617 ms
Epoch Time(s): 4.9613
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.4615 | Train Acc 0.8761 | Speed (samples/sec) 179531.0115 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:27,324] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:27,324] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=71043.26728550806
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.91382399 ms
avg iteration GPU training time:21.06270235 ms
avg iteration (step) total cpu time:168.26404225 ms
Epoch Time(s): 5.0128
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4531 | Train Acc 0.8783 | Speed (samples/sec) 179696.4625 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:31,772] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:31,772] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=71031.56823176029
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:35,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:35,208] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=71039.65445432735
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.59749239 ms
avg iteration GPU training time:21.30519555 ms
avg iteration (step) total cpu time:315.38313085 ms
Epoch Time(s): 6.9966
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4536 | Train Acc 0.8740 | Speed (samples/sec) 179643.9559 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:38,925] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:38,925] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=71031.6499752549
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.68836932 ms
avg iteration GPU training time:21.39160139 ms
avg iteration (step) total cpu time:182.90521882 ms
Epoch Time(s): 5.4063
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4650 | Train Acc 0.8745 | Speed (samples/sec) 179177.9022 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:43,078] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:43,079] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=71025.65157680502
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:44,864] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:44,864] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=71028.72981848435
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.45482748 ms
avg iteration GPU training time:21.11890013 ms
avg iteration (step) total cpu time:193.31669807 ms
Epoch Time(s): 5.2946
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4853 | Train Acc 0.8687 | Speed (samples/sec) 179422.4609 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:49,385] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:49,385] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=71039.04426960366
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:51,418] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:51,419] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=71063.64736705585
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:17.57453676 ms
avg iteration GPU training time:20.52262393 ms
avg iteration (step) total cpu time:189.35053999 ms
Epoch Time(s): 5.4157
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4713 | Train Acc 0.8755 | Speed (samples/sec) 179552.3536 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:55,602] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:55,603] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=70993.11072056623
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.23449326 ms
avg iteration GPU training time:20.66275493 ms
avg iteration (step) total cpu time:178.74678698 ms
Epoch Time(s): 5.2675
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4764 | Train Acc 0.8694 | Speed (samples/sec) 179512.4057 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:29:59,067] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:29:59,067] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=71009.23648354218
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:01,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:01,884] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=71021.21625495268
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.30797984 ms
avg iteration GPU training time:20.81703550 ms
avg iteration (step) total cpu time:192.21290675 ms
Epoch Time(s): 5.2962
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4445 | Train Acc 0.8775 | Speed (samples/sec) 179647.0001 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:05,474] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:05,474] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=71031.94506131359
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.88167581 ms
avg iteration GPU training time:22.89203748 ms
avg iteration (step) total cpu time:175.33178763 ms
Epoch Time(s): 5.2725
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4510 | Train Acc 0.8744 | Speed (samples/sec) 179672.5085 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:09,668] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:09,668] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=70982.4861417826
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:11,459] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:11,460] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=70994.49515139051
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.04663563 ms
avg iteration GPU training time:20.64579201 ms
avg iteration (step) total cpu time:161.07862646 ms
Epoch Time(s): 4.9931
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4772 | Train Acc 0.8700 | Speed (samples/sec) 179865.0164 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:15,494] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:15,494] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=71011.80330612448
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:17,596] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:17,596] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=71025.86120294807
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.57231418 ms
avg iteration GPU training time:20.80558829 ms
avg iteration (step) total cpu time:195.37121599 ms
Epoch Time(s): 5.3442
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4626 | Train Acc 0.8709 | Speed (samples/sec) 180076.1166 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:21,804] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:21,804] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=70975.1255835553
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:18.88402904 ms
avg iteration GPU training time:21.56588520 ms
avg iteration (step) total cpu time:163.44295848 ms
Epoch Time(s): 5.0677
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.4637 | Train Acc 0.8729 | Speed (samples/sec) 180171.6243 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:25,126] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:25,126] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=70962.35188041929
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:27,524] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:27,525] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=70951.8354115825
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:15.10411930 ms
avg iteration GPU training time:21.75608722 ms
avg iteration (step) total cpu time:161.56541217 ms
Epoch Time(s): 4.9598
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.4598 | Train Acc 0.8764 | Speed (samples/sec) 180189.5577 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:30,977] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:30,977] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=70963.80904458526
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12375866 ms
avg iteration GPU training time:20.78158275 ms
avg iteration (step) total cpu time:186.22769009 ms
Epoch Time(s): 5.2694
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.4676 | Train Acc 0.8757 | Speed (samples/sec) 180359.0988 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:35,260] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:35,260] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=70972.7647044642
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:37,191] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:37,192] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=70981.73341277424
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:14.17632875 ms
avg iteration GPU training time:23.39726552 ms
avg iteration (step) total cpu time:178.95676873 ms
Epoch Time(s): 5.2056
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.4616 | Train Acc 0.8771 | Speed (samples/sec) 180438.1800 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:41,337] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:41,338] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=70933.6925606708
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:43,084] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:43,084] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=70939.4353528845
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.93444070 ms
avg iteration GPU training time:21.18736597 ms
avg iteration (step) total cpu time:163.54992173 ms
Epoch Time(s): 5.0212
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.4665 | Train Acc 0.8758 | Speed (samples/sec) 180571.0857 | GPU 2036.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

[2021-06-11 22:30:47,573] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-11 22:30:47,574] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=70934.13709256134
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9890875816345215  GigaBytes

avg iteration(step) data from cpu to GPU time:16.80557667 ms
avg iteration GPU training time:21.43765224 ms
avg iteration (step) total cpu time:194.15463101 ms
Epoch Time(s): 5.4375
Eval Acc 0.8805
Test Acc: 0.7031
Avg epoch time(time.time()): 5294.969402253628 ms
total avg iteration(step) data from cpu to GPU time:16.25652209 ms
total avg iteration GPU training time:21.39695429 ms
total avg iteration (step) total cpu time:193.12762098 ms
