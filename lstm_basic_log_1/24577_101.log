[2021-06-12 20:13:34,708] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 20:13:38,385] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 24577 --deepspeed_config ds_config.json
[2021-06-12 20:13:39,329] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 20:13:39,329] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 20:13:39,329] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 20:13:39,329] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 20:13:39,329] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623528824.8674576
before load_ogb step Time(s): 0.0021
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.16796875, 'VmSize': 20394.9921875, 'VmHWM': 1165.04296875, 'VmRSS': 1165.04296875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6409
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2835
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1105
-------------------------------------------------end of load ogb****************** step Time(s): 0.0019
finish constructing ogbn-products
load ogb-products time total: 2.038437843322754
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0394
after inductive else step Time(s): 0.0000
after label step Time(s): 3.7967
after train_g.create_formats_() step Time(s): 1.6949
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 20:13:52,428] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 20:13:52,431] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 20:13:52,434] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 20:13:54,803] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 20:13:54,805] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 20:13:54,805] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 20:13:54,805] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 20:13:54,805] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 20:13:54,805] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f5dcc70d908>
[2021-06-12 20:13:54,805] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:13:54,805] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 20:13:54,805] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 20:13:54,806] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 20:13:54,807] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 20:13:54,807] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 20:13:54,807] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 20:13:54,808] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.3910956382751465  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.85791015625GB

Max Memory Allocated 1.3910956382751465  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.14697265625GB

Max Memory Allocated 27.327099800109863  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.14697265625GB

Max Memory Allocated 27.327099800109863  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.17236328125GB

Max Memory Allocated 27.327099800109863  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.17236328125GB

Max Memory Allocated 27.327099800109863  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7999 | Train Acc 0.0317 | Speed (samples/sec) nan | GPU 27983.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.10986328125GB

Max Memory Allocated 27.327099800109863  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.10986328125GB

Max Memory Allocated 27.327099800109863  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.14892578125GB

Max Memory Allocated 27.327099800109863  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.85986328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.78173828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.78173828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.85986328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.77978515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.77978515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.85986328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83447265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.78173828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.78173828125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82080078125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.85986328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83251953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.77978515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.77978515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

avg iteration(step) data from cpu to GPU time:25.47557386 ms
avg iteration GPU training time:434.39390055 ms
avg iteration (step) total cpu time:478.11349233 ms
Epoch Time(s): 8.2606
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.7442 | Train Acc 0.5191 | Speed (samples/sec) 44175.5679 | GPU 28094.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

[2021-06-12 20:14:07,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 20:14:07,215] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=3432.4378144195584
-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32861328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32861328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

avg iteration(step) data from cpu to GPU time:24.29727999 ms
avg iteration GPU training time:431.37685140 ms
avg iteration (step) total cpu time:469.88916397 ms
Epoch Time(s): 7.2315
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.0206 | Train Acc 0.7336 | Speed (samples/sec) 45797.1269 | GPU 28094.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

[2021-06-12 20:14:15,338] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:14:15,448] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=3428.8829645361698
-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32861328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

avg iteration(step) data from cpu to GPU time:28.67096647 ms
avg iteration GPU training time:435.27154541 ms
avg iteration (step) total cpu time:482.75407155 ms
Epoch Time(s): 7.3736
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.7416 | Train Acc 0.8188 | Speed (samples/sec) 44863.7959 | GPU 28094.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32861328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

[2021-06-12 20:14:23,594] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:14:23,707] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=3450.6128101796708
-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

avg iteration(step) data from cpu to GPU time:27.00427755 ms
avg iteration GPU training time:430.70096842 ms
avg iteration (step) total cpu time:474.60198402 ms
Epoch Time(s): 7.2886
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5791 | Train Acc 0.8650 | Speed (samples/sec) 45315.5744 | GPU 28094.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24853515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28759765625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32861328125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30126953125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30322265625GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

[2021-06-12 20:14:31,718] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:14:31,831] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=3448.683451481804
-----------------------------------------after batch engine step
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.435547828674316  GigaBytes

avg iteration(step) data from cpu to GPU time:27.97124227 ms
avg iteration GPU training time:441.08460490 ms
avg iteration (step) total cpu time:485.23553212 ms
Epoch Time(s): 7.1355
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.24658203125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.28564453125GB

Max Memory Allocated 27.435547828674316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.28173828125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.25634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.454952716827393  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.4952 | Train Acc 0.8807 | Speed (samples/sec) 45147.3419 | GPU 28113.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.20166015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.20166015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.24072265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.28173828125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.25830078125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.20166015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.20166015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.24072265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66650390625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66650390625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.70556640625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72314453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.66845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.66845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.70751953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.40478515625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35009765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35009765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39697265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39501953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.41845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.41845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

avg iteration(step) data from cpu to GPU time:28.93286387 ms
avg iteration GPU training time:436.97925822 ms
avg iteration (step) total cpu time:484.09501712 ms
Epoch Time(s): 7.4790
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39501953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.4503 | Train Acc 0.8879 | Speed (samples/sec) 45088.8734 | GPU 28113.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39501953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

[2021-06-12 20:14:43,094] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:14:43,206] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=3338.960864885276
-----------------------------------------after batch engine step
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39697265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39501953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.41064453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.41845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.41845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39501953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.40869140625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.41845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.41845703125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.39501953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58251953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

avg iteration(step) data from cpu to GPU time:27.23663966 ms
avg iteration GPU training time:431.04007975 ms
avg iteration (step) total cpu time:476.15774473 ms
Epoch Time(s): 6.7772
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.4366 | Train Acc 0.8899 | Speed (samples/sec) 45311.7952 | GPU 28113.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58251953125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

[2021-06-12 20:14:50,862] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:14:50,969] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=3347.9385532958577
-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55712890625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

avg iteration(step) data from cpu to GPU time:24.23046366 ms
avg iteration GPU training time:432.31858317 ms
avg iteration (step) total cpu time:472.27096558 ms
Epoch Time(s): 6.8480
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55712890625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3990 | Train Acc 0.8985 | Speed (samples/sec) 45177.7384 | GPU 28113.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55712890625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55712890625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.56689453125GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54345703125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.58447265625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.55908203125GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

[2021-06-12 20:14:58,486] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:14:58,598] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=3362.3759709352726
-----------------------------------------after batch engine step
 Nvidia-smi: 29.56884765625GB

Max Memory Allocated 27.454952716827393  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.54541015625GB

Max Memory Allocated 27.454952716827393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.60986328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.61962890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.61962890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.55517578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.55517578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.59423828125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.63525390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.61181640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.61962890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.61962890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:29.99734306 ms
avg iteration GPU training time:596.23293050 ms
avg iteration (step) total cpu time:645.59992154 ms
Epoch Time(s): 7.1262
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.55517578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.55517578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.59423828125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07666015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08642578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08642578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3868 | Train Acc 0.9026 | Speed (samples/sec) 44884.0025 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02197265625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02197265625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08642578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08642578125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02392578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02392578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:15:06,741] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:15:06,853] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=3325.419967000971
-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:25.62149302 ms
avg iteration GPU training time:435.46363322 ms
avg iteration (step) total cpu time:475.80170631 ms
Epoch Time(s): 6.8023
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10791015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3626 | Train Acc 0.9071 | Speed (samples/sec) 44974.2798 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10791015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:29.69474157 ms
avg iteration GPU training time:442.53116862 ms
avg iteration (step) total cpu time:486.70188586 ms
Epoch Time(s): 7.6476
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10791015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3639 | Train Acc 0.9068 | Speed (samples/sec) 44985.6607 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:15:18,338] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:15:18,448] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=3335.2029046658317
-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:33.02363777 ms
avg iteration GPU training time:439.18103027 ms
avg iteration (step) total cpu time:490.32457670 ms
Epoch Time(s): 6.9220
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3577 | Train Acc 0.9082 | Speed (samples/sec) 45081.1247 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:15:26,136] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:15:26,248] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=3351.291847638183
-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:23.91525396 ms
avg iteration GPU training time:430.72135417 ms
avg iteration (step) total cpu time:470.92302640 ms
Epoch Time(s): 6.6891
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3428 | Train Acc 0.9101 | Speed (samples/sec) 45179.2759 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:15:33,833] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:15:33,941] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=3352.9789012499054
-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:26.37226677 ms
avg iteration GPU training time:444.47469076 ms
avg iteration (step) total cpu time:489.17015394 ms
Epoch Time(s): 6.8204
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3412 | Train Acc 0.9076 | Speed (samples/sec) 45128.7678 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10791015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:15:41,603] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:15:41,714] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=3358.754438500003
-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:26.37006950 ms
avg iteration GPU training time:431.77775065 ms
avg iteration (step) total cpu time:474.61883227 ms
Epoch Time(s): 6.7684
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3318 | Train Acc 0.9137 | Speed (samples/sec) 45191.8786 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10791015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:29.20360502 ms
avg iteration GPU training time:442.55848185 ms
avg iteration (step) total cpu time:488.01549276 ms
Epoch Time(s): 7.0262
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10791015625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.3315 | Train Acc 0.9106 | Speed (samples/sec) 45172.9778 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:15:52,500] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:15:52,612] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=3359.758684038697
-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:24.91125361 ms
avg iteration GPU training time:426.73422241 ms
avg iteration (step) total cpu time:467.13185310 ms
Epoch Time(s): 6.7720
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3153 | Train Acc 0.9160 | Speed (samples/sec) 45183.6515 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:16:00,266] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:00,378] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=3366.0830796506284
-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:22.86200523 ms
avg iteration GPU training time:427.03153483 ms
avg iteration (step) total cpu time:464.92290497 ms
Epoch Time(s): 6.8195
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.3235 | Train Acc 0.9145 | Speed (samples/sec) 45236.3864 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

[2021-06-12 20:16:07,981] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:08,093] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=3370.211161687889
-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

avg iteration(step) data from cpu to GPU time:24.34970729 ms
avg iteration GPU training time:431.27215576 ms
avg iteration (step) total cpu time:474.03693199 ms
Epoch Time(s): 6.7012
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.3164 | Train Acc 0.9151 | Speed (samples/sec) 45272.8361 | GPU 28117.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02587890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10595703125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.08837890625GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02392578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02392578125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.10400390625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.09033203125GB

Max Memory Allocated 27.45796775817871  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.02783203125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.06689453125GB

Max Memory Allocated 27.45796775817871  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35205078125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32470703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33447265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33447265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27001953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27001953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.30908203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35400390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.33056640625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.31298828125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35205078125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32666015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33642578125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33642578125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.31298828125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35400390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32861328125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.536396503448486  GigaBytes

[2021-06-12 20:16:16,370] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:16,483] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=3346.5157803386132
-----------------------------------------after batch engine step
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.536396503448486  GigaBytes

avg iteration(step) data from cpu to GPU time:28.09325918 ms
avg iteration GPU training time:441.64814250 ms
avg iteration (step) total cpu time:487.29260763 ms
Epoch Time(s): 7.4471
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.3039 | Train Acc 0.9159 | Speed (samples/sec) 45079.7350 | GPU 28197.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47509765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47900390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47900390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

avg iteration(step) data from cpu to GPU time:34.44018110 ms
avg iteration GPU training time:455.02704875 ms
avg iteration (step) total cpu time:506.57240550 ms
Epoch Time(s): 7.0223
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47900390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.3019 | Train Acc 0.9169 | Speed (samples/sec) 45030.3906 | GPU 28197.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

[2021-06-12 20:16:27,498] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:27,610] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=3344.0936116861917
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

avg iteration(step) data from cpu to GPU time:26.93618139 ms
avg iteration GPU training time:434.05902100 ms
avg iteration (step) total cpu time:476.44305229 ms
Epoch Time(s): 7.0137
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47900390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3097 | Train Acc 0.9150 | Speed (samples/sec) 45061.8024 | GPU 28197.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47900390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

[2021-06-12 20:16:35,401] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:35,514] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=3351.88031442593
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

avg iteration(step) data from cpu to GPU time:25.08307203 ms
avg iteration GPU training time:429.27416992 ms
avg iteration (step) total cpu time:469.18797493 ms
Epoch Time(s): 6.9146
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.3002 | Train Acc 0.9187 | Speed (samples/sec) 45128.0889 | GPU 28197.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

[2021-06-12 20:16:42,990] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:43,103] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=3360.328593468314
-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

avg iteration(step) data from cpu to GPU time:29.94633611 ms
avg iteration GPU training time:434.22368368 ms
avg iteration (step) total cpu time:480.47375679 ms
Epoch Time(s): 6.7021
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.47900390625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.3004 | Train Acc 0.9190 | Speed (samples/sec) 45170.4055 | GPU 28197.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.536396503448486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

[2021-06-12 20:16:50,745] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 20:16:50,856] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=3363.419618706097
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.536396503448486  GigaBytes

avg iteration(step) data from cpu to GPU time:27.88910866 ms
avg iteration GPU training time:445.12090047 ms
avg iteration (step) total cpu time:491.47947629 ms
Epoch Time(s): 6.7228
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91
