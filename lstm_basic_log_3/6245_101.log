[2021-06-13 02:15:38,733] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-13 02:15:42,443] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 6245 --deepspeed_config ds_config.json
[2021-06-13 02:15:43,434] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-13 02:15:43,435] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-13 02:15:43,435] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-13 02:15:43,435] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-13 02:15:43,435] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623550549.0248556
before load_ogb step Time(s): 0.0020
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.17578125, 'VmSize': 20395.01953125, 'VmHWM': 1164.89453125, 'VmRSS': 1164.89453125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6245
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2831
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0886
-------------------------------------------------end of load ogb****************** step Time(s): 0.0021
finish constructing ogbn-products
load ogb-products time total: 1.9999322891235352
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0011
after inductive else step Time(s): 0.0001
after label step Time(s): 3.8294
after train_g.create_formats_() step Time(s): 1.7531
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-13 02:15:56,640] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-13 02:15:56,642] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-13 02:15:56,645] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-13 02:15:59,004] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-13 02:15:59,006] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-13 02:15:59,006] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-13 02:15:59,006] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-13 02:15:59,006] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-13 02:15:59,006] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fa03b0e1908>
[2021-06-13 02:15:59,006] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:15:59,007] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-13 02:15:59,007] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-13 02:15:59,008] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-13 02:15:59,010] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58837890625GB

Max Memory Allocated 1.1887736320495605  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.63330078125GB

Max Memory Allocated 1.1887736320495605  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 11.59423828125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 11.59423828125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 11.60595703125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 11.60595703125GB

Max Memory Allocated 9.888594627380371  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7238 | Train Acc 0.0312 | Speed (samples/sec) nan | GPU 10125.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 11.58251953125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 11.58251953125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 11.59619140625GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.888594627380371  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09033203125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.888594627380371  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.888594627380371  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09033203125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07470703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.09619140625GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07275390625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08642578125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.09814453125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10009765625GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07666015625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.08837890625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10205078125GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.07861328125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09033203125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.08056640625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.08056640625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

[2021-06-13 02:16:03,943] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-13 02:16:03,977] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=5578.521014364249
-----------------------------------------after batch engine step
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.08251953125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.08251953125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.08251953125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.08251953125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.07080078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.07080078125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.08251953125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06884765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06884765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.08056640625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.09033203125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06884765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06884765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.08056640625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891901016235352  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.06884765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.06884765625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.08056640625GB

Max Memory Allocated 9.891901016235352  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

[2021-06-13 02:16:06,587] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:06,620] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=5941.53615966851
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

Epoch 00000 | Step 00020 | Loss 0.9313 | Train Acc 0.7661 | Speed (samples/sec) 22953.8350 | GPU 10134.8 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

[2021-06-13 02:16:09,176] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:09,208] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=6069.073862539383
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.57861328125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

avg iteration(step) data from cpu to GPU time:10.75858960 ms
avg iteration GPU training time:240.31694370 ms
avg iteration (step) total cpu time:262.29502537 ms
Epoch Time(s): 10.9505
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.6126 | Train Acc 0.8520 | Speed (samples/sec) 22438.5164 | GPU 10134.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.56884765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58056640625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57470703125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57470703125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

[2021-06-13 02:16:14,553] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:14,587] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=5822.635472564521
-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57275390625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58447265625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.897313117980957  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.57080078125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.58251953125GB

Max Memory Allocated 9.897313117980957  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:17,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:17,242] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=5889.9191088090165
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00001 | Step 00020 | Loss 0.4825 | Train Acc 0.8820 | Speed (samples/sec) 22244.1383 | GPU 10135.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:19,848] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:19,882] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=5938.212230973299
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06689453125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

avg iteration(step) data from cpu to GPU time:10.42054869 ms
avg iteration GPU training time:246.30335038 ms
avg iteration (step) total cpu time:266.84742504 ms
Epoch Time(s): 11.0844
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.4270 | Train Acc 0.8894 | Speed (samples/sec) 22207.6602 | GPU 10135.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:24,139] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:24,173] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=5998.459566437201
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:26,681] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:26,715] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=6059.909873681564
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00002 | Step 00020 | Loss 0.4194 | Train Acc 0.8919 | Speed (samples/sec) 22754.8159 | GPU 10135.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:29,117] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:29,151] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=6127.413037421537
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06689453125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

avg iteration(step) data from cpu to GPU time:9.32779496 ms
avg iteration GPU training time:224.24579818 ms
avg iteration (step) total cpu time:244.85182762 ms
Epoch Time(s): 9.7818
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.3858 | Train Acc 0.9047 | Speed (samples/sec) 22814.4191 | GPU 10135.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:33,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:33,444] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=6142.288211750459
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:36,054] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:36,088] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=6143.235039697884
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00003 | Step 00020 | Loss 0.3740 | Train Acc 0.9025 | Speed (samples/sec) 23013.8641 | GPU 10135.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:38,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:38,553] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=6182.446578000544
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05712890625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69868323 ms
avg iteration GPU training time:228.06441809 ms
avg iteration (step) total cpu time:247.62376149 ms
Epoch Time(s): 9.8659
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.05908203125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.3991 | Train Acc 0.8938 | Speed (samples/sec) 23029.2326 | GPU 10135.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:42,656] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:42,690] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=6214.237448526044
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05322265625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06494140625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:45,325] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:45,359] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=6210.467676214107
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.06884765625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04736328125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

Epoch 00004 | Step 00020 | Loss 0.3492 | Train Acc 0.9116 | Speed (samples/sec) 23110.5524 | GPU 10135.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

[2021-06-13 02:16:47,926] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:47,959] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=6216.02358775888
-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.05126953125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06298828125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.898031234741211  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.04931640625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.06103515625GB

Max Memory Allocated 9.898031234741211  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900461196899414  GigaBytes

[2021-06-13 02:16:50,588] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:50,601] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=6209.696929323289
-----------------------------------------after batch engine step
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900461196899414  GigaBytes

avg iteration(step) data from cpu to GPU time:10.30371675 ms
avg iteration GPU training time:240.74985758 ms
avg iteration (step) total cpu time:261.31542524 ms
Epoch Time(s): 10.1926
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3426 | Train Acc 0.9100 | Speed (samples/sec) 22941.8366 | GPU 10138.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

[2021-06-13 02:16:54,990] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:55,024] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=6194.240202183019
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900461196899414  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900461196899414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:16:57,458] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:16:57,492] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=6219.9026245828045
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

Epoch 00005 | Step 00020 | Loss 0.3554 | Train Acc 0.9046 | Speed (samples/sec) 23097.7608 | GPU 10138.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:16:59,987] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:00,021] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=6232.459209608062
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61004206 ms
avg iteration GPU training time:228.03715233 ms
avg iteration (step) total cpu time:248.24989284 ms
Epoch Time(s): 9.8442
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3493 | Train Acc 0.9036 | Speed (samples/sec) 23067.7455 | GPU 10138.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:04,298] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:04,332] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=6256.8428923179645
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:06,915] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:06,949] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=6254.927553874809
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

Epoch 00006 | Step 00020 | Loss 0.3523 | Train Acc 0.9084 | Speed (samples/sec) 23179.5231 | GPU 10138.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:09,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:09,542] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=6255.707044695491
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

avg iteration(step) data from cpu to GPU time:9.43447226 ms
avg iteration GPU training time:236.57960228 ms
avg iteration (step) total cpu time:255.69175791 ms
Epoch Time(s): 10.0739
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.53955078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.53955078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3310 | Train Acc 0.9106 | Speed (samples/sec) 23123.8174 | GPU 10138.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:13,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:13,823] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=6262.031291726218
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:16,489] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:16,523] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=6254.885132089322
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

Epoch 00007 | Step 00020 | Loss 0.3209 | Train Acc 0.9132 | Speed (samples/sec) 23165.1413 | GPU 10138.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:19,101] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:19,135] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=6254.755866860141
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

avg iteration(step) data from cpu to GPU time:10.08736243 ms
avg iteration GPU training time:240.10758972 ms
avg iteration (step) total cpu time:261.46229108 ms
Epoch Time(s): 10.0490
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.53955078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.53955078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3237 | Train Acc 0.9126 | Speed (samples/sec) 23096.8009 | GPU 10138.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

[2021-06-13 02:17:23,338] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:23,372] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=6258.389459687213
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.900943756103516  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.900943756103516  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:25,939] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:25,973] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=6258.629860033668
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00008 | Step 00020 | Loss 0.2955 | Train Acc 0.9217 | Speed (samples/sec) 23229.4098 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:28,358] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:28,391] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=6276.362094199239
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:9.51014865 ms
avg iteration GPU training time:224.84689048 ms
avg iteration (step) total cpu time:243.94493633 ms
Epoch Time(s): 9.6495
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3132 | Train Acc 0.9163 | Speed (samples/sec) 23235.0264 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:32,402] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:32,435] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=6294.221042562024
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:35,175] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:35,208] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=6278.38146022463
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00009 | Step 00020 | Loss 0.3198 | Train Acc 0.9129 | Speed (samples/sec) 23208.9134 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:37,908] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:37,942] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=6266.088128755132
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:40,285] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:40,297] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=6284.597152723168
-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:9.47515138 ms
avg iteration GPU training time:239.45186813 ms
avg iteration (step) total cpu time:258.69448980 ms
Epoch Time(s): 10.0673
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3027 | Train Acc 0.9177 | Speed (samples/sec) 23205.1679 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:44,643] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:44,677] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=6276.809371517387
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:47,178] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:47,211] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=6280.9433361305055
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00010 | Step 00020 | Loss 0.3238 | Train Acc 0.9127 | Speed (samples/sec) 23270.4770 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:49,578] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:49,612] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=6294.21887269574
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:9.24389218 ms
avg iteration GPU training time:226.38262544 ms
avg iteration (step) total cpu time:244.94333620 ms
Epoch Time(s): 9.7603
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3347 | Train Acc 0.9090 | Speed (samples/sec) 23272.2329 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:53,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:54,013] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=6287.506023625018
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:56,615] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:56,648] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=6285.752175245565
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00011 | Step 00020 | Loss 0.3143 | Train Acc 0.9158 | Speed (samples/sec) 23272.2965 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:17:59,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:17:59,256] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=6285.040121305376
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:10.38471704 ms
avg iteration GPU training time:242.69285527 ms
avg iteration (step) total cpu time:263.85173974 ms
Epoch Time(s): 10.1785
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3170 | Train Acc 0.9127 | Speed (samples/sec) 23211.0897 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:03,598] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:03,632] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=6275.5616682295595
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:06,181] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:06,215] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=6276.044321644601
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00012 | Step 00020 | Loss 0.3093 | Train Acc 0.9164 | Speed (samples/sec) 23259.4740 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:08,600] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:08,634] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=6286.979331712033
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:9.35573806 ms
avg iteration GPU training time:228.05208277 ms
avg iteration (step) total cpu time:246.99227898 ms
Epoch Time(s): 9.7573
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3127 | Train Acc 0.9156 | Speed (samples/sec) 23257.5568 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:12,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:12,860] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=6288.72048181434
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:15,773] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:15,807] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=6267.088301409368
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00013 | Step 00020 | Loss 0.3201 | Train Acc 0.9159 | Speed (samples/sec) 23174.6543 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:18,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:18,713] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=6249.18699850636
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56103515625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:10.09057893 ms
avg iteration GPU training time:259.60710427 ms
avg iteration (step) total cpu time:279.37350450 ms
Epoch Time(s): 10.6972
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3199 | Train Acc 0.9090 | Speed (samples/sec) 23122.2991 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:22,915] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:22,948] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=6253.888875564909
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:25,575] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:25,609] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=6251.089155024111
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00014 | Step 00020 | Loss 0.2964 | Train Acc 0.9190 | Speed (samples/sec) 23137.1956 | GPU 10146.6 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:28,286] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:28,320] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=6246.190339088803
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

[2021-06-13 02:18:31,159] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:31,172] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=6232.111125977451
-----------------------------------------after batch engine step
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

avg iteration(step) data from cpu to GPU time:9.99012726 ms
avg iteration GPU training time:256.30656942 ms
avg iteration (step) total cpu time:276.38503357 ms
Epoch Time(s): 10.4708
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.53955078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.53955078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55126953125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3135 | Train Acc 0.9121 | Speed (samples/sec) 23044.5435 | GPU 10146.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.908783435821533  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.908783435821533  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

[2021-06-13 02:18:35,511] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:35,545] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=6229.531773430964
-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

[2021-06-13 02:18:38,247] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:38,281] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=6223.114123090401
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

Epoch 00015 | Step 00020 | Loss 0.3134 | Train Acc 0.9180 | Speed (samples/sec) 23046.3360 | GPU 10146.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

[2021-06-13 02:18:40,904] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:40,938] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=6220.245381920863
-----------------------------------------after batch engine step
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54345703125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.54931640625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44643912 ms
avg iteration GPU training time:248.76256929 ms
avg iteration (step) total cpu time:268.00273083 ms
Epoch Time(s): 10.2979
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55322265625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56298828125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56494140625GB

Max Memory Allocated 9.909103393554688  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.3018 | Train Acc 0.9171 | Speed (samples/sec) 22996.6476 | GPU 10146.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54150390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55517578125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54736328125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55908203125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56689453125GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.56884765625GB

Max Memory Allocated 9.909103393554688  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.54541015625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.55712890625GB

Max Memory Allocated 9.909103393554688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:18:45,408] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:45,441] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=6209.319990227875
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:18:48,079] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:48,113] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=6206.541473195189
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00016 | Step 00020 | Loss 0.3210 | Train Acc 0.9140 | Speed (samples/sec) 22991.0992 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:18:50,696] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:50,730] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=6206.355298276312
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04736328125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.31423055 ms
avg iteration GPU training time:243.83821275 ms
avg iteration (step) total cpu time:262.70356002 ms
Epoch Time(s): 10.2731
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.2989 | Train Acc 0.9191 | Speed (samples/sec) 22965.1368 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:18:54,924] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:54,958] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=6211.26315218285
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:18:57,342] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:18:57,376] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=6220.409713086546
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00017 | Step 00020 | Loss 0.2911 | Train Acc 0.9191 | Speed (samples/sec) 23035.2082 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:18:59,997] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:00,032] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=6218.571463078956
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71173324 ms
avg iteration GPU training time:230.14302346 ms
avg iteration (step) total cpu time:249.51420007 ms
Epoch Time(s): 9.7253
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2955 | Train Acc 0.9207 | Speed (samples/sec) 23021.7049 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:04,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:04,235] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=6222.8866472421905
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:06,756] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:06,790] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=6225.85059116292
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00018 | Step 00020 | Loss 0.3225 | Train Acc 0.9135 | Speed (samples/sec) 23040.9079 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:09,499] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:09,539] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=6219.947283919211
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.40488533 ms
avg iteration GPU training time:242.31997116 ms
avg iteration (step) total cpu time:261.84844971 ms
Epoch Time(s): 10.1279
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2984 | Train Acc 0.9204 | Speed (samples/sec) 23009.5270 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:13,806] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:13,839] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=6220.524757850527
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:16,457] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:16,504] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=6219.249496926126
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00019 | Step 00020 | Loss 0.3169 | Train Acc 0.9129 | Speed (samples/sec) 23028.0179 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:19,116] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:19,149] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=6219.373461580284
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:21,756] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:21,769] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=6218.778818234578
-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:10.24531198 ms
avg iteration GPU training time:242.47190631 ms
avg iteration (step) total cpu time:263.64546352 ms
Epoch Time(s): 10.2160
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2765 | Train Acc 0.9206 | Speed (samples/sec) 22991.3401 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:26,312] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:26,346] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=6212.242355572963
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:29,219] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:29,253] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=6201.550789303723
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00020 | Step 00020 | Loss 0.3038 | Train Acc 0.9167 | Speed (samples/sec) 22959.0174 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:32,156] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:32,190] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=6189.537099248123
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11670280 ms
avg iteration GPU training time:270.02785972 ms
avg iteration (step) total cpu time:290.28136642 ms
Epoch Time(s): 10.9593
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03564453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03564453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04736328125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2824 | Train Acc 0.9257 | Speed (samples/sec) 22886.6554 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:36,815] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:36,848] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=6178.449694640457
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:39,642] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:39,676] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=6171.597221974786
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00021 | Step 00020 | Loss 0.3017 | Train Acc 0.9211 | Speed (samples/sec) 22855.9696 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:42,439] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:42,473] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=6165.7591641545005
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:10.28259793 ms
avg iteration GPU training time:259.20071411 ms
avg iteration (step) total cpu time:279.46121604 ms
Epoch Time(s): 10.7411
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3178 | Train Acc 0.9102 | Speed (samples/sec) 22811.9286 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:46,757] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:46,790] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=6164.569345690781
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:49,334] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:49,369] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=6166.955357964827
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00022 | Step 00020 | Loss 0.3129 | Train Acc 0.9116 | Speed (samples/sec) 22836.6581 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:52,059] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:52,093] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=6164.374597969532
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.80459144 ms
avg iteration GPU training time:242.14784241 ms
avg iteration (step) total cpu time:262.31258004 ms
Epoch Time(s): 10.1053
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2865 | Train Acc 0.9215 | Speed (samples/sec) 22810.3933 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:56,445] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:56,479] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=6160.9445295996675
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:19:59,132] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:19:59,165] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=6159.642290132257
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00023 | Step 00020 | Loss 0.3270 | Train Acc 0.9098 | Speed (samples/sec) 22818.2049 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:01,792] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:01,826] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=6159.182127799124
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04736328125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.93942277 ms
avg iteration GPU training time:241.69942051 ms
avg iteration (step) total cpu time:261.65992242 ms
Epoch Time(s): 10.1830
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.3011 | Train Acc 0.9190 | Speed (samples/sec) 22799.9931 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:06,007] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:06,040] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=6161.190424182136
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:08,709] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:08,743] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=6159.564824886537
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00024 | Step 00020 | Loss 0.2903 | Train Acc 0.9249 | Speed (samples/sec) 22809.4152 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:11,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:11,421] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=6158.480969137358
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:13,913] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:13,926] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=6162.427237503274
-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.91580688 ms
avg iteration GPU training time:238.63966596 ms
avg iteration (step) total cpu time:258.53064325 ms
Epoch Time(s): 10.1661
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.3232 | Train Acc 0.9143 | Speed (samples/sec) 22795.1424 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:18,258] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:18,291] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=6163.845449938625
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:20,840] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:20,874] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=6165.528487511618
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00025 | Step 00020 | Loss 0.2971 | Train Acc 0.9211 | Speed (samples/sec) 22825.4846 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:23,446] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:23,480] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=6166.405759605178
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.50705064 ms
avg iteration GPU training time:239.57887268 ms
avg iteration (step) total cpu time:259.00452225 ms
Epoch Time(s): 9.9800
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2928 | Train Acc 0.9191 | Speed (samples/sec) 22807.6908 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:27,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:27,719] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=6169.545573328691
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:30,311] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:30,344] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=6170.542616579798
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00026 | Step 00020 | Loss 0.2969 | Train Acc 0.9182 | Speed (samples/sec) 22834.5689 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:32,872] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:32,906] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=6172.729462522206
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:10.40706142 ms
avg iteration GPU training time:235.75129587 ms
avg iteration (step) total cpu time:256.51179420 ms
Epoch Time(s): 9.9377
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2939 | Train Acc 0.9219 | Speed (samples/sec) 22823.1818 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:37,251] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:37,285] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=6172.0153439401065
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:39,939] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:39,974] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=6170.570262569756
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00027 | Step 00020 | Loss 0.2967 | Train Acc 0.9179 | Speed (samples/sec) 22836.1836 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:42,540] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:42,574] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=6171.516510269693
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:10.63845799 ms
avg iteration GPU training time:237.93904170 ms
avg iteration (step) total cpu time:258.17259153 ms
Epoch Time(s): 10.1392
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.3045 | Train Acc 0.9167 | Speed (samples/sec) 22827.9460 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:46,749] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:46,783] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=6174.919056213206
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:49,314] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:49,348] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=6176.913005509437
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00028 | Step 00020 | Loss 0.2905 | Train Acc 0.9236 | Speed (samples/sec) 22865.1186 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:51,831] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:51,865] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=6180.15762878184
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.52576943 ms
avg iteration GPU training time:227.51159724 ms
avg iteration (step) total cpu time:246.73213782 ms
Epoch Time(s): 9.6851
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2760 | Train Acc 0.9235 | Speed (samples/sec) 22867.3260 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:55,946] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:55,979] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=6184.492863413787
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:20:58,806] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:20:58,840] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=6178.264296463198
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00029 | Step 00020 | Loss 0.3100 | Train Acc 0.9187 | Speed (samples/sec) 22865.1189 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:21:01,424] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:01,458] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=6178.895004524363
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:21:04,009] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:04,022] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=6180.346004042647
-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75546772 ms
avg iteration GPU training time:246.19453600 ms
avg iteration (step) total cpu time:265.84355919 ms
Epoch Time(s): 10.3035
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2949 | Train Acc 0.9225 | Speed (samples/sec) 22848.5021 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:21:08,358] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:08,390] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=6179.7525924389
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:21:11,102] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:11,135] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=6176.959679585993
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00030 | Step 00020 | Loss 0.2954 | Train Acc 0.9183 | Speed (samples/sec) 22856.4041 | GPU 10154.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

[2021-06-13 02:21:13,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:13,624] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=6180.652533128258
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.916409015655518  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17129480 ms
avg iteration GPU training time:237.22621889 ms
avg iteration (step) total cpu time:257.28359929 ms
Epoch Time(s): 10.0442
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.916409015655518  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.3031 | Train Acc 0.9185 | Speed (samples/sec) 22854.0888 | GPU 10154.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.916409015655518  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.916409015655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:17,949] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:17,983] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=6180.585279887097
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:20,493] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:20,527] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=6182.91642940929
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00031 | Step 00020 | Loss 0.2812 | Train Acc 0.9262 | Speed (samples/sec) 22876.7939 | GPU 10155.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:23,103] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:23,138] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=6183.309521657643
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.917685508728027  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81683911 ms
avg iteration GPU training time:235.84306448 ms
avg iteration (step) total cpu time:255.28908659 ms
Epoch Time(s): 10.0501
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.3112 | Train Acc 0.9183 | Speed (samples/sec) 22862.2309 | GPU 10155.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:27,252] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:27,296] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=6186.9803566628425
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:29,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:29,949] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=6186.179413981835
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00032 | Step 00020 | Loss 0.2984 | Train Acc 0.9211 | Speed (samples/sec) 22888.1167 | GPU 10155.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:32,506] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:32,540] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=6186.963133972681
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05908203125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37803971 ms
avg iteration GPU training time:239.11460989 ms
avg iteration (step) total cpu time:257.99717727 ms
Epoch Time(s): 9.9424
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2990 | Train Acc 0.9207 | Speed (samples/sec) 22874.7741 | GPU 10155.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:36,846] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:36,880] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=6187.574685924547
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:39,378] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:39,412] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=6189.922276016751
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00033 | Step 00020 | Loss 0.2959 | Train Acc 0.9219 | Speed (samples/sec) 22899.9639 | GPU 10155.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:42,040] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:42,074] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=6189.527521075749
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04736328125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

avg iteration(step) data from cpu to GPU time:9.96338846 ms
avg iteration GPU training time:237.78131386 ms
avg iteration (step) total cpu time:257.67304279 ms
Epoch Time(s): 10.0565
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.3345 | Train Acc 0.9110 | Speed (samples/sec) 22880.8631 | GPU 10155.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:46,315] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:46,348] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=6190.506931218868
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:49,063] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:49,098] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=6187.941965258752
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00034 | Step 00020 | Loss 0.2997 | Train Acc 0.9214 | Speed (samples/sec) 22874.7827 | GPU 10155.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:51,900] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:51,933] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=6183.677223903258
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:54,583] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:54,596] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=6182.695854357356
-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

avg iteration(step) data from cpu to GPU time:10.30188566 ms
avg iteration GPU training time:255.79234031 ms
avg iteration (step) total cpu time:276.59860364 ms
Epoch Time(s): 10.4905
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03759765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04931640625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2892 | Train Acc 0.9217 | Speed (samples/sec) 22849.5065 | GPU 10155.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:21:58,992] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:21:59,025] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=6180.754737488974
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:22:01,420] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:01,454] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=6185.351827944783
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00035 | Step 00020 | Loss 0.2800 | Train Acc 0.9243 | Speed (samples/sec) 22879.3030 | GPU 10155.7 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:22:03,895] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:03,929] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=6188.536354804272
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06103515625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.04736328125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12502638 ms
avg iteration GPU training time:230.37314012 ms
avg iteration (step) total cpu time:250.19058475 ms
Epoch Time(s): 9.8162
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05126953125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2947 | Train Acc 0.9191 | Speed (samples/sec) 22872.7913 | GPU 10155.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06298828125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.03955078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.07080078125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:22:08,328] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:08,362] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=6185.137823234022
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04541015625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05712890625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06884765625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.06494140625GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04150390625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05322265625GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes

[2021-06-13 02:22:11,036] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:11,070] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=6183.566955535642
-----------------------------------------after batch engine step
 Nvidia-smi: 19.06689453125GB

Max Memory Allocated 9.917685508728027  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.04345703125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.05517578125GB

Max Memory Allocated 9.917685508728027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00036 | Step 00020 | Loss 0.3022 | Train Acc 0.9204 | Speed (samples/sec) 22864.4737 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:13,791] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:13,827] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=6180.8950044948115
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:10.37468087 ms
avg iteration GPU training time:250.09098251 ms
avg iteration (step) total cpu time:270.50312360 ms
Epoch Time(s): 10.4183
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2836 | Train Acc 0.9247 | Speed (samples/sec) 22846.2720 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:18,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:18,318] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=6177.549363280665
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:21,048] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:21,082] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=6175.276760560046
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00037 | Step 00020 | Loss 0.2906 | Train Acc 0.9211 | Speed (samples/sec) 22841.7423 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:23,633] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:23,667] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=6176.408634575525
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55126953125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:10.47201310 ms
avg iteration GPU training time:245.10023725 ms
avg iteration (step) total cpu time:265.71652624 ms
Epoch Time(s): 10.3829
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.3051 | Train Acc 0.9212 | Speed (samples/sec) 22829.5394 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:27,970] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:28,004] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=6177.471397504897
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:30,545] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:30,579] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=6178.786784026082
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00038 | Step 00020 | Loss 0.3106 | Train Acc 0.9158 | Speed (samples/sec) 22840.9103 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:33,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:33,375] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=6175.760779147419
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:10.30821449 ms
avg iteration GPU training time:243.30859884 ms
avg iteration (step) total cpu time:263.63119373 ms
Epoch Time(s): 10.2010
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2994 | Train Acc 0.9171 | Speed (samples/sec) 22827.3152 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:37,662] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:37,695] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=6176.435060930102
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:40,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:40,375] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=6175.938082674002
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00039 | Step 00020 | Loss 0.2994 | Train Acc 0.9204 | Speed (samples/sec) 22836.1758 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:42,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:43,019] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=6175.96484850364
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:45,372] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:45,385] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=6180.960449983914
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17733805 ms
avg iteration GPU training time:234.02012747 ms
avg iteration (step) total cpu time:254.43284600 ms
Epoch Time(s): 9.9593
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.3028 | Train Acc 0.9163 | Speed (samples/sec) 22837.6491 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:49,853] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:49,887] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=6176.784569935962
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:52,475] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:52,509] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=6177.285786015672
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00040 | Step 00020 | Loss 0.2980 | Train Acc 0.9179 | Speed (samples/sec) 22844.1800 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:54,917] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:54,951] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=6180.652466316577
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.72717396 ms
avg iteration GPU training time:235.71272673 ms
avg iteration (step) total cpu time:255.27841957 ms
Epoch Time(s): 10.0072
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.3114 | Train Acc 0.9164 | Speed (samples/sec) 22845.6576 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:22:59,293] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:22:59,327] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=6179.152698605844
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:01,832] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:01,866] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=6181.043530699096
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00041 | Step 00020 | Loss 0.2921 | Train Acc 0.9215 | Speed (samples/sec) 22852.4913 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:04,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:04,624] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=6178.6627656711735
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.87976304 ms
avg iteration GPU training time:240.63095262 ms
avg iteration (step) total cpu time:260.29515266 ms
Epoch Time(s): 10.1545
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2872 | Train Acc 0.9193 | Speed (samples/sec) 22842.3606 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:08,736] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:08,769] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=6181.958923904696
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:11,229] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:11,263] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=6184.346860330089
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00042 | Step 00020 | Loss 0.3086 | Train Acc 0.9164 | Speed (samples/sec) 22877.0076 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:13,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:13,741] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=6187.0452648468645
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.19306430 ms
avg iteration GPU training time:226.66746747 ms
avg iteration (step) total cpu time:245.20481074 ms
Epoch Time(s): 9.6278
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2885 | Train Acc 0.9222 | Speed (samples/sec) 22876.1113 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:18,242] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:18,274] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=6186.833838210722
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:21,027] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:21,061] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=6184.45669628342
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00043 | Step 00020 | Loss 0.3096 | Train Acc 0.9153 | Speed (samples/sec) 22870.4899 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:23,663] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:23,696] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=6184.6525015780635
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:10.56571021 ms
avg iteration GPU training time:243.60118781 ms
avg iteration (step) total cpu time:264.59865217 ms
Epoch Time(s): 10.5736
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.3065 | Train Acc 0.9174 | Speed (samples/sec) 22859.4933 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:28,168] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:28,202] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=6184.579214829072
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:31,024] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:31,058] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=6180.644981404296
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00044 | Step 00020 | Loss 0.3084 | Train Acc 0.9132 | Speed (samples/sec) 22854.5439 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:33,727] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:33,761] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=6179.5923995584635
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:36,307] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:36,321] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=6180.4948383539495
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.88695005 ms
avg iteration GPU training time:247.53442326 ms
avg iteration (step) total cpu time:267.13887850 ms
Epoch Time(s): 10.5923
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.3100 | Train Acc 0.9124 | Speed (samples/sec) 22842.5070 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:40,680] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:40,712] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=6179.916442240125
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:43,224] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:43,258] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=6181.321453923467
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00045 | Step 00020 | Loss 0.3005 | Train Acc 0.9180 | Speed (samples/sec) 22862.4227 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:45,711] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:45,746] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=6183.608964995427
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.27704537 ms
avg iteration GPU training time:233.08400698 ms
avg iteration (step) total cpu time:252.05082364 ms
Epoch Time(s): 9.8761
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.3272 | Train Acc 0.9122 | Speed (samples/sec) 22860.5062 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:50,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:50,163] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=6182.223801830182
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:52,886] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:52,920] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=6180.05754712147
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00046 | Step 00020 | Loss 0.2983 | Train Acc 0.9153 | Speed (samples/sec) 22858.5712 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:55,385] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:55,419] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=6182.283679806126
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:10.23525099 ms
avg iteration GPU training time:239.64330829 ms
avg iteration (step) total cpu time:259.52763911 ms
Epoch Time(s): 10.1336
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.3047 | Train Acc 0.9180 | Speed (samples/sec) 22859.6731 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:23:59,634] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:23:59,668] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=6184.759490409618
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:02,288] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:02,321] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=6184.136543313787
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00047 | Step 00020 | Loss 0.2895 | Train Acc 0.9214 | Speed (samples/sec) 22874.8178 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:04,895] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:04,929] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=6184.363390700288
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.15605096 ms
avg iteration GPU training time:237.64328512 ms
avg iteration (step) total cpu time:256.24447399 ms
Epoch Time(s): 10.0208
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.3042 | Train Acc 0.9174 | Speed (samples/sec) 22870.0094 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:09,189] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:09,222] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=6184.9333276111665
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:11,877] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:11,911] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=6184.530666493973
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00048 | Step 00020 | Loss 0.2961 | Train Acc 0.9188 | Speed (samples/sec) 22881.0017 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:14,403] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:14,437] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=6186.234426001893
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.36439103 ms
avg iteration GPU training time:234.99424292 ms
avg iteration (step) total cpu time:254.04782648 ms
Epoch Time(s): 10.0416
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.3046 | Train Acc 0.9209 | Speed (samples/sec) 22876.2178 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:18,702] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:18,735] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=6186.2401280587055
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:21,611] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:21,645] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=6182.411438056303
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00049 | Step 00020 | Loss 0.3103 | Train Acc 0.9172 | Speed (samples/sec) 22872.3195 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:24,211] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:24,244] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=6182.894958766617
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:26,581] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:26,594] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=6186.954067585561
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

avg iteration(step) data from cpu to GPU time:9.02346789 ms
avg iteration GPU training time:238.82240748 ms
avg iteration (step) total cpu time:259.08327986 ms
Epoch Time(s): 10.1925
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.3067 | Train Acc 0.9148 | Speed (samples/sec) 22875.6390 | GPU 10160.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:31,066] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:31,100] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=6184.78139058855
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

[2021-06-13 02:24:33,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=1620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:33,860] [INFO] [timer.py:160:stop] 0/1620, SamplesPerSec=6183.023915981317
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

Epoch 00050 | Step 00020 | Loss 0.2970 | Train Acc 0.9188 | Speed (samples/sec) 22871.4146 | GPU 10160.5 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.922382831573486  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.922382831573486  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:24:36,426] [INFO] [logging.py:60:log_dist] [Rank 0] step=1630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:24:36,460] [INFO] [timer.py:160:stop] 0/1630, SamplesPerSec=6183.478465801827
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:11.32477511 ms
avg iteration GPU training time:246.44073373 ms
avg iteration (step) total cpu time:268.12297327 ms
Epoch Time(s): 10.3576
Eval Acc 0.9093
Test Acc: 0.7494
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.3008 | Train Acc 0.9167 | Speed (samples/sec) 22861.4940 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:25:49,045] [INFO] [logging.py:60:log_dist] [Rank 0] step=1640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:25:49,079] [INFO] [timer.py:160:stop] 0/1640, SamplesPerSec=6181.270613483821
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:25:51,720] [INFO] [logging.py:60:log_dist] [Rank 0] step=1650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:25:51,753] [INFO] [timer.py:160:stop] 0/1650, SamplesPerSec=6180.842922462431
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00051 | Step 00020 | Loss 0.2958 | Train Acc 0.9185 | Speed (samples/sec) 22860.9715 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:25:54,507] [INFO] [logging.py:60:log_dist] [Rank 0] step=1660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:25:54,540] [INFO] [timer.py:160:stop] 0/1660, SamplesPerSec=6178.583658663618
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.33882192 ms
avg iteration GPU training time:249.39061539 ms
avg iteration (step) total cpu time:270.68199935 ms
Epoch Time(s): 10.5099
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.3270 | Train Acc 0.9110 | Speed (samples/sec) 22844.0869 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:25:59,106] [INFO] [logging.py:60:log_dist] [Rank 0] step=1670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:25:59,139] [INFO] [timer.py:160:stop] 0/1670, SamplesPerSec=6176.305406342666
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:02,062] [INFO] [logging.py:60:log_dist] [Rank 0] step=1680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:02,096] [INFO] [timer.py:160:stop] 0/1680, SamplesPerSec=6171.905502603879
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00052 | Step 00020 | Loss 0.3101 | Train Acc 0.9156 | Speed (samples/sec) 22822.7079 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:04,913] [INFO] [logging.py:60:log_dist] [Rank 0] step=1690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:04,947] [INFO] [timer.py:160:stop] 0/1690, SamplesPerSec=6168.945400295882
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55126953125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.56516608 ms
avg iteration GPU training time:257.75711568 ms
avg iteration (step) total cpu time:279.53275045 ms
Epoch Time(s): 10.8346
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.3082 | Train Acc 0.9171 | Speed (samples/sec) 22814.9880 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:09,268] [INFO] [logging.py:60:log_dist] [Rank 0] step=1700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:09,316] [INFO] [timer.py:160:stop] 0/1700, SamplesPerSec=6169.112180018631
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:12,211] [INFO] [logging.py:60:log_dist] [Rank 0] step=1710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:12,245] [INFO] [timer.py:160:stop] 0/1710, SamplesPerSec=6165.16779330698
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00053 | Step 00020 | Loss 0.3200 | Train Acc 0.9145 | Speed (samples/sec) 22800.8401 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:15,025] [INFO] [logging.py:60:log_dist] [Rank 0] step=1720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:15,059] [INFO] [timer.py:160:stop] 0/1720, SamplesPerSec=6162.635320298258
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.27738310 ms
avg iteration GPU training time:256.29499760 ms
avg iteration (step) total cpu time:276.49441472 ms
Epoch Time(s): 10.7027
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.3241 | Train Acc 0.9118 | Speed (samples/sec) 22788.8811 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:19,392] [INFO] [logging.py:60:log_dist] [Rank 0] step=1730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:19,425] [INFO] [timer.py:160:stop] 0/1730, SamplesPerSec=6162.95356764195
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:22,060] [INFO] [logging.py:60:log_dist] [Rank 0] step=1740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:22,094] [INFO] [timer.py:160:stop] 0/1740, SamplesPerSec=6163.026992524417
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00054 | Step 00020 | Loss 0.3181 | Train Acc 0.9145 | Speed (samples/sec) 22791.1999 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:24,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=1750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:24,860] [INFO] [timer.py:160:stop] 0/1750, SamplesPerSec=6161.634986167541
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:27,360] [INFO] [logging.py:60:log_dist] [Rank 0] step=1760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:27,373] [INFO] [timer.py:160:stop] 0/1760, SamplesPerSec=6163.182018683774
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.95646214 ms
avg iteration GPU training time:242.24006370 ms
avg iteration (step) total cpu time:263.60074679 ms
Epoch Time(s): 10.2872
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.3232 | Train Acc 0.9118 | Speed (samples/sec) 22785.0168 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:31,746] [INFO] [logging.py:60:log_dist] [Rank 0] step=1770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:31,780] [INFO] [timer.py:160:stop] 0/1770, SamplesPerSec=6161.929638988734
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:34,621] [INFO] [logging.py:60:log_dist] [Rank 0] step=1780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:34,655] [INFO] [timer.py:160:stop] 0/1780, SamplesPerSec=6158.5610077794345
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00055 | Step 00020 | Loss 0.3011 | Train Acc 0.9172 | Speed (samples/sec) 22781.1073 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:37,394] [INFO] [logging.py:60:log_dist] [Rank 0] step=1790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:37,428] [INFO] [timer.py:160:stop] 0/1790, SamplesPerSec=6156.418277430415
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:9.62047280 ms
avg iteration GPU training time:258.39714728 ms
avg iteration (step) total cpu time:277.81586294 ms
Epoch Time(s): 10.5416
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.3178 | Train Acc 0.9122 | Speed (samples/sec) 22765.5964 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:41,673] [INFO] [logging.py:60:log_dist] [Rank 0] step=1800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:41,707] [INFO] [timer.py:160:stop] 0/1800, SamplesPerSec=6158.074440025431
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:44,397] [INFO] [logging.py:60:log_dist] [Rank 0] step=1810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:44,430] [INFO] [timer.py:160:stop] 0/1810, SamplesPerSec=6157.006074727859
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00056 | Step 00020 | Loss 0.3037 | Train Acc 0.9143 | Speed (samples/sec) 22773.7402 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:46,924] [INFO] [logging.py:60:log_dist] [Rank 0] step=1820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:46,958] [INFO] [timer.py:160:stop] 0/1820, SamplesPerSec=6158.643925704501
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.19577360 ms
avg iteration GPU training time:238.89319582 ms
avg iteration (step) total cpu time:258.81271892 ms
Epoch Time(s): 10.0222
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2877 | Train Acc 0.9193 | Speed (samples/sec) 22771.3787 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:51,323] [INFO] [logging.py:60:log_dist] [Rank 0] step=1830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:51,356] [INFO] [timer.py:160:stop] 0/1830, SamplesPerSec=6157.793578411391
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:54,006] [INFO] [logging.py:60:log_dist] [Rank 0] step=1840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:54,040] [INFO] [timer.py:160:stop] 0/1840, SamplesPerSec=6157.213759062273
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00057 | Step 00020 | Loss 0.3032 | Train Acc 0.9171 | Speed (samples/sec) 22779.7803 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:26:56,480] [INFO] [logging.py:60:log_dist] [Rank 0] step=1850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:26:56,514] [INFO] [timer.py:160:stop] 0/1850, SamplesPerSec=6159.423269401363
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:9.60176358 ms
avg iteration GPU training time:233.09682267 ms
avg iteration (step) total cpu time:252.64519232 ms
Epoch Time(s): 9.9623
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.3039 | Train Acc 0.9182 | Speed (samples/sec) 22780.4386 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:00,726] [INFO] [logging.py:60:log_dist] [Rank 0] step=1860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:00,759] [INFO] [timer.py:160:stop] 0/1860, SamplesPerSec=6160.171794639075
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:03,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=1870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:03,547] [INFO] [timer.py:160:stop] 0/1870, SamplesPerSec=6158.262213625317
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00058 | Step 00020 | Loss 0.3105 | Train Acc 0.9177 | Speed (samples/sec) 22780.4460 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:06,232] [INFO] [logging.py:60:log_dist] [Rank 0] step=1880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:06,267] [INFO] [timer.py:160:stop] 0/1880, SamplesPerSec=6157.23462278168
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:9.53785474 ms
avg iteration GPU training time:252.35088433 ms
avg iteration (step) total cpu time:271.62959841 ms
Epoch Time(s): 10.4380
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.3031 | Train Acc 0.9166 | Speed (samples/sec) 22766.4443 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:10,614] [INFO] [logging.py:60:log_dist] [Rank 0] step=1890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:10,647] [INFO] [timer.py:160:stop] 0/1890, SamplesPerSec=6156.211813032201
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:13,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=1900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:13,482] [INFO] [timer.py:160:stop] 0/1900, SamplesPerSec=6153.753005360131
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00059 | Step 00020 | Loss 0.3082 | Train Acc 0.9142 | Speed (samples/sec) 22766.9104 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:16,070] [INFO] [logging.py:60:log_dist] [Rank 0] step=1910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:16,104] [INFO] [timer.py:160:stop] 0/1910, SamplesPerSec=6154.490384098504
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:18,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=1920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:18,718] [INFO] [timer.py:160:stop] 0/1920, SamplesPerSec=6154.758712722059
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:11.23304302 ms
avg iteration GPU training time:244.59827790 ms
avg iteration (step) total cpu time:265.96268901 ms
Epoch Time(s): 10.3985
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2766 | Train Acc 0.9219 | Speed (samples/sec) 22756.4679 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:23,251] [INFO] [logging.py:60:log_dist] [Rank 0] step=1930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:23,285] [INFO] [timer.py:160:stop] 0/1930, SamplesPerSec=6152.33419543269
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:25,883] [INFO] [logging.py:60:log_dist] [Rank 0] step=1940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:25,917] [INFO] [timer.py:160:stop] 0/1940, SamplesPerSec=6152.675989573503
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00060 | Step 00020 | Loss 0.3123 | Train Acc 0.9150 | Speed (samples/sec) 22760.5497 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:28,424] [INFO] [logging.py:60:log_dist] [Rank 0] step=1950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:28,458] [INFO] [timer.py:160:stop] 0/1950, SamplesPerSec=6154.008714248619
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.30997089 ms
avg iteration GPU training time:237.52135100 ms
avg iteration (step) total cpu time:257.78500239 ms
Epoch Time(s): 10.1551
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.3161 | Train Acc 0.9143 | Speed (samples/sec) 22757.2068 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:32,881] [INFO] [logging.py:60:log_dist] [Rank 0] step=1960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:32,913] [INFO] [timer.py:160:stop] 0/1960, SamplesPerSec=6152.73056925396
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:35,505] [INFO] [logging.py:60:log_dist] [Rank 0] step=1970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:35,538] [INFO] [timer.py:160:stop] 0/1970, SamplesPerSec=6153.108911438233
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00061 | Step 00020 | Loss 0.3058 | Train Acc 0.9155 | Speed (samples/sec) 22761.9758 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:38,169] [INFO] [logging.py:60:log_dist] [Rank 0] step=1980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:38,203] [INFO] [timer.py:160:stop] 0/1980, SamplesPerSec=6153.002071275681
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

avg iteration(step) data from cpu to GPU time:10.50377362 ms
avg iteration GPU training time:242.72235107 ms
avg iteration (step) total cpu time:263.06274202 ms
Epoch Time(s): 10.2993
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.3385 | Train Acc 0.9111 | Speed (samples/sec) 22752.6217 | GPU 10160.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:42,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=1990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:42,633] [INFO] [timer.py:160:stop] 0/1990, SamplesPerSec=6151.98113987374
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

[2021-06-13 02:27:45,190] [INFO] [logging.py:60:log_dist] [Rank 0] step=2000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:45,223] [INFO] [timer.py:160:stop] 0/2000, SamplesPerSec=6152.703416678857
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

Epoch 00062 | Step 00020 | Loss 0.3231 | Train Acc 0.9127 | Speed (samples/sec) 22758.2154 | GPU 10160.9 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.9227933883667  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.9227933883667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:27:47,977] [INFO] [logging.py:60:log_dist] [Rank 0] step=2010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:48,011] [INFO] [timer.py:160:stop] 0/2010, SamplesPerSec=6151.020075662019
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.95817721 ms
avg iteration GPU training time:243.03264194 ms
avg iteration (step) total cpu time:263.11907062 ms
Epoch Time(s): 10.2832
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.3199 | Train Acc 0.9105 | Speed (samples/sec) 22747.6860 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:27:52,271] [INFO] [logging.py:60:log_dist] [Rank 0] step=2020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:52,305] [INFO] [timer.py:160:stop] 0/2020, SamplesPerSec=6152.674603887921
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:27:54,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=2030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:55,013] [INFO] [timer.py:160:stop] 0/2030, SamplesPerSec=6151.924918951709
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00063 | Step 00020 | Loss 0.3123 | Train Acc 0.9139 | Speed (samples/sec) 22752.3682 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:27:57,700] [INFO] [logging.py:60:log_dist] [Rank 0] step=2040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:27:57,734] [INFO] [timer.py:160:stop] 0/2040, SamplesPerSec=6151.201745742141
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.54683602 ms
avg iteration GPU training time:239.24329687 ms
avg iteration (step) total cpu time:259.09681673 ms
Epoch Time(s): 10.1054
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3430 | Train Acc 0.9054 | Speed (samples/sec) 22752.7811 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:01,774] [INFO] [logging.py:60:log_dist] [Rank 0] step=2050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:01,806] [INFO] [timer.py:160:stop] 0/2050, SamplesPerSec=6153.583710034662
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:04,279] [INFO] [logging.py:60:log_dist] [Rank 0] step=2060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:04,313] [INFO] [timer.py:160:stop] 0/2060, SamplesPerSec=6155.141180793734
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00064 | Step 00020 | Loss 0.2951 | Train Acc 0.9193 | Speed (samples/sec) 22765.1100 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:06,967] [INFO] [logging.py:60:log_dist] [Rank 0] step=2070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:07,001] [INFO] [timer.py:160:stop] 0/2070, SamplesPerSec=6154.517052174274
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55126953125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:09,346] [INFO] [logging.py:60:log_dist] [Rank 0] step=2080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:09,359] [INFO] [timer.py:160:stop] 0/2080, SamplesPerSec=6157.696777089009
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.18200175 ms
avg iteration GPU training time:230.74291936 ms
avg iteration (step) total cpu time:249.38004988 ms
Epoch Time(s): 9.7712
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.3258 | Train Acc 0.9086 | Speed (samples/sec) 22767.8707 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:13,723] [INFO] [logging.py:60:log_dist] [Rank 0] step=2090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:13,756] [INFO] [timer.py:160:stop] 0/2090, SamplesPerSec=6156.663166582301
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:16,331] [INFO] [logging.py:60:log_dist] [Rank 0] step=2100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:16,364] [INFO] [timer.py:160:stop] 0/2100, SamplesPerSec=6157.133892212372
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00065 | Step 00020 | Loss 0.3209 | Train Acc 0.9143 | Speed (samples/sec) 22775.3501 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:19,041] [INFO] [logging.py:60:log_dist] [Rank 0] step=2110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:19,075] [INFO] [timer.py:160:stop] 0/2110, SamplesPerSec=6156.495210348776
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.43408117 ms
avg iteration GPU training time:243.70128547 ms
avg iteration (step) total cpu time:264.22780531 ms
Epoch Time(s): 10.2261
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3141 | Train Acc 0.9139 | Speed (samples/sec) 22762.5645 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:23,349] [INFO] [logging.py:60:log_dist] [Rank 0] step=2120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:23,381] [INFO] [timer.py:160:stop] 0/2120, SamplesPerSec=6157.363530224913
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:26,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=2130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:26,192] [INFO] [timer.py:160:stop] 0/2130, SamplesPerSec=6155.373214349114
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00066 | Step 00020 | Loss 0.3242 | Train Acc 0.9113 | Speed (samples/sec) 22767.9486 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:28,838] [INFO] [logging.py:60:log_dist] [Rank 0] step=2140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:28,872] [INFO] [timer.py:160:stop] 0/2140, SamplesPerSec=6154.862594000155
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55126953125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65828986 ms
avg iteration GPU training time:248.58918819 ms
avg iteration (step) total cpu time:267.78048056 ms
Epoch Time(s): 10.2582
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3301 | Train Acc 0.9127 | Speed (samples/sec) 22758.6048 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:33,243] [INFO] [logging.py:60:log_dist] [Rank 0] step=2150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:33,277] [INFO] [timer.py:160:stop] 0/2150, SamplesPerSec=6154.382406118153
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:36,025] [INFO] [logging.py:60:log_dist] [Rank 0] step=2160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:36,059] [INFO] [timer.py:160:stop] 0/2160, SamplesPerSec=6152.778159561214
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00067 | Step 00020 | Loss 0.3289 | Train Acc 0.9132 | Speed (samples/sec) 22758.4753 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:38,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=2170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:38,706] [INFO] [timer.py:160:stop] 0/2170, SamplesPerSec=6152.796964919413
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.09308555 ms
avg iteration GPU training time:247.02013991 ms
avg iteration (step) total cpu time:267.18738344 ms
Epoch Time(s): 10.3560
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.3114 | Train Acc 0.9114 | Speed (samples/sec) 22752.0544 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:42,965] [INFO] [logging.py:60:log_dist] [Rank 0] step=2180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:42,999] [INFO] [timer.py:160:stop] 0/2180, SamplesPerSec=6153.572911548262
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:45,604] [INFO] [logging.py:60:log_dist] [Rank 0] step=2190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:45,634] [INFO] [timer.py:160:stop] 0/2190, SamplesPerSec=6153.683701211368
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00068 | Step 00020 | Loss 0.3393 | Train Acc 0.9076 | Speed (samples/sec) 22761.2893 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:48,249] [INFO] [logging.py:60:log_dist] [Rank 0] step=2200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:48,279] [INFO] [timer.py:160:stop] 0/2200, SamplesPerSec=6153.674960074284
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57666015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.97925930 ms
avg iteration GPU training time:239.67071477 ms
avg iteration (step) total cpu time:259.13025715 ms
Epoch Time(s): 10.0655
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3276 | Train Acc 0.9119 | Speed (samples/sec) 22755.6085 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:52,462] [INFO] [logging.py:60:log_dist] [Rank 0] step=2210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:52,496] [INFO] [timer.py:160:stop] 0/2210, SamplesPerSec=6155.351968403643
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:55,268] [INFO] [logging.py:60:log_dist] [Rank 0] step=2220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:55,281] [INFO] [timer.py:160:stop] 0/2220, SamplesPerSec=6153.977154754018
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00069 | Step 00020 | Loss 0.3504 | Train Acc 0.9090 | Speed (samples/sec) 22752.1930 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:28:58,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=2230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:28:58,155] [INFO] [timer.py:160:stop] 0/2230, SamplesPerSec=6151.5816565726855
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:00,795] [INFO] [logging.py:60:log_dist] [Rank 0] step=2240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:00,807] [INFO] [timer.py:160:stop] 0/2240, SamplesPerSec=6151.336884972178
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.27097356 ms
avg iteration GPU training time:257.70775915 ms
avg iteration (step) total cpu time:278.36456122 ms
Epoch Time(s): 10.5209
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3179 | Train Acc 0.9140 | Speed (samples/sec) 22740.4610 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:05,452] [INFO] [logging.py:60:log_dist] [Rank 0] step=2250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:05,486] [INFO] [timer.py:160:stop] 0/2250, SamplesPerSec=6150.876106775963
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:08,264] [INFO] [logging.py:60:log_dist] [Rank 0] step=2260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:08,297] [INFO] [timer.py:160:stop] 0/2260, SamplesPerSec=6148.994233480892
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00070 | Step 00020 | Loss 0.3091 | Train Acc 0.9131 | Speed (samples/sec) 22741.3796 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:11,125] [INFO] [logging.py:60:log_dist] [Rank 0] step=2270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:11,159] [INFO] [timer.py:160:stop] 0/2270, SamplesPerSec=6146.465364526014
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.29506724 ms
avg iteration GPU training time:258.16395173 ms
avg iteration (step) total cpu time:277.31443335 ms
Epoch Time(s): 10.7864
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3108 | Train Acc 0.9135 | Speed (samples/sec) 22728.4800 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:15,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=2280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:15,317] [INFO] [timer.py:160:stop] 0/2280, SamplesPerSec=6147.980666936606
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:17,990] [INFO] [logging.py:60:log_dist] [Rank 0] step=2290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:18,023] [INFO] [timer.py:160:stop] 0/2290, SamplesPerSec=6147.537569767751
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00071 | Step 00020 | Loss 0.3180 | Train Acc 0.9161 | Speed (samples/sec) 22735.7454 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:20,572] [INFO] [logging.py:60:log_dist] [Rank 0] step=2300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:20,606] [INFO] [timer.py:160:stop] 0/2300, SamplesPerSec=6148.2698216826675
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55126953125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.64834130 ms
avg iteration GPU training time:241.33754363 ms
avg iteration (step) total cpu time:262.21762763 ms
Epoch Time(s): 10.0475
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3505 | Train Acc 0.9087 | Speed (samples/sec) 22729.4989 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:24,995] [INFO] [logging.py:60:log_dist] [Rank 0] step=2310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:25,028] [INFO] [timer.py:160:stop] 0/2310, SamplesPerSec=6147.307030363369
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:27,675] [INFO] [logging.py:60:log_dist] [Rank 0] step=2320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:27,708] [INFO] [timer.py:160:stop] 0/2320, SamplesPerSec=6147.060799297738
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00072 | Step 00020 | Loss 0.3371 | Train Acc 0.9089 | Speed (samples/sec) 22729.5201 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:30,379] [INFO] [logging.py:60:log_dist] [Rank 0] step=2330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:30,413] [INFO] [timer.py:160:stop] 0/2330, SamplesPerSec=6146.510035326289
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.41046513 ms
avg iteration GPU training time:245.11929378 ms
avg iteration (step) total cpu time:266.01880568 ms
Epoch Time(s): 10.3405
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.3051 | Train Acc 0.9193 | Speed (samples/sec) 22723.8110 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:35,215] [INFO] [logging.py:60:log_dist] [Rank 0] step=2340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:35,248] [INFO] [timer.py:160:stop] 0/2340, SamplesPerSec=6146.899675819042
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:37,856] [INFO] [logging.py:60:log_dist] [Rank 0] step=2350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:37,890] [INFO] [timer.py:160:stop] 0/2350, SamplesPerSec=6147.191287918866
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00073 | Step 00020 | Loss 0.3233 | Train Acc 0.9113 | Speed (samples/sec) 22732.0037 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:40,480] [INFO] [logging.py:60:log_dist] [Rank 0] step=2360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:40,514] [INFO] [timer.py:160:stop] 0/2360, SamplesPerSec=6147.57419508272
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.23911467 ms
avg iteration GPU training time:240.55911424 ms
avg iteration (step) total cpu time:260.84418650 ms
Epoch Time(s): 10.6276
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3299 | Train Acc 0.9102 | Speed (samples/sec) 22724.5688 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:44,876] [INFO] [logging.py:60:log_dist] [Rank 0] step=2370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:44,910] [INFO] [timer.py:160:stop] 0/2370, SamplesPerSec=6147.615121659072
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:47,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=2380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:47,721] [INFO] [timer.py:160:stop] 0/2380, SamplesPerSec=6145.918211816256
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00074 | Step 00020 | Loss 0.3383 | Train Acc 0.9087 | Speed (samples/sec) 22727.8069 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:50,271] [INFO] [logging.py:60:log_dist] [Rank 0] step=2390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:50,305] [INFO] [timer.py:160:stop] 0/2390, SamplesPerSec=6146.645095554607
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:52,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=2400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:52,840] [INFO] [timer.py:160:stop] 0/2400, SamplesPerSec=6147.702325561646
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.13520585 ms
avg iteration GPU training time:242.48485141 ms
avg iteration (step) total cpu time:262.69871217 ms
Epoch Time(s): 10.2670
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3457 | Train Acc 0.9068 | Speed (samples/sec) 22722.3139 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:57,305] [INFO] [logging.py:60:log_dist] [Rank 0] step=2410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:57,338] [INFO] [timer.py:160:stop] 0/2410, SamplesPerSec=6146.000891443244
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:29:59,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=2420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:29:59,914] [INFO] [timer.py:160:stop] 0/2420, SamplesPerSec=6146.7683882689425
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00075 | Step 00020 | Loss 0.3222 | Train Acc 0.9102 | Speed (samples/sec) 22728.0256 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:02,491] [INFO] [logging.py:60:log_dist] [Rank 0] step=2430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:02,525] [INFO] [timer.py:160:stop] 0/2430, SamplesPerSec=6147.105471661693
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.97604382 ms
avg iteration GPU training time:240.97199447 ms
avg iteration (step) total cpu time:260.85841214 ms
Epoch Time(s): 10.1111
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3317 | Train Acc 0.9142 | Speed (samples/sec) 22721.8763 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:06,888] [INFO] [logging.py:60:log_dist] [Rank 0] step=2440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:06,921] [INFO] [timer.py:160:stop] 0/2440, SamplesPerSec=6146.505149825638
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:09,611] [INFO] [logging.py:60:log_dist] [Rank 0] step=2450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:09,645] [INFO] [timer.py:160:stop] 0/2450, SamplesPerSec=6146.023874791723
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00076 | Step 00020 | Loss 0.3518 | Train Acc 0.9030 | Speed (samples/sec) 22722.9094 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:12,217] [INFO] [logging.py:60:log_dist] [Rank 0] step=2460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:12,251] [INFO] [timer.py:160:stop] 0/2460, SamplesPerSec=6146.569953290961
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:11.04804392 ms
avg iteration GPU training time:246.60157437 ms
avg iteration (step) total cpu time:268.32038385 ms
Epoch Time(s): 10.3757
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3502 | Train Acc 0.9023 | Speed (samples/sec) 22713.4467 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:16,867] [INFO] [logging.py:60:log_dist] [Rank 0] step=2470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:16,901] [INFO] [timer.py:160:stop] 0/2470, SamplesPerSec=6143.5557185146945
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:19,660] [INFO] [logging.py:60:log_dist] [Rank 0] step=2480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:19,693] [INFO] [timer.py:160:stop] 0/2480, SamplesPerSec=6142.060118736838
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00077 | Step 00020 | Loss 0.3649 | Train Acc 0.9017 | Speed (samples/sec) 22713.3011 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:22,154] [INFO] [logging.py:60:log_dist] [Rank 0] step=2490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:22,204] [INFO] [timer.py:160:stop] 0/2490, SamplesPerSec=6143.361208704955
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.28670691 ms
avg iteration GPU training time:240.39893256 ms
avg iteration (step) total cpu time:259.33795505 ms
Epoch Time(s): 10.2705
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3523 | Train Acc 0.9012 | Speed (samples/sec) 22713.6949 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:26,332] [INFO] [logging.py:60:log_dist] [Rank 0] step=2500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:26,366] [INFO] [timer.py:160:stop] 0/2500, SamplesPerSec=6145.191915730509
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:28,959] [INFO] [logging.py:60:log_dist] [Rank 0] step=2510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:28,992] [INFO] [timer.py:160:stop] 0/2510, SamplesPerSec=6145.437044171252
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00078 | Step 00020 | Loss 0.3700 | Train Acc 0.9012 | Speed (samples/sec) 22724.6244 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:31,539] [INFO] [logging.py:60:log_dist] [Rank 0] step=2520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:31,573] [INFO] [timer.py:160:stop] 0/2520, SamplesPerSec=6146.061729743922
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.25288289 ms
avg iteration GPU training time:237.62153286 ms
avg iteration (step) total cpu time:256.46106402 ms
Epoch Time(s): 9.9280
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3337 | Train Acc 0.9086 | Speed (samples/sec) 22720.5825 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:35,741] [INFO] [logging.py:60:log_dist] [Rank 0] step=2530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:35,774] [INFO] [timer.py:160:stop] 0/2530, SamplesPerSec=6147.054169365517
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:38,559] [INFO] [logging.py:60:log_dist] [Rank 0] step=2540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:38,592] [INFO] [timer.py:160:stop] 0/2540, SamplesPerSec=6145.299492286264
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00079 | Step 00020 | Loss 0.3819 | Train Acc 0.8964 | Speed (samples/sec) 22720.3593 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:41,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=2550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:41,329] [INFO] [timer.py:160:stop] 0/2550, SamplesPerSec=6144.393406664289
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:43,811] [INFO] [logging.py:60:log_dist] [Rank 0] step=2560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:43,823] [INFO] [timer.py:160:stop] 0/2560, SamplesPerSec=6145.650917296554
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.20862696 ms
avg iteration GPU training time:246.77559577 ms
avg iteration (step) total cpu time:265.74454484 ms
Epoch Time(s): 10.2779
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3580 | Train Acc 0.9044 | Speed (samples/sec) 22716.7033 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:48,257] [INFO] [logging.py:60:log_dist] [Rank 0] step=2570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:48,291] [INFO] [timer.py:160:stop] 0/2570, SamplesPerSec=6144.247596426059
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:50,946] [INFO] [logging.py:60:log_dist] [Rank 0] step=2580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:50,980] [INFO] [timer.py:160:stop] 0/2580, SamplesPerSec=6143.997937937077
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00080 | Step 00020 | Loss 0.3627 | Train Acc 0.8993 | Speed (samples/sec) 22718.9521 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:53,751] [INFO] [logging.py:60:log_dist] [Rank 0] step=2590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:53,785] [INFO] [timer.py:160:stop] 0/2590, SamplesPerSec=6142.3981163661865
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.73398057 ms
avg iteration GPU training time:252.78123305 ms
avg iteration (step) total cpu time:273.05391983 ms
Epoch Time(s): 10.5080
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3505 | Train Acc 0.9062 | Speed (samples/sec) 22706.3847 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:30:58,213] [INFO] [logging.py:60:log_dist] [Rank 0] step=2600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:30:58,246] [INFO] [timer.py:160:stop] 0/2600, SamplesPerSec=6141.646040789444
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:01,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=2610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:01,069] [INFO] [timer.py:160:stop] 0/2610, SamplesPerSec=6140.063144612283
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00081 | Step 00020 | Loss 0.3427 | Train Acc 0.9086 | Speed (samples/sec) 22705.8180 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:03,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=2620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:03,870] [INFO] [timer.py:160:stop] 0/2620, SamplesPerSec=6138.5859797148705
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.03379915 ms
avg iteration GPU training time:258.16961387 ms
avg iteration (step) total cpu time:278.23291885 ms
Epoch Time(s): 10.5994
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3733 | Train Acc 0.8958 | Speed (samples/sec) 22692.7847 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:08,269] [INFO] [logging.py:60:log_dist] [Rank 0] step=2630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:08,303] [INFO] [timer.py:160:stop] 0/2630, SamplesPerSec=6137.372335207132
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:10,836] [INFO] [logging.py:60:log_dist] [Rank 0] step=2640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:10,870] [INFO] [timer.py:160:stop] 0/2640, SamplesPerSec=6137.983709746449
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00082 | Step 00020 | Loss 0.3709 | Train Acc 0.8956 | Speed (samples/sec) 22698.9365 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:13,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=2650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:13,502] [INFO] [timer.py:160:stop] 0/2650, SamplesPerSec=6138.088580582996
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:8.97149037 ms
avg iteration GPU training time:236.66040830 ms
avg iteration (step) total cpu time:255.13818529 ms
Epoch Time(s): 9.9815
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.3690 | Train Acc 0.8961 | Speed (samples/sec) 22698.5531 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:17,718] [INFO] [logging.py:60:log_dist] [Rank 0] step=2660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:17,751] [INFO] [timer.py:160:stop] 0/2660, SamplesPerSec=6138.36303656478
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:20,619] [INFO] [logging.py:60:log_dist] [Rank 0] step=2670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:20,652] [INFO] [timer.py:160:stop] 0/2670, SamplesPerSec=6136.085422942016
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00083 | Step 00020 | Loss 0.3916 | Train Acc 0.8958 | Speed (samples/sec) 22691.1886 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:23,443] [INFO] [logging.py:60:log_dist] [Rank 0] step=2680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:23,474] [INFO] [timer.py:160:stop] 0/2680, SamplesPerSec=6134.784367188144
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.34723319 ms
avg iteration GPU training time:257.69932048 ms
avg iteration (step) total cpu time:278.31542050 ms
Epoch Time(s): 10.6405
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3735 | Train Acc 0.8942 | Speed (samples/sec) 22682.2518 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:27,761] [INFO] [logging.py:60:log_dist] [Rank 0] step=2690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:27,795] [INFO] [timer.py:160:stop] 0/2690, SamplesPerSec=6134.472473660253
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:30,300] [INFO] [logging.py:60:log_dist] [Rank 0] step=2700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:30,335] [INFO] [timer.py:160:stop] 0/2700, SamplesPerSec=6135.705309729991
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00084 | Step 00020 | Loss 0.4194 | Train Acc 0.8842 | Speed (samples/sec) 22690.0781 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:33,070] [INFO] [logging.py:60:log_dist] [Rank 0] step=2710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:33,104] [INFO] [timer.py:160:stop] 0/2710, SamplesPerSec=6134.68341105473
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:35,796] [INFO] [logging.py:60:log_dist] [Rank 0] step=2720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:35,808] [INFO] [timer.py:160:stop] 0/2720, SamplesPerSec=6134.090718707796
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.10142095 ms
avg iteration GPU training time:248.99904378 ms
avg iteration (step) total cpu time:269.50105914 ms
Epoch Time(s): 10.2939
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3871 | Train Acc 0.8951 | Speed (samples/sec) 22679.2521 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:40,132] [INFO] [logging.py:60:log_dist] [Rank 0] step=2730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:40,166] [INFO] [timer.py:160:stop] 0/2730, SamplesPerSec=6134.161525358987
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:42,700] [INFO] [logging.py:60:log_dist] [Rank 0] step=2740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:42,734] [INFO] [timer.py:160:stop] 0/2740, SamplesPerSec=6134.990923534383
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00085 | Step 00020 | Loss 0.3909 | Train Acc 0.8908 | Speed (samples/sec) 22689.1444 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:45,262] [INFO] [logging.py:60:log_dist] [Rank 0] step=2750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:45,296] [INFO] [timer.py:160:stop] 0/2750, SamplesPerSec=6135.755011608393
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.00245455 ms
avg iteration GPU training time:236.15461448 ms
avg iteration (step) total cpu time:256.25719848 ms
Epoch Time(s): 9.9036
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.4033 | Train Acc 0.8868 | Speed (samples/sec) 22685.6332 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:49,602] [INFO] [logging.py:60:log_dist] [Rank 0] step=2760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:49,635] [INFO] [timer.py:160:stop] 0/2760, SamplesPerSec=6135.795517401773
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:52,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=2770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:52,256] [INFO] [timer.py:160:stop] 0/2770, SamplesPerSec=6136.104316628293
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00086 | Step 00020 | Loss 0.4111 | Train Acc 0.8844 | Speed (samples/sec) 22691.5093 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:54,804] [INFO] [logging.py:60:log_dist] [Rank 0] step=2780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:54,838] [INFO] [timer.py:160:stop] 0/2780, SamplesPerSec=6136.734200866827
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.18515211 ms
avg iteration GPU training time:239.13318945 ms
avg iteration (step) total cpu time:259.31089896 ms
Epoch Time(s): 10.1328
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.4430 | Train Acc 0.8844 | Speed (samples/sec) 22687.0493 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:31:59,220] [INFO] [logging.py:60:log_dist] [Rank 0] step=2790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:31:59,253] [INFO] [timer.py:160:stop] 0/2790, SamplesPerSec=6136.026408084472
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:01,895] [INFO] [logging.py:60:log_dist] [Rank 0] step=2800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:01,929] [INFO] [timer.py:160:stop] 0/2800, SamplesPerSec=6135.914809543372
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00087 | Step 00020 | Loss 0.4081 | Train Acc 0.8921 | Speed (samples/sec) 22692.4883 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:04,387] [INFO] [logging.py:60:log_dist] [Rank 0] step=2810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:04,421] [INFO] [timer.py:160:stop] 0/2810, SamplesPerSec=6137.373515685337
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.46943403 ms
avg iteration GPU training time:234.87909105 ms
avg iteration (step) total cpu time:255.99750766 ms
Epoch Time(s): 10.0318
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.4120 | Train Acc 0.8881 | Speed (samples/sec) 22691.7557 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:08,718] [INFO] [logging.py:60:log_dist] [Rank 0] step=2820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:08,752] [INFO] [timer.py:160:stop] 0/2820, SamplesPerSec=6137.635564130827
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:11,302] [INFO] [logging.py:60:log_dist] [Rank 0] step=2830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:11,332] [INFO] [timer.py:160:stop] 0/2830, SamplesPerSec=6138.273413938705
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00088 | Step 00020 | Loss 0.4456 | Train Acc 0.8778 | Speed (samples/sec) 22699.0386 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:13,906] [INFO] [logging.py:60:log_dist] [Rank 0] step=2840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:13,939] [INFO] [timer.py:160:stop] 0/2840, SamplesPerSec=6138.656530781225
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.89147024 ms
avg iteration GPU training time:231.69631958 ms
avg iteration (step) total cpu time:251.56474996 ms
Epoch Time(s): 9.9243
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4166 | Train Acc 0.8834 | Speed (samples/sec) 22699.3344 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:18,044] [INFO] [logging.py:60:log_dist] [Rank 0] step=2850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:18,071] [INFO] [timer.py:160:stop] 0/2850, SamplesPerSec=6140.22535624011
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:20,877] [INFO] [logging.py:60:log_dist] [Rank 0] step=2860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:20,909] [INFO] [timer.py:160:stop] 0/2860, SamplesPerSec=6138.559571869337
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00089 | Step 00020 | Loss 0.4355 | Train Acc 0.8829 | Speed (samples/sec) 22695.7648 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:23,659] [INFO] [logging.py:60:log_dist] [Rank 0] step=2870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:23,692] [INFO] [timer.py:160:stop] 0/2870, SamplesPerSec=6137.491598379748
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:26,253] [INFO] [logging.py:60:log_dist] [Rank 0] step=2880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:26,265] [INFO] [timer.py:160:stop] 0/2880, SamplesPerSec=6138.008976813666
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68127765 ms
avg iteration GPU training time:250.99130306 ms
avg iteration (step) total cpu time:270.84184576 ms
Epoch Time(s): 10.4718
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4243 | Train Acc 0.8826 | Speed (samples/sec) 22690.2406 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:30,746] [INFO] [logging.py:60:log_dist] [Rank 0] step=2890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:30,779] [INFO] [timer.py:160:stop] 0/2890, SamplesPerSec=6137.1581848587075
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:33,393] [INFO] [logging.py:60:log_dist] [Rank 0] step=2900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:33,427] [INFO] [timer.py:160:stop] 0/2900, SamplesPerSec=6137.148479274595
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00090 | Step 00020 | Loss 0.4623 | Train Acc 0.8761 | Speed (samples/sec) 22694.5831 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:36,006] [INFO] [logging.py:60:log_dist] [Rank 0] step=2910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:36,040] [INFO] [timer.py:160:stop] 0/2910, SamplesPerSec=6137.459791257362
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.64201955 ms
avg iteration GPU training time:245.50993856 ms
avg iteration (step) total cpu time:264.90848153 ms
Epoch Time(s): 10.2001
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4315 | Train Acc 0.8785 | Speed (samples/sec) 22688.9516 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:40,225] [INFO] [logging.py:60:log_dist] [Rank 0] step=2920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:40,258] [INFO] [timer.py:160:stop] 0/2920, SamplesPerSec=6138.73858418504
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:42,776] [INFO] [logging.py:60:log_dist] [Rank 0] step=2930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:42,810] [INFO] [timer.py:160:stop] 0/2930, SamplesPerSec=6139.5675463162825
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00091 | Step 00020 | Loss 0.4636 | Train Acc 0.8759 | Speed (samples/sec) 22702.5650 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:45,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=2940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:45,416] [INFO] [timer.py:160:stop] 0/2940, SamplesPerSec=6139.890691736095
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.38103229 ms
avg iteration GPU training time:232.18999679 ms
avg iteration (step) total cpu time:251.19357639 ms
Epoch Time(s): 9.8632
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4681 | Train Acc 0.8685 | Speed (samples/sec) 22700.5104 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:49,644] [INFO] [logging.py:60:log_dist] [Rank 0] step=2950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:49,678] [INFO] [timer.py:160:stop] 0/2950, SamplesPerSec=6140.623274769723
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:52,309] [INFO] [logging.py:60:log_dist] [Rank 0] step=2960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:52,360] [INFO] [timer.py:160:stop] 0/2960, SamplesPerSec=6140.297642112445
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00092 | Step 00020 | Loss 0.4906 | Train Acc 0.8660 | Speed (samples/sec) 22704.4979 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:55,048] [INFO] [logging.py:60:log_dist] [Rank 0] step=2970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:55,082] [INFO] [timer.py:160:stop] 0/2970, SamplesPerSec=6139.734293202439
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61607230 ms
avg iteration GPU training time:245.92668774 ms
avg iteration (step) total cpu time:265.86498155 ms
Epoch Time(s): 10.2342
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4737 | Train Acc 0.8701 | Speed (samples/sec) 22697.2092 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:32:59,447] [INFO] [logging.py:60:log_dist] [Rank 0] step=2980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:32:59,480] [INFO] [timer.py:160:stop] 0/2980, SamplesPerSec=6139.306376147365
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:02,321] [INFO] [logging.py:60:log_dist] [Rank 0] step=2990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:02,355] [INFO] [timer.py:160:stop] 0/2990, SamplesPerSec=6137.563452906589
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00093 | Step 00020 | Loss 0.4856 | Train Acc 0.8628 | Speed (samples/sec) 22690.6446 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:05,124] [INFO] [logging.py:60:log_dist] [Rank 0] step=3000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:05,158] [INFO] [timer.py:160:stop] 0/3000, SamplesPerSec=6136.469900005247
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.29554491 ms
avg iteration GPU training time:253.90259411 ms
avg iteration (step) total cpu time:274.60228072 ms
Epoch Time(s): 10.5732
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.4868 | Train Acc 0.8639 | Speed (samples/sec) 22685.7005 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:09,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=3010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:09,444] [INFO] [timer.py:160:stop] 0/3010, SamplesPerSec=6136.697010751621
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:12,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=3020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:12,086] [INFO] [timer.py:160:stop] 0/3020, SamplesPerSec=6136.96502066138
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00094 | Step 00020 | Loss 0.4835 | Train Acc 0.8612 | Speed (samples/sec) 22686.5269 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:14,898] [INFO] [logging.py:60:log_dist] [Rank 0] step=3030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:14,932] [INFO] [timer.py:160:stop] 0/3030, SamplesPerSec=6135.404536626207
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:17,482] [INFO] [logging.py:60:log_dist] [Rank 0] step=3040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:17,494] [INFO] [timer.py:160:stop] 0/3040, SamplesPerSec=6136.070503188169
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.63884686 ms
avg iteration GPU training time:247.94592172 ms
avg iteration (step) total cpu time:268.67027636 ms
Epoch Time(s): 10.2971
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4984 | Train Acc 0.8573 | Speed (samples/sec) 22681.0974 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:22,039] [INFO] [logging.py:60:log_dist] [Rank 0] step=3050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:22,073] [INFO] [timer.py:160:stop] 0/3050, SamplesPerSec=6134.182535215918
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:24,821] [INFO] [logging.py:60:log_dist] [Rank 0] step=3060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:24,875] [INFO] [timer.py:160:stop] 0/3060, SamplesPerSec=6133.001788315153
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00095 | Step 00020 | Loss 0.5223 | Train Acc 0.8506 | Speed (samples/sec) 22676.7139 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:27,671] [INFO] [logging.py:60:log_dist] [Rank 0] step=3070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:27,705] [INFO] [timer.py:160:stop] 0/3070, SamplesPerSec=6131.574631877669
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.12423591 ms
avg iteration GPU training time:259.57355754 ms
avg iteration (step) total cpu time:279.92994697 ms
Epoch Time(s): 10.6950
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5056 | Train Acc 0.8573 | Speed (samples/sec) 22667.5268 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:32,169] [INFO] [logging.py:60:log_dist] [Rank 0] step=3080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:32,202] [INFO] [timer.py:160:stop] 0/3080, SamplesPerSec=6130.191659033368
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:34,969] [INFO] [logging.py:60:log_dist] [Rank 0] step=3090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:35,003] [INFO] [timer.py:160:stop] 0/3090, SamplesPerSec=6129.228019522802
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00096 | Step 00020 | Loss 0.5434 | Train Acc 0.8540 | Speed (samples/sec) 22664.4327 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:37,515] [INFO] [logging.py:60:log_dist] [Rank 0] step=3100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:37,549] [INFO] [timer.py:160:stop] 0/3100, SamplesPerSec=6130.056432306326
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.67692091 ms
avg iteration GPU training time:246.54617423 ms
avg iteration (step) total cpu time:267.32167491 ms
Epoch Time(s): 10.3899
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5176 | Train Acc 0.8506 | Speed (samples/sec) 22663.0432 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:42,038] [INFO] [logging.py:60:log_dist] [Rank 0] step=3110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:42,072] [INFO] [timer.py:160:stop] 0/3110, SamplesPerSec=6129.012518122872
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:44,715] [INFO] [logging.py:60:log_dist] [Rank 0] step=3120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:44,748] [INFO] [timer.py:160:stop] 0/3120, SamplesPerSec=6128.783734633533
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00097 | Step 00020 | Loss 0.5260 | Train Acc 0.8528 | Speed (samples/sec) 22661.7929 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:47,624] [INFO] [logging.py:60:log_dist] [Rank 0] step=3130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:47,658] [INFO] [timer.py:160:stop] 0/3130, SamplesPerSec=6126.740600314851
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.55885629 ms
avg iteration GPU training time:255.99544214 ms
avg iteration (step) total cpu time:275.85843757 ms
Epoch Time(s): 10.6356
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56494140625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5134 | Train Acc 0.8498 | Speed (samples/sec) 22652.6058 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:51,939] [INFO] [logging.py:60:log_dist] [Rank 0] step=3140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:51,972] [INFO] [timer.py:160:stop] 0/3140, SamplesPerSec=6126.921114345297
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:54,708] [INFO] [logging.py:60:log_dist] [Rank 0] step=3150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:54,742] [INFO] [timer.py:160:stop] 0/3150, SamplesPerSec=6126.411192802646
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00098 | Step 00020 | Loss 0.5421 | Train Acc 0.8461 | Speed (samples/sec) 22655.5839 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:33:57,399] [INFO] [logging.py:60:log_dist] [Rank 0] step=3160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:33:57,433] [INFO] [timer.py:160:stop] 0/3160, SamplesPerSec=6126.223690633289
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.61279408 ms
avg iteration GPU training time:241.91295596 ms
avg iteration (step) total cpu time:262.33659850 ms
Epoch Time(s): 10.1793
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54150390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5400 | Train Acc 0.8479 | Speed (samples/sec) 22652.3428 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:01,607] [INFO] [logging.py:60:log_dist] [Rank 0] step=3170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:01,639] [INFO] [timer.py:160:stop] 0/3170, SamplesPerSec=6127.040624613427
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:04,460] [INFO] [logging.py:60:log_dist] [Rank 0] step=3180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:04,494] [INFO] [timer.py:160:stop] 0/3180, SamplesPerSec=6125.493824764548
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00099 | Step 00020 | Loss 0.5351 | Train Acc 0.8492 | Speed (samples/sec) 22650.7644 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:07,183] [INFO] [logging.py:60:log_dist] [Rank 0] step=3190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:07,217] [INFO] [timer.py:160:stop] 0/3190, SamplesPerSec=6124.908070358618
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55322265625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:09,714] [INFO] [logging.py:60:log_dist] [Rank 0] step=3200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:09,727] [INFO] [timer.py:160:stop] 0/3200, SamplesPerSec=6125.94135883271
-----------------------------------------after batch engine step
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:9.56413506 ms
avg iteration GPU training time:247.29548023 ms
avg iteration (step) total cpu time:266.57598107 ms
Epoch Time(s): 10.3489
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5293 | Train Acc 0.8527 | Speed (samples/sec) 22647.1549 | GPU 10167.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57470703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:14,118] [INFO] [logging.py:60:log_dist] [Rank 0] step=3210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:14,152] [INFO] [timer.py:160:stop] 0/3210, SamplesPerSec=6126.049951121882
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54345703125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:16,722] [INFO] [logging.py:60:log_dist] [Rank 0] step=3220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:16,756] [INFO] [timer.py:160:stop] 0/3220, SamplesPerSec=6126.575998909884
-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

Epoch 00100 | Step 00020 | Loss 0.5242 | Train Acc 0.8493 | Speed (samples/sec) 22654.8648 | GPU 10167.4 MB

   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54931640625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57275390625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55908203125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56689453125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

[2021-06-13 02:34:19,390] [INFO] [logging.py:60:log_dist] [Rank 0] step=3230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:34:19,423] [INFO] [timer.py:160:stop] 0/3230, SamplesPerSec=6126.401314166089
-----------------------------------------after batch engine step
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54541015625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55712890625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56884765625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.57080078125GB

Max Memory Allocated 9.929056644439697  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.54736328125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.55517578125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.56298828125GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.56103515625GB

Max Memory Allocated 9.929056644439697  GigaBytes

avg iteration(step) data from cpu to GPU time:10.33299564 ms
avg iteration GPU training time:239.17442039 ms
avg iteration (step) total cpu time:259.26533452 ms
Epoch Time(s): 10.1766
Eval Acc 0.8577
Test Acc: 0.6497
Avg epoch time(time.time()): 10220.611264308294 ms
total avg iteration(step) data from cpu to GPU time:9.96093378 ms
total avg iteration GPU training time:242.64890171 ms
total avg iteration (step) total cpu time:262.65865068 ms
